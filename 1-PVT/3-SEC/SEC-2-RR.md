---
jupytext:
  text_representation:
    extension: .md
    format_name: myst
    format_version: 3.0.1
    jupytext_version: 1.16.3
kernelspec:
  display_name: Python 3 (ipykernel)
  language: python
  name: python3
---

(pvt-esc-rr)=
# Уравнение Речфорда-Райса

Рассмотрим многофазную ($N_p$ – количество фаз) многокомпонентную ($N_c$ – количество компонентов) систему с количеством вещества в системе $n$. Количество вещества $i$-го компонента в системе обозначим $n_i$, причем сумма количеств вещества всех компонентов будет составлять количество вещества всей системы:

$$ \sum_{i=1}^{N_c} n_i = n. $$

Пусть количество вещества $j$-й фазы будет $n^j$, тогда сумма количеств вещества всех фаз также будет составлять количество вещества всей системы:

$$ \sum_{j=1}^{N_p} n^j = n. $$

Обозначим количество вещества $i$-го компонента в $j$-й фазе $n_i^j$, следовательно:

$$ \begin{align}
\sum_{i=1}^{N_c} n_i^j &= n^j, \; j = 1 \, \ldots \, N_p, \\
\sum_{j=1}^{N_p} n_i^j &= n_i, \; i = 1 \, \ldots \, N_c, \\
\sum_{i=1}^{N_c} \sum_{j=1}^{N_p} n_i^j &= n.
\end{align} $$

Пусть мольная доля $i$-го компонента в системе в целом обозначается $y_i$ и характеризует отношение количества вещества $i$-го компонента к количеству вещества всей системы, то есть:

$$ y_i = \frac{n_i}{n}, \; i = 1 \, \ldots \, N_c. $$

Причем,

$$ \sum_{i=1}^{N_c} y_i = 1. $$

Пусть мольная доля $j$-й фазы в системе обозначается $F^j$ и соответствует следующему выражению:

$$ F^j = \frac{n^j}{n}, \; j = 1 \, \ldots \, N_p. $$

То есть мольная доля $j$-й фазы характеризует отношение количества вещества $j$-й фазы к количеству вещества всей систеы. При этом

$$ \sum_{j=1}^{N_p} F^j = 1. $$

Пусть мольная доля $i$-го компонента в $j$-й фазе обозначается $y_i^j$, характеризует отношение количества вещества $i$-го компонента в $j$-й фазе к количеству вещества $j$-й фазы. Математически это записывается следующим образом:

$$ y_i^j = \frac{n_i^j}{n^j}, \; j = 1 \, \ldots \, N_p, \; i = 1 \, \ldots \, N_c. $$

Причем,

$$ \sum_{i=1}^{N_c} y_i^j = 1, \; j = 1 \, \ldots \, N_p. $$

Введем понятие константы фазового равновесия (*k-value*):

```{admonition} Определение
:class: tip
***Константа фазового равновесия*** $i$-го компонента (коэффициент распределения) характеризует отношение мольной доли компонента в фазе $j$ к мольной доли этого же компонета в референсной фазе $R$:

$$ K_i^{jR} = \frac{y_i^j}{y_i^R}, \; j = \left\{ 1 \, \ldots \, N_p \right\} - \left\{ R \right\}. $$

```

При этом

$$ K_i^{RR} = \frac{y_i^R}{y_i^R} = 1. $$

Кроме того, необходимо отметить, что референсной фазой может быть любая. Рассмотрим следующее соотношение:

$$ \sum_{k=1}^{N_p} n_i^k = n_i, \; i = 1 \, \ldots \, N_c. $$

Разделим левую и правую части данного выражения на количество вещества системы $n$:

$$ \sum_{k=1}^{N_p} \frac{n_i^k}{n} = \frac{n_i}{n}, \; i = 1 \, \ldots \, N_c. $$

В левой части выражения домножим числитель и знаменатель каждого слагаемого на количество вещества соответствующей $k$-й фазы $n^k$:

$$ \sum_{k=1}^{N_p} \frac{n_i^k}{n} \frac{n^k}{n^k} = \sum_{k=1}^{N_p} \frac{n_i^k}{n^k} \frac{n^k}{n} = \frac{n_i}{n}, \; i = 1 \, \ldots \, N_c. $$

С учетом представленных выше соотношений, данное выражение преобразуется к следующему:

$$ \sum_{k=1}^{N_p} y_i^k F^k = y_i, \; i = 1 \, \ldots \, N_c. $$

В левой части выражения выразим $y_i^k$ через константу фазового равновесия:

$$ \sum_{k=1}^{N_p} K_i^{kR} y_i^R F^k = y_i, \; i = 1 \, \ldots \, N_c. $$

Поскольку $y_i^R$ в левой части выражения не зависит от индекса суммирования $k$, то ее можно вынести за знак суммирования:

$$ y_i^R \sum_{k=1}^{N_p} K_i^{kR} F^k = y_i, \; i = 1 \, \ldots \, N_c. $$

Тогда:

$$ y_i^R = \frac{y_i}{\sum_{k=1}^{N_p} K_i^{kR} F^k}, \; i = 1 \, \ldots \, N_c. $$

Поскольку $y_i^j = K_i^{jR} y_i^R, \; i = 1 \, \ldots \, N_c, \; j = 1 \, \ldots \, N_p - 1$, то:

$$ y_i^j = \frac{y_i K_i^{jR}}{\sum_{k=1}^{N_p} K_i^{kR} F^k}, \; i = 1 \, \ldots \, N_c, \; j = 1 \, \ldots \, N_p - 1. $$

Здесь и далее в качестве референсной фазы принята фаза с индексом $j = N_p$. Учитывая

$$ \sum_{i=1}^{N_c} y_i^j = 1, \; j = 1 \, \ldots \, N_p, $$

можно записать следующую систему уравнений:

$$ \sum_{i=1}^{N_c} y_i^j - \sum_{i=1}^{N_c} y_i^R = 0, \; j = 1 \, \ldots \, N_p - 1. $$

Подставляя полученные ранее выражения для мольной доли $i$-го компонента в фазе $j$ и референсной фазе $R$, получим:

$$ \begin{align}
\sum_{i=1}^{N_c} y_i^j - \sum_{i=1}^{N_c} y_i^R &= 0, \; j = 1 \, \ldots \, N_p - 1, \\
\sum_{i=1}^{N_c} \left( y_i^j - y_i^R \right) &= 0, \; j = 1 \, \ldots \, N_p - 1, \\
\sum_{i=1}^{N_c} \left( \frac{y_i K_i^{jR}}{\sum_{k=1}^{N_p} K_i^{kR} F^k} - \frac{y_i}{\sum_{k=1}^{N_p} K_i^{kR} F^k} \right) &= 0, \; j = 1 \, \ldots \, N_p - 1, \\
\sum_{i=1}^{N_c} \frac{y_i \left( K_i^{jR} - 1 \right)}{\sum_{k=1}^{N_p} K_i^{kR} F^k} &= 0, \; j = 1 \, \ldots \, N_p - 1.
\end{align} $$

С учетом $\sum_{k=1}^{N_p} F^k = 1$ представленную выше систему уравнений можно преобразовать следующим образом:

$$ \begin{align}
\sum_{i=1}^{N_c} \frac{y_i \left( K_i^{jR} - 1 \right)}{\sum_{k=1}^{N_p} K_i^{kR} F^k} &= 0, \; j = 1 \, \ldots \, N_p - 1, \\
\sum_{i=1}^{N_c} \frac{y_i \left( K_i^{jR} - 1 \right)}{\sum_{k=1}^{N_p-1} K_i^{kR} F^k + K_i^{RR} F^R} &= 0, \; j = 1 \, \ldots \, N_p - 1, \\
\sum_{i=1}^{N_c} \frac{y_i \left( K_i^{jR} - 1 \right)}{\sum_{k=1}^{N_p-1} K_i^{kR} F^k + 1 - \sum_{k=1}^{N_p-1} F^k} &= 0, \; j = 1 \, \ldots \, N_p - 1, \\
\sum_{i=1}^{N_c} \frac{y_i \left( K_i^{jR} - 1 \right)}{\sum_{k=1}^{N_p-1} F^k \left( K_i^{kR} - 1 \right) + 1} &= 0, \; j = 1 \, \ldots \, N_p - 1. \\
\end{align} $$

Таким образом, система уравнений

$$ \sum_{i=1}^{N_c} \frac{y_i \left( K_i^{jR} - 1 \right)}{\sum_{k=1}^{N_p-1} F^k \left( K_i^{kR} - 1 \right) + 1} = 0, \; j = 1 \, \ldots \, N_p - 1, $$

называется ***системой уравнений Речфорда-Райса (системой уравнений фазовых концентраций)***. Она содержит $N_p - 1$ уравнений и разрешается относительно $F^k, \; k = 1 \, \ldots \, N_p - 1,$ неизвестных при фиксировании значений констант фазового равновесия. После определения мольных долей фаз мольные доли компонентов в них определяются с использованием полученных ранее выражений:

$$ \begin{align}
y_i^R &= \frac{y_i}{\sum_{k=1}^{N_p-1} F^k \left( K_i^{kR} - 1 \right) + 1}, \\
y_i^j &=  K_i^{jR} y_i^R, \; j = 1 \, \ldots \, N_p - 1. \\
\end{align} $$

В следующих разделах подробнее остановимся на численных методах решения уравнения Речфорда-Райса для [двухфазной](SEC-3-RR-2P.md) и [многофазной](SEC-4-RR-NP.md) систем.
