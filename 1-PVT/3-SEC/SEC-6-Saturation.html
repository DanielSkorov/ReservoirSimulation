
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Определение насыщенного состояния системы &#8212; Основы моделирования пластовых систем</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=5194fb77" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '1-PVT/3-SEC/SEC-6-Saturation';</script>
    <script src="../../_static/custom.js?v=4c678b35"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Определение критического состояния системы" href="SEC-7-Criticality.html" />
    <link rel="prev" title="Определение равновесного состояния системы" href="SEC-5-Equilibrium.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../Introduction.html">
  
  
  
  
  
  
    <p class="title logo__title">Основы моделирования пластовых систем</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../Introduction.html">
                    Основы моделирования пластовых систем
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Основы вычислительной математики</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../0-Math/Math-Introduction.html">Введение</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../0-Math/0-LAB/LAB-0-Introduction.html">Основы линейной алгебры</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../0-Math/0-LAB/LAB-1-Vectors.html">Вектор. Координаты вектора</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../0-Math/0-LAB/LAB-2-VectorOperations.html">Операции с векторами</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../0-Math/0-LAB/LAB-3-RotationAngles.html">Направляющие косинусы</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../0-Math/0-LAB/LAB-4-Matrices.html">Матрицы</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../0-Math/0-LAB/LAB-5-Determinant-InverseMatrix.html">Определитель матрицы. Обратная матрица</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../0-Math/0-LAB/LAB-6-Eigenvalues-Eigenvectors.html">Собственные векторы и значения матриц</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../0-Math/0-LAB/LAB-7-LinearTransformations.html">Линейные преобразования</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../0-Math/0-LAB/LAB-8-MatrixDefiniteness.html">Определенность матриц</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../0-Math/0-LAB/LAB-9-Decomposition.html">Разложение матриц</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../0-Math/0-LAB/LAB-10-LinearSystems.html">Решение систем линейных уравнений</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../0-Math/0-LAB/LAB-11-ConditionNumber.html">Число обусловленности</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../0-Math/0-LAB/LAB-12-Preconditioner.html">Предобуславливание</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../0-Math/1-OM/OM-0-Introduction.html">Методы оптимизации функций</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PVT-моделирование</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../PVT-Introduction.html">Введение</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../1-TD/TD-0-Introduction.html">Основы термодинамики</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-1-Basics.html">Введение в термодинамику</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-2-ThermalEquilibrium.html">Термическое равновесие. Температура. Нулевое начало термодинамики</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-3-Heat-Work.html">Количество теплоты и работа. Первое начало термодинамики</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-4-HeatCapacity.html">Теплоемкость</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-5-Enthalpy.html">Энтальпия</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-6-Entropy.html">Энтропия. Второе и третье начала термодинамики</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-7-ChemicalPotential.html">Химический потенциал</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-8-Helmholtz-Gibbs.html">Энергия Гельмгольца. Энергия Гиббса</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-9-Observables.html">Интенсивные и экстенсивные параметры</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-10-MixtureGibbsEnergy.html">Энергия Гиббса многокомпонентной системы</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-11-GibbsPhaseRule.html">Правило фаз Гиббса</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-12-GibbsDuhemEquation.html">Уравнение Гиббса-Дюгема</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-13-MaxwellRelations.html">Соотношения Максвелла</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-14-PhaseEquilibrium.html">Свободная энергия и фазовое равновесие</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-15-Fugacity.html">Летучесть</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../2-EOS/EOS-0-Introduction.html">Уравнения состояния</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../2-EOS/EOS-1-VanDerWaals.html">Уравнение состояния Ван-дер-Ваальса</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-EOS/EOS-2-SRK-PR.html">Уравнения состояния Суаве-Редлиха-Квонга и Пенга-Робинсона</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-EOS/EOS-3-CPA.html">Кубическое уравнение состояние с учетом ассоциации молекул</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-EOS/EOS-Appendix-A-PD.html">Частные производные летучести компонентов</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-EOS/EOS-Appendix-B-BIP.html">Универсальный расчет коэффициентов попарного взаимодействия</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-EOS/EOS-Appendix-C-HV.html">Правило смешивания Хьюрона-Видаля</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="SEC-0-Introduction.html">Стабильность. Равновесие. Критическое состояние</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="SEC-1-Stability.html">Определение стабильности фазового состояния системы</a></li>
<li class="toctree-l2"><a class="reference internal" href="SEC-2-RR.html">Уравнение Речфорда-Райса</a></li>
<li class="toctree-l2"><a class="reference internal" href="SEC-3-RR-2P.html">Уравнение Речфорда-Райса для двухфазных систем</a></li>
<li class="toctree-l2"><a class="reference internal" href="SEC-4-RR-NP.html">Уравнение Речфорда-Райса для многофазных систем</a></li>
<li class="toctree-l2"><a class="reference internal" href="SEC-5-Equilibrium.html">Определение равновесного состояния системы</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Определение насыщенного состояния системы</a></li>
<li class="toctree-l2"><a class="reference internal" href="SEC-7-Criticality.html">Определение критического состояния системы</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../4-LAB/LAB-0-Introduction.html">Моделирование лабораторных исследований</a></li>
<li class="toctree-l1"><a class="reference internal" href="../5-ETC/ETC-0-Introduction.html">Применение PVT-моделирования для решения практических задач проектирования месторождений углеводородов</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/1-PVT/3-SEC/SEC-6-Saturation.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Определение насыщенного состояния системы</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pvt-esc-saturation-psat">Определение давления насыщения</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pvt-esc-saturation-psat-ss">Метод последовательных подстановок для нахождения давления насыщения</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pvt-esc-saturation-tsat">Определение температуры насыщения</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pvt-esc-saturation-psatmax">Определение криконденбары</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pvt-esc-saturation-tsatmax">Определение крикондентермы</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pvt-esc-saturation-bound">Построение границы двухфазной области</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pvt-esc-saturation-internals">Промежуточные линии (линии постоянной мольной доли фазы)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pvt-esc-saturation-retrograde">Границы ретроградных областей</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="pvt-esc-saturation">
<span id="id1"></span><h1>Определение насыщенного состояния системы<a class="headerlink" href="#pvt-esc-saturation" title="Link to this heading">#</a></h1>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="note admonition">
<p class="admonition-title">Дополнительно</p>
<p>Данный раздел посвящен рассмотрению численных алгоритмов построения границы двухфазной области, являющейся одной из наиболее распространенных задач в PVT-моделировании пластовых углеводородных систем. Важно отметить, что для многокомпонентных термодинамических систем могут быть определены границы трехфазной области, подходы к построению которых не будут рассматриваться в рамках данного раздела. Достаточно подробно они рассмотрены авторами работы [<a class="reference external" href="https://doi.org/10.2118/85971-PA">Lindeloff and Michelsen, 2003</a>]. Также в данном разделе не будет уделено внимание алгоритмам построения фазовых диаграмм для бинарных систем, для изучения которых рекомендуется обратиться к работам [<a class="reference external" href="https://doi.org/10.1016/j.supflu.2006.03.011">Cismondi and Michelsen, 2007</a>; <a class="reference external" href="https://doi.org/10.1016/j.fluid.2007.07.019">Cismondi and Michelsen, 2007</a>; <a class="reference external" href="https://doi.org/10.1021/ie8002914">Cismondi et al, 2008</a>].</p>
</div>
</aside>
<p>В предыдущих разделах были подробно рассмотрены условия <a class="reference internal" href="SEC-1-Stability.html"><span class="std std-doc">стабильности</span></a> и <a class="reference internal" href="SEC-5-Equilibrium.html"><span class="std std-doc">равновесности</span></a> фазового состояния многокомпонентной системы. Целью данного раздела будет исследование алгоритмов определения давления и температуры насыщения, границ двухфазной области (линий <em>насыщения</em>, <em>точек росы</em>), а также особых точек, таких как <em>криконденбара</em>, <em>крикондентерма</em>, <em>критическая точка</em>.</p>
<div class="tip admonition">
<p class="admonition-title">Определение</p>
<p><em><strong>Насыщенным</strong></em> состоянием системы будем называть такое состояние, в котором начинается или заканчивается процесс изменения ее фазового состояния.</p>
</div>
<p>Например, <em>давлением насыщения нефти</em> принято считать такое давление, которое соответствует переходу нефти из однофазного состояния в двухфазное. Иными словами, добавление небольшого количества энергии нефти, находящейся на <em>линии насыщения</em>, будет приводить к переходу небольшого количества ее вещества в газовую фазу. Аналогично формулируется определение для газа, находящегося на <em>линии конденсации</em>.</p>
<p><a class="reference internal" href="SEC-1-Stability.html"><span class="std std-doc">Ранее</span></a> было показано, что однофазное состояние многокомпонентной системы (<span class="math notranslate nohighlight">\(N_c\)</span> – количество компонентов) известного компонентного состава <span class="math notranslate nohighlight">\(\mathbf{z} \in {\rm I\!R}^{N_c}\)</span> является стабильным при фиксированных и известных давлении и температуре, если касательная, проведенная к функции энергии Гиббса в точке с заданным компонентным составом, не пересекает ее в любых других точках. Данный критерий эквивалентен условию неотрицательности функции TPD (<em>tangent plane distance</em>), определяемой расстоянием от гиперповерхности энергии Гиббса до касательной гиперплоскости, проведенной в точке с заданным компонентным составом:</p>
<div class="math notranslate nohighlight">
\[ \bar{D} \left( P, \, T, \, \mathbf{y} \right) = \sum_{i=1}^{N_c} y_i \left( \ln y_i + \ln \varphi_i \left( P, \, T, \, \mathbf{y} \right) - \ln \varphi_i \left( P, \, T, \, \mathbf{z} \right) - \ln z_i \right), \]</div>
<p>где <span class="math notranslate nohighlight">\(\bar{D} \left( P, \, T, \, \mathbf{y} \right)\)</span> – приведенная функция TPD, <span class="math notranslate nohighlight">\(\mathbf{y} \in {\rm I\!R}^{N_c}\)</span> – мольные доли компонентов в мнимой фазе, <span class="math notranslate nohighlight">\(\varphi_i \left( P, \, T, \, \mathbf{y} \right)\)</span> – коэффициент летучести <span class="math notranslate nohighlight">\(i\)</span>-го компонента в мнимой фазе, <span class="math notranslate nohighlight">\(\varphi_i \left( P, \, T, \, \mathbf{z} \right)\)</span> – коэффициент летучести <span class="math notranslate nohighlight">\(i\)</span>-го компонента в исходной рассматриваемой теродинамической системе.</p>
<p>При этом нет необходимости проверять значения функции TPD во всех точках – достаточно проверить ее значение в глобальном минимуме или во всех локальных минимумах, задаваясь различными начальными приближениями. То есть если для рассматриваемой термодинамической системы функция TPD характеризуется отрицательным значением в ее нетривиальном минимуме (то есть не соответствующем решению <span class="math notranslate nohighlight">\(\mathbf{y} = \mathbf{z}\)</span>), то однофазное состояние не является стабильным. И наоборот: если положительным, то однофазное состояние системы стабильно. Следовательно, граница двухфазной области, характеризующаяся пренебрежимо малым количеством другой, мнимой фазы (<em>trial phase</em>), находящейся в термодинамическом равновесии с исходным компонентным составом, определяется условием равенства нулю функции TPD в ее нетривиальном минимуме.</p>
<p>Для иллюстрации данного условия обратимся к примеру, рассмотренному <a class="reference internal" href="SEC-5-Equilibrium.html#pvt-sec-equilibrium-pt-ss-examples"><span class="std std-ref">ранее</span></a>.</p>
<div class="exercise admonition">
<p class="admonition-title">Пример</p>
<p>Пусть имеется <span class="math notranslate nohighlight">\(1 \; моль\)</span> смеси из метана и диоксида углерода при температуре <span class="math notranslate nohighlight">\(10 \; ^{\circ} C\)</span> и давлении <span class="math notranslate nohighlight">\(6 \; МПа\)</span> с мольной долей метана <span class="math notranslate nohighlight">\(0.1\)</span>. Необходимо определить равновесное состояние системы.</p>
</div>
<p>Для решения данной и последующих задач будем использовать <a class="reference internal" href="../2-EOS/EOS-2-SRK-PR.html"><span class="std std-doc">уравнение состояние Пенга-Робинсона</span></a> и его <a class="reference external" href="https://github.com/DanielSkorov/ReservoirSimulation/blob/main/_src/eos.py">реализацию</a>. Кроме того, для проверки <a class="reference internal" href="SEC-1-Stability.html"><span class="std std-doc">стабильности</span></a> системы будет применяться подход, основанный на примениии метода последовательных подстановок и метода Ньютона, алгоритм которого реализован <a class="reference external" href="https://github.com/DanielSkorov/ReservoirSimulation/blob/main/_src/stability.py">здесь</a>. Для расчета стационарного состояния системы будем также использовать комбинацию метода последовательных подстановок и метода Ньютона, с реализацией можно ознакомиться <a class="reference external" href="https://github.com/DanielSkorov/ReservoirSimulation/blob/main/_src/flash.py">здесь</a>.</p>
<p>Импортируем необходимые классы и функции.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;../../_src/&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">eos</span> <span class="kn">import</span> <span class="n">pr78</span>
<span class="kn">from</span> <span class="nn">stability</span> <span class="kn">import</span> <span class="n">stabilityPT</span>
<span class="kn">from</span> <span class="nn">flash</span> <span class="kn">import</span> <span class="n">flash2pPT</span>
</pre></div>
</div>
</div>
</div>
<p>Зададим исходные термобарические условия и компонентный состав.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">P</span> <span class="o">=</span> <span class="mf">6e6</span> <span class="c1"># Pressure [Pa]</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">10.</span> <span class="o">+</span> <span class="mf">273.15</span> <span class="c1"># Temperature [K]</span>
<span class="n">yi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span> <span class="c1"># Mole fractions [fr.]</span>
</pre></div>
</div>
</div>
</div>
<p>Зададим свойства компонентов, необходимые для уравнения состояния Пенга-Робинсона, и выполним инициализацию класса.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Pci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">7.37646</span><span class="p">,</span> <span class="mf">4.600155</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1e6</span> <span class="c1"># Critical pressures [Pa]</span>
<span class="n">Tci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">304.2</span><span class="p">,</span> <span class="mf">190.6</span><span class="p">])</span> <span class="c1"># Critical temperatures [K]</span>
<span class="n">wi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.225</span><span class="p">,</span> <span class="mf">0.008</span><span class="p">])</span> <span class="c1"># Acentric factors</span>
<span class="n">mwi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.04401</span><span class="p">,</span> <span class="mf">0.016043</span><span class="p">])</span> <span class="c1"># Molar mass [kg/gmole]</span>
<span class="n">vsi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span> <span class="c1"># Volume shift parameters</span>
<span class="n">dij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.025</span><span class="p">])</span> <span class="c1"># Binary interaction parameters</span>
<span class="n">pr</span> <span class="o">=</span> <span class="n">pr78</span><span class="p">(</span><span class="n">Pci</span><span class="p">,</span> <span class="n">Tci</span><span class="p">,</span> <span class="n">wi</span><span class="p">,</span> <span class="n">mwi</span><span class="p">,</span> <span class="n">vsi</span><span class="p">,</span> <span class="n">dij</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Проиницилизируем класс для проведения теста стабильности и выполним проверку стабильности однофазного состояния.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stab</span> <span class="o">=</span> <span class="n">stabilityPT</span><span class="p">(</span><span class="n">pr</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;ss-newton&#39;</span><span class="p">,</span> <span class="n">checktrivial</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">stabres</span> <span class="o">=</span> <span class="n">stab</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">stabres</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The one-phase state is stable: False.
</pre></div>
</div>
</div>
</div>
<p>В результате проверки стабильности однофазное состояние системы оказалось нестабильным. Определим компонентные составы фаз для двухфазного состояния.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flash</span> <span class="o">=</span> <span class="n">flash2pPT</span><span class="p">(</span><span class="n">pr</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;ss-newton&#39;</span><span class="p">)</span>
<span class="n">flashres</span> <span class="o">=</span> <span class="n">flash</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">flashres</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Phase compositions:
[[0.81827115 0.18172885]
 [0.91760694 0.08239306]]
Phase mole fractions:
[0.17724668 0.82275332]
Phase compressibility factors:
[0.54467207 0.15029861]
</pre></div>
</div>
</div>
</div>
<p>Проверим, является ли найденное стационарное состояние равновесным:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">stab</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">flashres</span><span class="o">.</span><span class="n">yji</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The one-phase state is stable: True.
</pre></div>
</div>
</div>
</div>
<p>Рассчитаем значения функции TPD для компонентного состава первой фазы и трех температур: <span class="math notranslate nohighlight">\(9 \; ^{\circ} \mathrm{C}\)</span>, <span class="math notranslate nohighlight">\(10 \; ^{\circ} \mathrm{C}\)</span> и <span class="math notranslate nohighlight">\(11 \; ^{\circ} \mathrm{C}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xj1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1e-4</span><span class="p">,</span> <span class="mf">0.9999</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">xji</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">xj1</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">xj1</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>

<span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">lnphiji</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">getPT_Zj_lnphiji</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">xji</span><span class="p">)</span>
<span class="n">lnfji</span> <span class="o">=</span> <span class="n">lnphiji</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">P</span> <span class="o">*</span> <span class="n">xji</span><span class="p">)</span>
<span class="n">Gj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vecdot</span><span class="p">(</span><span class="n">xji</span><span class="p">,</span> <span class="n">lnfji</span><span class="p">)</span>
<span class="n">_</span><span class="p">,</span> <span class="n">lnfi</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">getPT_lnfi</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">flashres</span><span class="o">.</span><span class="n">yji</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">Lj</span> <span class="o">=</span> <span class="n">xji</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">lnfi</span><span class="p">)</span>
<span class="n">Dj_10</span> <span class="o">=</span> <span class="n">Gj</span> <span class="o">-</span> <span class="n">Lj</span>

<span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">lnphiji</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">getPT_Zj_lnphiji</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">xji</span><span class="p">)</span>
<span class="n">lnfji</span> <span class="o">=</span> <span class="n">lnphiji</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">P</span> <span class="o">*</span> <span class="n">xji</span><span class="p">)</span>
<span class="n">Gj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vecdot</span><span class="p">(</span><span class="n">xji</span><span class="p">,</span> <span class="n">lnfji</span><span class="p">)</span>
<span class="n">_</span><span class="p">,</span> <span class="n">lnfi</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">getPT_lnfi</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">flashres</span><span class="o">.</span><span class="n">yji</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">Lj</span> <span class="o">=</span> <span class="n">xji</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">lnfi</span><span class="p">)</span>
<span class="n">Dj_9</span> <span class="o">=</span> <span class="n">Gj</span> <span class="o">-</span> <span class="n">Lj</span>

<span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">lnphiji</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">getPT_Zj_lnphiji</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span> <span class="o">+</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">xji</span><span class="p">)</span>
<span class="n">lnfji</span> <span class="o">=</span> <span class="n">lnphiji</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">P</span> <span class="o">*</span> <span class="n">xji</span><span class="p">)</span>
<span class="n">Gj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vecdot</span><span class="p">(</span><span class="n">xji</span><span class="p">,</span> <span class="n">lnfji</span><span class="p">)</span>
<span class="n">_</span><span class="p">,</span> <span class="n">lnfi</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">getPT_lnfi</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span> <span class="o">+</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">flashres</span><span class="o">.</span><span class="n">yji</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">Lj</span> <span class="o">=</span> <span class="n">xji</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">lnfi</span><span class="p">)</span>
<span class="n">Dj_11</span> <span class="o">=</span> <span class="n">Gj</span> <span class="o">-</span> <span class="n">Lj</span>
</pre></div>
</div>
</div>
</div>
<p>Построим графики функций.</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="note admonition">
<p class="admonition-title">Дополнительно</p>
<p>Важно отметить, что для любой многокомпонентной системы можно определить границу, чуть больше двухфазной области, где нетривиальный минимум функции TPD перестает существовать. Такую границу принято называть <em>пределом теста стабильности (Stability Test Limit Locus – STLL)</em>: за STLL функция TPD имеет только тривиальный минимум <span class="math notranslate nohighlight">\(\mathbf{y} = \mathbf{z}\)</span>. Между STLL и границей двухфазной области существует нетривиальный положительной минимум функции TPD. Данный регион на PT-диаграмме также принято называть областью теневой фазы (<em>shadow-phase region</em>) [<a class="reference external" href="https://doi.org/10.2118/84181-PA">C.P. Rasmussen et al, 2006</a>]. Условием для нахождения STLL является вырождение нетривиального минимума, то есть его преобразование в <a class="reference external" href="https://en.wikipedia.org/wiki/Saddle_point">седловую точку</a>, характеризующуюся равенством нулю минимального собственного значения матрицы гессиана функции TPD. Подробнее численные способы нахождения STLL представлены в работах [<a class="reference external" href="https://doi.org/10.1016/j.fluid.2007.07.041">D.V. Nichita et al, 2007</a>; <a class="reference external" href="https://doi.org/10.1016/j.fluid.2016.01.015">D.V. Nichita, 2016</a>].</p>
</div>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">fig1</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">6.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xj1</span><span class="p">,</span> <span class="n">Dj_9</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;t = 9 °C&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xj1</span><span class="p">,</span> <span class="n">Dj_10</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;lime&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;t = 10 °C&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xj1</span><span class="p">,</span> <span class="n">Dj_11</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;t = 11 °C&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Количество вещества диоксида углерода в первой фазе, моль&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Tangent plane distance (TPD)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">ax1ins</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">inset_axes</span><span class="p">([</span><span class="mf">.55</span><span class="p">,</span> <span class="mf">.4</span><span class="p">,</span> <span class="mf">.42</span><span class="p">,</span> <span class="mf">.55</span><span class="p">],</span> <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">.7</span><span class="p">,</span> <span class="mf">1.</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">.04</span><span class="p">))</span>
<span class="n">ax1ins</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xj1</span><span class="p">,</span> <span class="n">Dj_9</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax1ins</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xj1</span><span class="p">,</span> <span class="n">Dj_10</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;lime&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax1ins</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xj1</span><span class="p">,</span> <span class="n">Dj_11</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax1ins</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="s1">&#39;$y_{1,CO_2} = 0.818$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
<span class="n">ax1ins</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.818</span><span class="p">,</span> <span class="mf">0.818</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">.035</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ax1ins</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.818</span><span class="p">],</span> <span class="p">[</span><span class="mf">1e-3</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ax1ins</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="s1">&#39;$y_{2,CO_2} = 0.918$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
<span class="n">ax1ins</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.918</span><span class="p">,</span> <span class="mf">0.918</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">.035</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ax1ins</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.918</span><span class="p">],</span> <span class="p">[</span><span class="mf">1e-3</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ax1ins</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax1ins</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Количество вещества диоксида</span><span class="se">\n</span><span class="s1">углерода в первой фазе, моль&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">ax1ins</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Tangent plane distance (TPD)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">ax1ins</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">ax1ins</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/7b42ac949bd1933834eef5f86c817c8bb1602df5c2f700eae34bff542db88f04.png" src="../../_images/7b42ac949bd1933834eef5f86c817c8bb1602df5c2f700eae34bff542db88f04.png" />
</div>
</div>
<p>По данным, представленным на графике выше, видно, что состояние фазы многофазной системы, находящейся в равновесном состоянии, является для этой фазы <em>насыщенным состоянием</em> при равновесных давлении, температуре и компонентном составе. Действительно, увеличение температуры на <span class="math notranslate nohighlight">\(1 \; ^{\circ} \mathrm{C}\)</span> нарушит равновесное состояние системы и приведет к изменению компонентных составов фаз, то есть к протеканию фазового перехода, что подтверждается отрицательностью функции TPD в нетривиальном минимуме. Аналогичный результат может быть получен для изменения давления и компонентного состава фазы, находящейся в насыщенном состоянии. Таким образом, внутри двухфазной области значения функции TPD отрицательны, что свидетельствует о нестабильности однофазового состояния.</p>
<section id="pvt-esc-saturation-psat">
<span id="id2"></span><h2>Определение давления насыщения<a class="headerlink" href="#pvt-esc-saturation-psat" title="Link to this heading">#</a></h2>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="note admonition">
<p class="admonition-title">Дополнительно</p>
<p>Здесь и далее под давлением (температурой) насыщения будем понимать такое давление (температуру), которое соответствует границе двухфазной области без разделения на линии насыщения и конденсации. Иными словами, это такое давление (температура), которое соответствует насыщенному состоянию рассматриваемой системы. Это обусловлено тем, что рассматриваемые в данном разделе алгоритмы равносильно применимы для определения точек как на линии насыщения, так и на линии начала конденсации.</p>
</div>
</aside>
<p>Задача нахождения насыщенного состояния, то есть давления насыщения для заданной температуры или температуры насыщения для заданного давления, является одной из основных в области прикладной термодинамики. Начиная с 80-х годов прошлого столетия было подготовлено множество научных работ, посвященных разработке численных методов решения данной проблемы, например, [<a class="reference external" href="https://doi.org/10.2118/7478-PA">L.E. Baker and K.D. Luks, 1980</a>; <a class="reference external" href="https://doi.org/10.1016/0378-3812(85)90005-6">M.L. Michelsen, 1985</a>; <a class="reference external" href="https://doi.org/10.1016/0378-3812(85)90059-7">L.X. Nghiem et al, 1985</a>].</p>
<p>Рассмотрим многокомпонентную (<span class="math notranslate nohighlight">\(N_c\)</span> – количество компонентов) систему известного компонентного состава <span class="math notranslate nohighlight">\(\mathbf{z} \in {\rm I\!R}^{N_c}\)</span> при заданной температуре <span class="math notranslate nohighlight">\(T\)</span>. Задача определения насыщенного состояния в этом случае будет заключаться в нахождении давления и компонентного состава “зарождающейся” (<em>incipient</em>) фазы, находящейся в термодинамическом равновесии с рассматриваемой системой. Таким образом, всего <span class="math notranslate nohighlight">\(\left( N_c + 1 \right)\)</span> неизвестных: <span class="math notranslate nohighlight">\(N_c\)</span> количеств вещества компонентов <span class="math notranslate nohighlight">\(Y_i, \, i = 1 \, \ldots \, N_c,\)</span> зарождающейся фазы и давление, соответствующее границе двухфазной области. Рассматриваемую задачу можно представить в виде системы, состоящей из <span class="math notranslate nohighlight">\(\left( N_c + 1 \right)\)</span> нелинейных уравнений: <span class="math notranslate nohighlight">\(N_c\)</span> уравнений термодинамического равновесия и одного уравнения, формулирующего условие нахождения рассматриваемой системы на границе двухфазной области:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align}
&amp; g_i = \ln k_i + \ln \varphi_i \left( P, \, T, \, \mathbf{y} \right) - \ln \varphi_i \left( P, \, T, \, \mathbf{z} \right) = 0, \; i = 1 \, \ldots \, N_c, \\
&amp; \bar{D} = \sum_{i=1}^{N_c} y_i \left( \ln y_i + \ln \varphi_i \left( P, \, T, \, \mathbf{y} \right) - \ln \varphi_i \left( P, \, T, \, \mathbf{z} \right) - \ln z_i \right) = 0,
\end{align} \end{split}\]</div>
<p>где <span class="math notranslate nohighlight">\(k_i = Y_i \, / \, z_i, \, i = 1 \, \ldots \, N_c,\)</span> при этом <span class="math notranslate nohighlight">\(y_i = Y_i \, / \, \sum_{i=1}^{N_c} Y_i, \, i = 1 \, \ldots \, N_c.\)</span></p>
<p>В данной системе <span class="math notranslate nohighlight">\(\left( N_c + 1 \right)\)</span>-е уравнение, определяющее условие нахождения рассматриваемой системы на границе двухфазной области, может быть альтернативно заменено на <a class="reference internal" href="SEC-1-Stability.html#pvt-sec-stability-pt-num"><span class="std std-ref">условие</span></a> равенства нулю значения приведенной функции TPD в стационарной точке:</p>
<div class="math notranslate nohighlight">
\[ \sum_{i=1}^{N_c} Y_i - 1 = 0. \]</div>
<p>Такое выражение было использовано автором работы [<a class="reference external" href="https://doi.org/10.1016/0378-3812(85)90005-6">M.L. Michelsen, 1985</a>] для нахождения давления и температуры насыщения. Преимуществом использования данного уравнения является более простой расчет частных производных при формировании матрицы якобиана, необходимой для решения системы нелинейных уравнений методом Ньютона. Тем не менее, в данном разделе определение насыщенного состояния будет основано на использовании условия равенства приведенной функции TPD нулю. Сравнение различных формулировок было представлено в работе [<a class="reference external" href="https://doi.org/10.1016/0378-3812(85)90059-7">L.X. Nghiem et al, 1985</a>].</p>
<p>Для решения системы уравнений, определяющей насыщенное состояние рассматриваемого компонентного состава, можно использовать различные численные методы, среди которых более подробно остановимся на двух: методе последовательных подстановок и методе Ньютона.</p>
<section id="pvt-esc-saturation-psat-ss">
<span id="id3"></span><h3>Метод последовательных подстановок для нахождения давления насыщения<a class="headerlink" href="#pvt-esc-saturation-psat-ss" title="Link to this heading">#</a></h3>
<p>Метод последовательных подстановок может быть использован для решения системы из <span class="math notranslate nohighlight">\(N_c\)</span> нелинейных уравнений, определяющих термодинамическое равновесие между зарождающейся фазой и исходным компонентным составом. В этом случае нелинейное уравнение, выражающее условие нахождения рассматриваемой системы на границе двухфазной области, необходимо решать во внутреннем цикле. Такой численный алгоритм несколько напоминает <a class="reference internal" href="SEC-5-Equilibrium.html#pvt-sec-equilibrium-pt-ss"><span class="std std-ref">подход к нахождению равновесного состояния</span></a>, в котором обновление констант фазового равновесия также осуществлялось во внешнем цикле методом последовательных подстановок, а во внутреннем решалось <a class="reference internal" href="SEC-2-RR.html"><span class="std std-doc">уравнение Речфорда-Райса</span></a>.</p>
<p>Обновление основных переменных для метода последовательных подстановок аналогично рассмотренному ранее <a class="reference internal" href="SEC-1-Stability.html#pvt-sec-stability-pt-ss"><span class="std std-ref">одноименному численному алгоритму для теста стабильности</span></a>:</p>
<div class="math notranslate nohighlight">
\[ \ln k_i^{k+1} = \ln k_i^{k} - g_i^{k}, \; i = 1 \, \ldots \, N_c, \]</div>
<p>где <span class="math notranslate nohighlight">\(k\)</span> – номер итерации.</p>
<p>Подробнее остановимся на решении уравнения, выражающего условие нахождения рассматриваемой системы на границе двухфазной области, относительно давления:</p>
<div class="math notranslate nohighlight">
\[ \bar{D} = \sum_{i=1}^{N_c} y_i \left( \ln y_i + \ln \varphi_i \left( P, \, T, \, \mathbf{y} \right) - \ln \varphi_i \left( P, \, T, \, \mathbf{z} \right) - \ln z_i \right) = 0. \]</div>
<div class="exercise admonition">
<p class="admonition-title">Пример</p>
<p>Пусть имеется <span class="math notranslate nohighlight">\(1 \; \mathrm{моль}\)</span> смеси следующего мольного состава:</p>
<div class="pst-scrollable-table-container"><table class="table" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Компонент</p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(\mathrm{CH_4}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(\mathrm{C_2 H_6}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(\mathrm{C_3 H_8}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(\mathrm{n \mbox{-} C_4}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(\mathrm{C_{5+}}\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>Мольная доля</p></td>
<td class="text-center"><p>0.7167</p></td>
<td class="text-center"><p>0.0895</p></td>
<td class="text-center"><p>0.0917</p></td>
<td class="text-center"><p>0.0448</p></td>
<td class="text-center"><p>0.0573</p></td>
</tr>
</tbody>
</table>
</div>
<br>
<p>Необходимо построить график приведенной функции <span class="math notranslate nohighlight">\(\bar{D}\)</span> от давления для температуры <span class="math notranslate nohighlight">\(68 \; ^{\circ} \mathrm{C}\)</span> и компонентного состава мнимой фазы <span class="math notranslate nohighlight">\(y_i, \, i = 1 \, \ldots \, N_c\)</span>:</p>
<div class="pst-scrollable-table-container"><table class="table" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Компонент</p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(\mathrm{CH_4}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(\mathrm{C_2 H_6}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(\mathrm{C_3 H_8}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(\mathrm{n \mbox{-} C_4}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(\mathrm{C_{5+}}\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>Мольная доля</p></td>
<td class="text-center"><p>0.6030</p></td>
<td class="text-center"><p>0.0929</p></td>
<td class="text-center"><p>0.1110</p></td>
<td class="text-center"><p>0.0631</p></td>
<td class="text-center"><p>0.1300</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Зададим температуру и компонентные составы.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="mf">68.</span> <span class="o">+</span> <span class="mf">273.15</span> <span class="c1"># [K]</span>
<span class="n">zi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.7167</span><span class="p">,</span> <span class="mf">0.0895</span><span class="p">,</span> <span class="mf">0.0917</span><span class="p">,</span> <span class="mf">0.0448</span><span class="p">,</span> <span class="mf">0.0573</span><span class="p">])</span>
<span class="n">yi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.6030</span><span class="p">,</span> <span class="mf">0.0929</span><span class="p">,</span> <span class="mf">0.1110</span><span class="p">,</span> <span class="mf">0.0631</span><span class="p">,</span> <span class="mf">0.1300</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Также зададим свойства компонентов и проинициализируем класс с уравнением состояния Пенга-Робинсона.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Pci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">4.599</span><span class="p">,</span> <span class="mf">4.872</span><span class="p">,</span> <span class="mf">4.248</span><span class="p">,</span> <span class="mf">3.796</span><span class="p">,</span> <span class="mf">2.398</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1e6</span> <span class="c1"># Critical pressures [Pa]</span>
<span class="n">Tci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">190.56</span><span class="p">,</span> <span class="mf">305.32</span><span class="p">,</span> <span class="mf">369.83</span><span class="p">,</span> <span class="mf">425.12</span><span class="p">,</span> <span class="mf">551.02</span><span class="p">])</span> <span class="c1"># Critical temperatures [K]</span>
<span class="n">wi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.012</span><span class="p">,</span> <span class="mf">0.100</span><span class="p">,</span> <span class="mf">0.152</span><span class="p">,</span> <span class="mf">0.200</span><span class="p">,</span> <span class="mf">0.414</span><span class="p">])</span> <span class="c1"># Acentric factors</span>
<span class="n">mwi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.016043</span><span class="p">,</span> <span class="mf">0.03007</span><span class="p">,</span> <span class="mf">0.044097</span><span class="p">,</span> <span class="mf">0.058123</span><span class="p">,</span> <span class="mf">0.120</span><span class="p">])</span> <span class="c1"># Molar mass [kg/gmole]</span>
<span class="n">vsi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.1595</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1134</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0863</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0675</span><span class="p">,</span> <span class="mf">0.05661</span><span class="p">])</span> <span class="c1"># Volume shift parameters</span>
<span class="n">dij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="mf">0.002689</span><span class="p">,</span>
    <span class="mf">0.008537</span><span class="p">,</span> <span class="mf">0.001662</span><span class="p">,</span>
    <span class="mf">0.014748</span><span class="p">,</span> <span class="mf">0.004914</span><span class="p">,</span> <span class="mf">0.000866</span><span class="p">,</span>
    <span class="mf">0.039265</span><span class="p">,</span> <span class="mf">0.021924</span><span class="p">,</span> <span class="mf">0.011676</span><span class="p">,</span> <span class="mf">0.006228</span><span class="p">,</span>
<span class="p">])</span> <span class="c1"># Binary interaction parameters</span>
<span class="n">pr</span> <span class="o">=</span> <span class="n">pr78</span><span class="p">(</span><span class="n">Pci</span><span class="p">,</span> <span class="n">Tci</span><span class="p">,</span> <span class="n">wi</span><span class="p">,</span> <span class="n">mwi</span><span class="p">,</span> <span class="n">vsi</span><span class="p">,</span> <span class="n">dij</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Для расчета логарифмов коэффициентов летучести компонентов для различных давлений будем использовать метод <code class="docutils literal notranslate"><span class="pre">getPT_Zj_lnphiji</span></code> инициализированного класса с уравнением состояния, принимающий на вход набор давлений (Па) размерностью <code class="docutils literal notranslate"><span class="pre">(Np,)</span></code>, температуру (K) и компонентный состав размерностью <code class="docutils literal notranslate"><span class="pre">(Nc,)</span></code>, и возвращающий одномерный массив (вектор) состояний систем для каждого давления в наборе, вектор коэффициентов сверхсжимаемости, а также двумерный массив (матрицу) логарифмов коэффициентов летучести компонентов.</p>
<p>Создадим набор давлений и вычислим логарифмы коэффициентов летучести.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Pj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">2e6</span><span class="p">,</span> <span class="mf">20e6</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">lnphizji</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">getPT_Zj_lnphiji</span><span class="p">(</span><span class="n">Pj</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">zi</span><span class="p">)</span>
<span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">lnphiyji</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">getPT_Zj_lnphiji</span><span class="p">(</span><span class="n">Pj</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Получим значения исследуемой функции для заданного набора давлений.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Dj</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">yi</span><span class="p">)</span> <span class="o">+</span> <span class="n">lnphiyji</span> <span class="o">-</span> <span class="n">lnphizji</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">zi</span><span class="p">))</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">yi</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Построим график функции.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig3</span><span class="p">,</span> <span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">6.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Pj</span> <span class="o">/</span> <span class="mf">1e6</span><span class="p">,</span> <span class="n">Dj</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">20.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Давление, МПа&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\bar</span><span class="si">{D}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">20.</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/82f3c0553e4e67cbe7391782e1361b826ee8dddee1d5863ef635f96388651d69.png" src="../../_images/82f3c0553e4e67cbe7391782e1361b826ee8dddee1d5863ef635f96388651d69.png" />
</div>
</div>
<p>Из данного графика можно сделать вывод, что рассматриваемая функция не является выпуклой и может иметь несколько пересечений с осью абсцисс. Следовательно, для повышения надежности решения уравнения, выражающего условие нахождения рассматриваемой системы на границе двухфазной области, относительно давления необходимо локализовать искомый корень на некотором интервале. Для решения этой проблемы можно использовать процедуру <em>предварительного поиска решения</em> (<em>preliminary search</em>), заключающуюся в исследовании изменения знака функции. При этом необходимо отметить, что для произвольной температуры может существовать несколько значений давлений, удовлетворяющих условию нахождения термодинамической системы в насыщенном состоянии: например, верхнее и нижнее давление на кривой точек росы (<em>upper and lower dew points</em>). Таким образом, для рассматриваемого в рамках данного раздела алгоритма определения давления насыщения необходимо явно задавать соответствие искомого значения верхней или нижней кривой насыщения.</p>
<p>Предварительный поиск решения может быть выполнен с использованием процедуры наложения сетки (<em>gridding procedure</em>), которая заключается в разбиении некоторого интервала на множество более мелких, на границах которых определяется знак исследуемой функции. Если на границах одного отрезка знак функции будет отличаться, то этот отрезок будет содержать в себе корень уравнения. Недостатком данного подхода является необходимость вычисления значения функции для всех узлов сетки, а преимуществом – потенциальная локализация всех возможных корней уравнения при достаточно мелких размерах отрезков. С другой стороны, при явном задании направления предварительного поиска (путем указания принадлежности искомой точки верхней или нижней кривой насыщения), можно остановить последовательное вычисление значения функции в узлах сетки, как только будет найден хотя бы один интервал, на границах которых отличаются знаки исследуемой функции.</p>
<p>Сформулируем алгоритм для локализации корня уравнения с использованием предварительного поиска.</p>
<div class="algorithm admonition">
<p class="admonition-title">Алгоритм. Предварительный поиск корня уравнения (давления насыщения)</p>
<p><strong>Дано:</strong> Вектор компонентного состава исследуемой системы <span class="math notranslate nohighlight">\(\mathbf{z} \in {\rm I\!R}^{N_c}\)</span>; температура <span class="math notranslate nohighlight">\(T\)</span>; количество вещества в системе <span class="math notranslate nohighlight">\(n=1 \, моль\)</span>; необходимые свойства компонентов для нахождения коэффициентов летучести компонентов с использованием уравнения состояния; логический оператор <span class="math notranslate nohighlight">\(upper\)</span>, отражающий принадлежность искомого состояния верхней или нижней кривой насыщения; минимальное <span class="math notranslate nohighlight">\(P_{min}\)</span> и максимальное <span class="math notranslate nohighlight">\(P_{max}\)</span> давления для предварительного поиска корня уравнения; количество узлов для построения сетки <span class="math notranslate nohighlight">\(N_{nodes}\)</span>.</p>
<p><strong>Определить:</strong> Границы отрезка <span class="math notranslate nohighlight">\(P_1\)</span> и <span class="math notranslate nohighlight">\(P_2\)</span> с давлением насыщения: <span class="math notranslate nohighlight">\(P_{min} &lt; P_1 &lt; P^* &lt; P_2 &lt; P_{max}\)</span>, где <span class="math notranslate nohighlight">\(P^*\)</span> – давление насыщения.</p>
<p><strong>Псевдокод:</strong><br />
<strong>def</strong> <span class="math notranslate nohighlight">\(fstab \left( P, \, \mathbf{y} \in {\rm I\!R}^{N_c}, \, \ldots \right) \rightarrow stable\)</span> <span class="multilinecomment"># Функция для определения стабильности компонентного состава при заданном давлении</span><br />
 </p>
</div>
</section>
</section>
<section id="pvt-esc-saturation-tsat">
<span id="id4"></span><h2>Определение температуры насыщения<a class="headerlink" href="#pvt-esc-saturation-tsat" title="Link to this heading">#</a></h2>
</section>
<section id="pvt-esc-saturation-psatmax">
<span id="id5"></span><h2>Определение криконденбары<a class="headerlink" href="#pvt-esc-saturation-psatmax" title="Link to this heading">#</a></h2>
</section>
<section id="pvt-esc-saturation-tsatmax">
<span id="id6"></span><h2>Определение крикондентермы<a class="headerlink" href="#pvt-esc-saturation-tsatmax" title="Link to this heading">#</a></h2>
</section>
<section id="pvt-esc-saturation-bound">
<span id="id7"></span><h2>Построение границы двухфазной области<a class="headerlink" href="#pvt-esc-saturation-bound" title="Link to this heading">#</a></h2>
</section>
<section id="pvt-esc-saturation-internals">
<span id="id8"></span><h2>Промежуточные линии (линии постоянной мольной доли фазы)<a class="headerlink" href="#pvt-esc-saturation-internals" title="Link to this heading">#</a></h2>
</section>
<section id="pvt-esc-saturation-retrograde">
<span id="id9"></span><h2>Границы ретроградных областей<a class="headerlink" href="#pvt-esc-saturation-retrograde" title="Link to this heading">#</a></h2>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./1-PVT\3-SEC"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="SEC-5-Equilibrium.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Определение равновесного состояния системы</p>
      </div>
    </a>
    <a class="right-next"
       href="SEC-7-Criticality.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Определение критического состояния системы</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pvt-esc-saturation-psat">Определение давления насыщения</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pvt-esc-saturation-psat-ss">Метод последовательных подстановок для нахождения давления насыщения</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pvt-esc-saturation-tsat">Определение температуры насыщения</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pvt-esc-saturation-psatmax">Определение криконденбары</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pvt-esc-saturation-tsatmax">Определение крикондентермы</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pvt-esc-saturation-bound">Построение границы двухфазной области</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pvt-esc-saturation-internals">Промежуточные линии (линии постоянной мольной доли фазы)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pvt-esc-saturation-retrograde">Границы ретроградных областей</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Daniel Skorov
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022 – 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>