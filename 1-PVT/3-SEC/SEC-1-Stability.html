
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Определение стабильности фазового состояния системы &#8212; Основы моделирования пластовых систем</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=5194fb77" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '1-PVT/3-SEC/SEC-1-Stability';</script>
    <script src="../../_static/custom.js?v=4c678b35"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Уравнение Речфорда-Райса" href="SEC-2-RR.html" />
    <link rel="prev" title="Стабильность. Равновесие. Критическое состояние" href="SEC-0-Introduction.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../Introduction.html">
  
  
  
  
  
  
    <p class="title logo__title">Основы моделирования пластовых систем</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../Introduction.html">
                    Основы моделирования пластовых систем
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Основы вычислительной математики</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../0-Math/Math-Introduction.html">Введение</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../0-Math/0-LAB/LAB-0-Introduction.html">Основы линейной алгебры</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../0-Math/0-LAB/LAB-1-Vectors.html">Вектор. Координаты вектора</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../0-Math/0-LAB/LAB-2-VectorOperations.html">Операции с векторами</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../0-Math/0-LAB/LAB-3-RotationAngles.html">Направляющие косинусы</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../0-Math/0-LAB/LAB-4-Matrices.html">Матрицы</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../0-Math/0-LAB/LAB-5-Determinant-InverseMatrix.html">Определитель матрицы. Обратная матрица</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../0-Math/0-LAB/LAB-6-Eigenvalues-Eigenvectors.html">Собственные векторы и значения матриц</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../0-Math/0-LAB/LAB-7-LinearTransformations.html">Линейные преобразования</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../0-Math/0-LAB/LAB-8-MatrixDefiniteness.html">Определенность матриц</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../0-Math/0-LAB/LAB-9-Decomposition.html">Разложение матриц</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../0-Math/0-LAB/LAB-10-LinearSystems.html">Решение систем линейных уравнений</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../0-Math/0-LAB/LAB-11-ConditionNumber.html">Число обусловленности</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../0-Math/0-LAB/LAB-12-Preconditioner.html">Предобуславливание</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../0-Math/1-OM/OM-0-Introduction.html">Методы оптимизации функций</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PVT-моделирование</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../PVT-Introduction.html">Введение</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../1-TD/TD-0-Introduction.html">Основы термодинамики</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-1-Basics.html">Введение в термодинамику</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-2-ThermalEquilibrium.html">Термическое равновесие. Температура. Нулевое начало термодинамики</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-3-Heat-Work.html">Количество теплоты и работа. Первое начало термодинамики</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-4-HeatCapacity.html">Теплоемкость</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-5-Enthalpy.html">Энтальпия</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-6-Entropy.html">Энтропия. Второе и третье начала термодинамики</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-7-ChemicalPotential.html">Химический потенциал</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-8-Helmholtz-Gibbs.html">Энергия Гельмгольца. Энергия Гиббса</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-9-Observables.html">Интенсивные и экстенсивные параметры</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-10-MixtureGibbsEnergy.html">Энергия Гиббса многокомпонентной системы</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-11-GibbsPhaseRule.html">Правило фаз Гиббса</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-12-GibbsDuhemEquation.html">Уравнение Гиббса-Дюгема</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-13-MaxwellRelations.html">Соотношения Максвелла</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-14-PhaseEquilibrium.html">Свободная энергия и фазовое равновесие</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-15-Fugacity.html">Летучесть</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../2-EOS/EOS-0-Introduction.html">Уравнения состояния</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../2-EOS/EOS-1-VanDerWaals.html">Уравнение состояния Ван-дер-Ваальса</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-EOS/EOS-2-SRK-PR.html">Уравнения состояния Суаве-Редлиха-Квонга и Пенга-Робинсона</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-EOS/EOS-3-CPA.html">Кубическое уравнение состояние с учетом ассоциации молекул</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-EOS/EOS-Appendix-A-PD.html">Частные производные летучести компонентов</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-EOS/EOS-Appendix-B-BIP.html">Универсальный расчет коэффициентов попарного взаимодействия</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-EOS/EOS-Appendix-C-HV.html">Правило смешивания Хьюрона-Видаля</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="SEC-0-Introduction.html">Стабильность. Равновесие. Критическое состояние</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Определение стабильности фазового состояния системы</a></li>
<li class="toctree-l2"><a class="reference internal" href="SEC-2-RR.html">Уравнение Речфорда-Райса</a></li>
<li class="toctree-l2"><a class="reference internal" href="SEC-3-RR-2P.html">Уравнение Речфорда-Райса для двухфазных систем</a></li>
<li class="toctree-l2"><a class="reference internal" href="SEC-4-RR-NP.html">Уравнение Речфорда-Райса для многофазных систем</a></li>
<li class="toctree-l2"><a class="reference internal" href="SEC-5-Equilibrium.html">Определение равновесного состояния системы</a></li>
<li class="toctree-l2"><a class="reference internal" href="SEC-6-Saturation.html">Определение насыщенного состояния системы</a></li>
<li class="toctree-l2"><a class="reference internal" href="SEC-7-Criticality.html">Определение критического состояния системы</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../4-LAB/LAB-0-Introduction.html">Моделирование лабораторных исследований</a></li>
<li class="toctree-l1"><a class="reference internal" href="../5-ETC/ETC-0-Introduction.html">Применение PVT-моделирования для решения практических задач проектирования месторождений углеводородов</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/1-PVT/3-SEC/SEC-1-Stability.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Определение стабильности фазового состояния системы</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pt">PT-термодинамика</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pvt-sec-stability-pt-theory">Теоретические основы анализа стабильности фазового состояния системы</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pvt-sec-stability-pt-num">Численный подход к проверке стабильности фазового состояния системы</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pvt-sec-stability-pt-ss">Метод последовательных подстановок</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pvt-sec-stability-pt-ss-init">Начальные приближения</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pvt-sec-stability-pt-ss-examples">Примеры</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pvt-sec-stability-pt-newton">Метод минимизации функции</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pvt-sec-stability-pt-newton-init">Начальные приближения</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pvt-sec-stability-pt-newton-examples">Примеры</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vt">VT-термодинамика</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="pvt-sec-stability">
<span id="id1"></span><h1>Определение стабильности фазового состояния системы<a class="headerlink" href="#pvt-sec-stability" title="Link to this heading">#</a></h1>
<p>В данном разделе будут представлены критерии стабильности фазового состояния системы, позволяющие определить, является ли рассматриваемое фазовое состояние системы стабильным для различных формулировок (<a class="reference internal" href="#pvt-sec-stability-pt">PT-термодинамика</a> и <a class="reference internal" href="#pvt-sec-stability-vt"><span class="std std-ref">VT-термодинамика</span></a>), а также численные алгоритмы и их реализации. Выбор той или иной формулировки зачастую определяется теми переменными, через которые удобнее выражать уравнение состояния. Проверка стабильности фазового равновесия является первым из двух последовательных шагов к определению равновесного фазового состояния системы.</p>
<section id="pt">
<span id="pvt-sec-stability-pt"></span><h2>PT-термодинамика<a class="headerlink" href="#pt" title="Link to this heading">#</a></h2>
<section id="pvt-sec-stability-pt-theory">
<span id="id2"></span><h3>Теоретические основы анализа стабильности фазового состояния системы<a class="headerlink" href="#pvt-sec-stability-pt-theory" title="Link to this heading">#</a></h3>
<p>Пусть некоторая многокомпонентная макроскопическая система находится в равновесном состоянии и характеризуется давлением <span class="math notranslate nohighlight">\(P\)</span>, температурой <span class="math notranslate nohighlight">\(T\)</span> и количеством вещества всех компонентов <span class="math notranslate nohighlight">\(n_i, \, i = 1 \, \ldots \, N_c,\)</span> где <span class="math notranslate nohighlight">\(N_c\)</span> – число компонентов, составляющих рассматриваемую систему. Можем ли мы использовать некоторое уравнение состояния для описания взаимосвязей между термодинамическими параметрами? Ответ на этот вопрос зависит от того, является ли рассматриваемая система гомогенной, то есть состоящей из одной сплошной фазы. Иными словами, является ли однофазное состояние рассматриваемой системы <em>стабильным</em>. Именно исследованию данного вопроса будет посвящен настоящий раздел. Однако, прежде чем переходить к рассмотрению темы стабильности фазового состояния системы, необходимо ввести ряд определений. Некоторые из них будут перекликаться с рассмотренными ранее темами, но при этом являться более обобщенными. Теоретическое изложение рассматриваемой проблемы соответствует работе [<a class="reference external" href="https://doi.org/10.2118/9806-PA">Baker et al, 1982</a>].</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="note admonition">
<p class="admonition-title">Дополнительно</p>
<p>При использовании двойного индексирования здесь и далее первый индекс будет обозначать фазу, второй – компонент. То есть под <span class="math notranslate nohighlight">\(n_{ji}\)</span> следует понимать количество вещества <span class="math notranslate nohighlight">\(i\)</span>-го компонента в <span class="math notranslate nohighlight">\(j\)</span>-й фазе, а под, например, <span class="math notranslate nohighlight">\(\mu_{N_pk}\)</span> – химический потенциал <span class="math notranslate nohighlight">\(k\)</span>-го компонента в <span class="math notranslate nohighlight">\(N_p\)</span>-й фазе. При использовании одинарного индексирования будет явно указано отношение данного элемента к вектору, характеризующему свойства фаз или компонентов.</p>
</div>
</aside>
<div class="tip admonition">
<p class="admonition-title">Определение</p>
<p>Пусть имеется некоторая <span class="math notranslate nohighlight">\(j\)</span>-ая фаза, многофазной системы, состоящая из <span class="math notranslate nohighlight">\(N_c\)</span> компонентов, при этом количество вещества компонентов в фазе <span class="math notranslate nohighlight">\(j\)</span> определяется следующим <a class="reference internal" href="../../0-Math/0-LAB/LAB-1-Vectors.html"><span class="std std-doc">вектором</span></a>:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \mathbf{n}_j = \begin{bmatrix} n_{j1} \\ n_{j2} \\ \vdots \\ n_{jN_c} \end{bmatrix}, \; j = 1 \, \ldots \, N_p. \end{split}\]</div>
<p>Если количество вещества компонентов в системе в целом определяется вектором</p>
<div class="math notranslate nohighlight">
\[\begin{split} \mathbf{n} = \begin{bmatrix} n_1 \\ n_2 \\ \vdots \\ n_{N_c} \end{bmatrix}, \end{split}\]</div>
<p>то фаза <span class="math notranslate nohighlight">\(j\)</span> является <em><strong>допустимой</strong></em> <em>(admissible)</em>, если</p>
<div class="math notranslate nohighlight">
\[ 0 &lt; n_{ji} &lt; n_i, \; j = 1 \, \ldots \, N_p, \; i = 1 \, \ldots \, N_c. \]</div>
</div>
<p>Иными словами, фаза является <em>допустимой</em>, если количество вещества каждого компонента, в нее входящего, меньше количества вещества этого же компонента в системе в целом. Все дальнейшие выкладки будут касаться допустимых фаз, в которых представлены все компоненты, не взаимодействующие друг с другом с образованием новых компонентов, то есть не вступающие в реакции. Для допустимых фаз справедливо следущее соотношение:</p>
<div class="math notranslate nohighlight">
\[ \sum_{j=1}^{N_p} n_{ji} = n_i, \; i = 1 \, \ldots \, N_c, \]</div>
<p>где <span class="math notranslate nohighlight">\(N_p\)</span> – количество фаз в системе, а <span class="math notranslate nohighlight">\(N_c\)</span> – число компонентов. При известных и заданных давлении и температуре рассматриваемой системы, а также количествах вещества компонентов в ней <a class="reference internal" href="../1-TD/TD-10-MixtureGibbsEnergy.html"><span class="std std-doc">энергия Гиббса</span></a> некоторой фазы определяется количеством вещества каждого компонента в фазе, то есть:</p>
<div class="math notranslate nohighlight">
\[ G_j = G_j \left( \mathbf{n}_j \right), \; j = 1 \, \ldots \, N_p. \]</div>
<p>Учитывая <a class="reference internal" href="../1-TD/TD-9-Observables.html#pvt-td-observables-extensive"><span class="std std-ref">экстенсивность</span></a> энергии Гиббса, для многофазной системы справедливо следующее соотношение:</p>
<div class="math notranslate nohighlight">
\[ G \left( \mathbf{n} \right) = G \left( \mathbf{n}_1, \, \mathbf{n}_2, \, \ldots, \, \mathbf{n}_{N_p} \right) = \sum_{j=1}^{N_p} G_j \left( \mathbf{n}_j \right). \]</div>
<p>Здесь и далее вместо перечисления векторов количеств вещества компонентов в фазах, соответствующих некоторому состоянию, будем использовать обозначение <span class="math notranslate nohighlight">\(G \left( \mathbf{n}_1, \, \mathbf{n}_2, \, \ldots, \, \mathbf{n}_{N_p} \right) \equiv G \left( \hat{M} \right)\)</span>.</p>
<div class="tip admonition">
<p class="admonition-title">Определение</p>
<p>Некоторое <span class="math notranslate nohighlight">\(\hat{M} = \left\{ \mathbf{n}_j, \, j = 1 \, \ldots \, N_p \right\}\)</span> состояние системы, характеризующееся <span class="math notranslate nohighlight">\(N_p\)</span> количеством <em>допустимых</em> фаз, удовлетворяющих закону сохранения масс, является <em><strong>равновесным</strong></em>, если:</p>
<div class="math notranslate nohighlight">
\[ G \left( \hat{M} \right) = \min_{\hat{K}} G \left( \hat{K} \right), \]</div>
<p>где минимум берется по всем состояниям <span class="math notranslate nohighlight">\(\hat{K} = \left\{ \mathbf{r}_k, \, k = 1 \, \ldots \, K_p \right\}\)</span>, характеризующимся <span class="math notranslate nohighlight">\(K_p\)</span> количеством <em>допустимых</em> фаз, удовлетворяющих закону сохранения масс.</p>
</div>
<p>В данном определении необходимо отметить два момента. Первый: <em>равновесное состояние</em> характеризуется минимумом энергии Гиббса всей многофазной системы. Более подробно это рассматривалось <a class="reference internal" href="../1-TD/TD-14-PhaseEquilibrium.html"><span class="std std-doc">ранее</span></a>. Второй: для того чтобы доказать, что некоторое состояние <span class="math notranslate nohighlight">\(\hat{M}\)</span> многофазной системы из <span class="math notranslate nohighlight">\(N_p\)</span> фаз является <em>равновесным</em>, мы можем рассмотреть множество других состояний <span class="math notranslate nohighlight">\(\hat{K}\)</span>, каждое из которых будет характеризоваться своим числом фаз <span class="math notranslate nohighlight">\(K_p\)</span>, и если в состоянии <span class="math notranslate nohighlight">\(\hat{M}\)</span> с количеством фаз <span class="math notranslate nohighlight">\(N_p\)</span> энергия Гиббса меньше всего, то оно и будет равновесным.</p>
<p>Представленное в предыдущем определении условие идентификации равновесного состояния, по сути, аналогично условию нахождения <a class="reference external" href="https://en.wikipedia.org/wiki/Maximum_and_minimum">глобального минимума функции</a>. <a class="reference external" href="https://en.wikipedia.org/wiki/First_derivative_test">Известно</a>, что необходимым условием для соответствия некоторой точки (состояния) глобальному минимуму функции (энергии Гиббса) является равенство нулю производной этой функции по независимым переменным в этой точке (этом состоянии). Такое состояние, в котором энергия Гиббса всей многофазной многокомпонентной системы характеризуется равенством нулю частной производной по количеству вещества <span class="math notranslate nohighlight">\(i\)</span>-го компонента в <span class="math notranslate nohighlight">\(j\)</span>-ой фазе при фиксированных давлении и температуре, будет характеризоваться равенством химических потенциалов соответствующих компонентов в фазах.</p>
<div class="danger admonition">
<p class="admonition-title">Теорема</p>
<p>Пусть многофазная многокомпонентная система находится при фиксированных давлении <span class="math notranslate nohighlight">\(P\)</span>, температуре <span class="math notranslate nohighlight">\(T\)</span> и количествах вещества компонентов в ней <span class="math notranslate nohighlight">\(n_i, \, i = 1 \, \ldots \, N_c,\)</span> в некотором состоянии с количеством фаз <span class="math notranslate nohighlight">\(N_p\)</span> с соответствующими количествами вещества компонентов <span class="math notranslate nohighlight">\(n_{ji}, \, j = 1 \, \ldots \, N_p, \, i = 1 \, \ldots \, N_c\)</span>, в котором частная производная энергии Гиббса всей системы по <span class="math notranslate nohighlight">\(n_{ji}\)</span> равна нулю:</p>
<div class="math notranslate nohighlight">
\[ \left( \frac{\partial G}{\partial n_{ji}} \right)_{P,T,n_{lk}, l \neq j, k \neq i} = 0, \; j = 1 \, \ldots \, N_p, \; i = 1 \, \ldots \, N_c. \]</div>
<p>Тогда для такого состояния системы будет справедливо следующее равенство:</p>
<div class="math notranslate nohighlight">
\[ \mu_{ji} = \mu_{N_pi}, \; j = 1 \, \ldots \, N_p - 1, \; i = 1 \, \ldots \, N_c. \]</div>
</div>
<p>Докажем  это следующим образом.</p>
<div class="proof admonition">
<p class="admonition-title">Доказательство</p>
<p>Учитывая экстенсивность энергии Гиббса, преобразуем частную производную энергии Гиббса всей системы по <span class="math notranslate nohighlight">\(n_{ji}\)</span> следующим образом:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align}
\left( \frac{\partial G}{\partial n_{ji}} \right)_{P,T,n_{lk}, l \neq j, k \neq i}
&amp;= \frac{\partial}{\partial n_{ji}} \left( \sum_{l=1}^{N_p} G_l \left( \mathbf{n}_l \right) \right)_{P,T,n_{lk}, l \neq j, k \neq i} \\
&amp;= \frac{\partial}{\partial n_{ji}} \left( \sum_{l=1}^{N_p-1} G_l \left( \mathbf{n}_l \right) \right)_{P,T,n_{lk}, l \neq j, k \neq i} + \left( \frac{\partial G_{N_p} \left( \mathbf{n}_{N_p} \right)}{\partial n_{ji}} \right)_{P,T,n_{N_pk},k \neq i} \\
&amp;= \sum_{l=1}^{N_p-1} \left( \frac{\partial G_l \left( \mathbf{n}_l \right)}{\partial n_{ji}} \right)_{P,T,n_{lk}, l \neq j, k \neq i} + \left( \frac{\partial G_{N_p} \left( \mathbf{n}_{N_p} \right)}{\partial n_{ji}} \right)_{P,T,n_{N_pk},k \neq i}.
\end{align} \end{split}\]</div>
<p>Принимая во внимание, что энергия Гиббса <span class="math notranslate nohighlight">\(j\)</span>-й фазы зависит от количеств вещества компонентов в этой <span class="math notranslate nohighlight">\(j\)</span>-й фазе, то есть:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \left( \frac{\partial G_l \left( \mathbf{n}_l \right)}{\partial n_{ji}} \right)_{P,T,n_{lk}, l \neq j, k \neq i} = \begin{cases} \left( \frac{\partial G_j \left( \mathbf{n}_j \right)}{\partial n_{ji}} \right)_{P,T,n_{jk}, k \neq i}, \; &amp; \mathrm{if} \; l = j, \; l = 1 \, \ldots \, N_p - 1, \; j = 1 \, \ldots \, N_p, \\ 0, \; &amp; \mathrm{if} \; l \neq j, \; l = 1 \, \ldots \, N_p - 1, \; j = 1 \, \ldots \, N_p, \end{cases} \end{split}\]</div>
<p>частная производная энергии Гиббса всей системы по <span class="math notranslate nohighlight">\(n_{ji}\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \left( \frac{\partial G}{\partial n_{ji}} \right)_{P,T,n_{lk}, l \neq j, k \neq i} = \left( \frac{\partial G_j \left( \mathbf{n}_j \right)}{\partial n_{ji}} \right)_{P,T,n_{jk}, k \neq i} + \left( \frac{\partial G_{N_p} \left( \mathbf{n}_{N_p} \right)}{\partial n_{ji}} \right)_{P,T,n_{N_pk},k \neq i}. \]</div>
<p>Учитывая правило нахождения сложной функции, данное выражение преобразуется следующим образом:</p>
<div class="math notranslate nohighlight">
\[ \left( \frac{\partial G}{\partial n_{ji}} \right)_{P,T,n_{lk}, l \neq j, k \neq i} = \left( \frac{\partial G_j \left( \mathbf{n}_j \right)}{\partial n_{ji}} \right)_{P,T,n_{jk}, k \neq i} + \left( \frac{\partial G_{N_p} \left( \mathbf{n}_{N_p} \right)}{\partial n_{N_pi}} \right)_{P,T,n_{N_pk},k \neq i} \left( \frac{\partial n_{N_pi}}{\partial n_{ji}} \right)_{P,T,n_{N_pk},k \neq i}. \]</div>
<p>Выразим количество вещества <span class="math notranslate nohighlight">\(i\)</span>-го компонента в <span class="math notranslate nohighlight">\(N_p\)</span>-й фазе через количество вещества <span class="math notranslate nohighlight">\(i\)</span>-го компонента в системе в целом и в других фазах:</p>
<div class="math notranslate nohighlight">
\[ \sum_{l=1}^{N_p} n_{li} = n_i, \; i = 1 \, \ldots \, N_c \Rightarrow n_{N_pi} = n_i - \sum_{l=1}^{N_p-1} n_{li}, \; i = 1 \, \ldots \, N_c. \]</div>
<p>Тогда частная прозводная количества вещества <span class="math notranslate nohighlight">\(i\)</span>-го компонента в <span class="math notranslate nohighlight">\(N_p\)</span>-й фазе по количеству вещества <span class="math notranslate nohighlight">\(i\)</span>-го компонента в <span class="math notranslate nohighlight">\(j\)</span>-ой фазе:</p>
<div class="math notranslate nohighlight">
\[ \left( \frac{\partial n_{N_pi}}{\partial n_{ji}} \right)_{P,T,n_{N_pk},k \neq i} = \left( \frac{\partial n_i}{\partial n_{ji}} \right)_{P,T,n_{N_pk},k \neq i} - \sum_{l=1}^{N_p-1} \left( \frac{\partial n_{li}}{\partial n_{ji}} \right)_{P,T,n_{lk},k \neq i,l \neq j}. \]</div>
<p>Первое слагаемое в данном выражении равно нулю, поскольку количество вещества каждого компонента в системе в целом зафиксировано. Второе слагаемое можно представить следующим образом:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \left( \frac{\partial n_{li}}{\partial n_{ji}} \right)_{P,T,n_{lk},k \neq i,l \neq j} = \begin{cases} 1, &amp; \mathrm{if} \; l = j, \; l = 1 \ldots N_p - 1, \; j = 1 \, \ldots N_p, \\ 0, &amp; \mathrm{if} \; l \neq j, \; l = 1 \ldots N_p - 1, \; j = 1 \, \ldots N_p. \end{cases} \end{split}\]</div>
<p>Таким образом,</p>
<div class="math notranslate nohighlight">
\[\begin{split} \left( \frac{\partial n_{N_pi}}{\partial n_{ji}} \right)_{P,T,n_{N_pk},k \neq i} = \begin{cases} -1, &amp; \mathrm{if} \; j = N_p, \; j = 1 \, \ldots \, N_p, \\ 0, &amp; \mathrm{if} \; j \neq N_p, \; j = 1 \, \ldots \, N_p. \end{cases} \end{split}\]</div>
<p>С учетом этого частная производная энергии Гиббса всей системы по <span class="math notranslate nohighlight">\(n_{ji}\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \left( \frac{\partial G}{\partial n_{ji}} \right)_{P,T,n_{lk}, l \neq j, k \neq i} = \left( \frac{\partial G_j \left( \mathbf{n}_j \right)}{\partial n_{ji}} \right)_{P,T,n_{jk}, k \neq i} - \left( \frac{\partial G_{N_p} \left( \mathbf{n}_{N_p} \right)}{\partial n_{N_pi}} \right)_{P,T,n_{N_pk},k \neq i} = 0. \]</div>
<p>Поскольку частная производная энергии Гиббса некоторой фазы по количеству вещества <span class="math notranslate nohighlight">\(i\)</span>-го компонента в этой фазе при фиксированных давлении и температуре <a class="reference internal" href="../1-TD/TD-10-MixtureGibbsEnergy.html"><span class="std std-doc">соответствует</span></a> химическому потенциалу <span class="math notranslate nohighlight">\(i\)</span>-го компонента в этой фазе, то:</p>
<div class="math notranslate nohighlight">
\[ \mu_{ji} - \mu_{N_pi} = 0, \; i = 1 \, \ldots \, N_c, \; j = 1 \, \ldots \, N_p. \]</div>
</div>
<p>Поскольу условие равенства нулю частной производной энергии Гиббса системы в целом по количеству вещества <span class="math notranslate nohighlight">\(i\)</span>-го компонента в <span class="math notranslate nohighlight">\(j\)</span>-ой фазе при фиксированных давлении и температуре является необходимым для определения глобального минимума функции, но не достаточным, то рассматриваемая система может характеризоваться набором состояний, удовлетворяющих данному условию. Такие состояния будем называть <em>стационарными</em>.</p>
<div class="tip admonition">
<p class="admonition-title">Определение</p>
<p>Cостояние <span class="math notranslate nohighlight">\(\hat{M} = \left\{ \mathbf{n}_j, \, j = 1 \, \ldots \, N_p \right\}\)</span> является <em><strong>стационарным</strong></em>, если:</p>
<div class="math notranslate nohighlight">
\[ \left( \frac{\partial G}{\partial n_{ji}} \right)_{P,T,n_{lk},k \neq i, l \neq j} = 0, \; i = 1 \, \ldots \, N_c, \; j = 1 \, \ldots \, N_p. \]</div>
</div>
<p>Используя термин <em>стационарного</em> состояния, можно заменить данное выше определение <em>равновесного</em> состояния на следующее:</p>
<div class="tip admonition">
<p class="admonition-title">Определение</p>
<p>Некоторое <em>стационарное</em> состояние системы <span class="math notranslate nohighlight">\(\hat{M} = \left\{ \mathbf{n}_j, \, j = 1 \, \ldots \, N_p \right\}\)</span>, характеризующееся <span class="math notranslate nohighlight">\(N_p\)</span> количеством <em>допустимых</em> фаз, удовлетворяющих закону сохранения масс, является <em><strong>равновесным</strong></em>, если:</p>
<div class="math notranslate nohighlight">
\[ G \left( \hat{M} \right) \leq G \left( \hat{K} \right), \]</div>
<p>где <span class="math notranslate nohighlight">\(\hat{K} = \left\{ \mathbf{r}_k, \, k = 1 \, \ldots \, K_p \right\}\)</span> обозначает другие <em>стационарные</em> состояния системы, характеризующиеся <span class="math notranslate nohighlight">\(K_p\)</span> количеством <em>допустимых</em> фаз, удовлетворяющих закону сохранения масс.</p>
</div>
<p>Центральным для анализа стабильности фазового состояния системы является положение, определяющее, что стационарное состояние системы может быть установлено путем идентификации общих точек касательной <a class="reference external" href="https://en.wikipedia.org/wiki/Hyperplane">гиперплоскости</a> к <a class="reference external" href="https://en.wikipedia.org/wiki/Hypersurface">гиперповерхности</a> функции энергии Гиббса. Приставки “гипер” необходимы при рассмотрении <span class="math notranslate nohighlight">\(N_c\)</span>-мерного пространства. Например, для двух компонентов функция энергии Гиббса представляет собой кривую на плоскости, касательной к которой является прямая. Для трех компонентов функция энергии Гиббса представляет собой поверхность, а касательная к ней – плоскость. Для <span class="math notranslate nohighlight">\(N_c\)</span> компонентов функция энергии Гиббса – гиперповерхность, касательная к ней – гиперплоскость. Далее под поверхностью и плоскостью будут пониматься именно гиперповерхность и гиперплоскость соответственно.</p>
<div class="danger admonition">
<p class="admonition-title">Теорема</p>
<p>Пусть <span class="math notranslate nohighlight">\(\hat{M} = \left\{ \mathbf{n}_j, \, j = 1 \, \ldots \, N_p \right\}\)</span> является некоторым состоянием системы, определяемым <span class="math notranslate nohighlight">\(N_p\)</span> допустимыми фазами, удовлетворяющими закону сохранения масс. Тогда <span class="math notranslate nohighlight">\(G \left( \hat{M} \right)\)</span> является стационарной точкой тогда и только тогда, когда <span class="math notranslate nohighlight">\(G\)</span> дифференциируема для всех <span class="math notranslate nohighlight">\(\mathbf{n}_j, \, j = 1 \, \ldots \, N_p,\)</span> и поверхность <span class="math notranslate nohighlight">\(G \left( \hat{M} \right)\)</span> имеет одинаковую касательную плоскость для каждого <span class="math notranslate nohighlight">\(\mathbf{n}_j, \, j = 1 \, \ldots \, N_p\)</span>.</p>
</div>
<p>Приведем доказательство данной теоремы.</p>
<div class="proof admonition">
<p class="admonition-title">Доказательство</p>
<p>Пусть <span class="math notranslate nohighlight">\(L_j \left( \mathbf{r} \right), \, j = 1 \, \ldots \, N_p,\)</span> является касательной плоскостью к поверхности <span class="math notranslate nohighlight">\(G_j \left( \mathbf{r} \right)\)</span> в точке <span class="math notranslate nohighlight">\(\mathbf{n}_j, \, j = 1 \, \ldots \, N_p,\)</span> являющейся стационарной. Тогда <a class="reference external" href="https://en.wikipedia.org/wiki/Tangent">уравнение касательной</a> плоскости <span class="math notranslate nohighlight">\(L_j \left( \mathbf{r} \right)\)</span> к поверхности <span class="math notranslate nohighlight">\(G_j \left( \mathbf{r} \right)\)</span> в точке <span class="math notranslate nohighlight">\(\mathbf{n}_j\)</span> описывается следующим выражением:</p>
<div class="math notranslate nohighlight">
\[ L_j \left( \mathbf{r} \right) = G_j \left( \mathbf{n}_j \right) + \sum_{i=1}^{N_c} \frac{\partial G_j}{\partial r_i} \bigg|_{n_{ji}} \left( r_i - n_{ji} \right), \; j = 1 \, \ldots \, N_p. \]</div>
<p>При фиксированных давлении и температуре для энергии Гиббса выполняется следующее <a class="reference internal" href="../1-TD/TD-10-MixtureGibbsEnergy.html"><span class="std std-doc">свойство</span></a>:</p>
<div class="math notranslate nohighlight">
\[ G_j \left( \mathbf{n}_j \right) = \sum_{i=1}^{N_c} \frac{\partial G_j}{\partial r_i} \bigg|_{n_{ji}} n_{ji} = \sum_{i=1}^{N_c} \mu_{ji} n_{ji}, \; j = 1 \, \ldots \, N_p. \]</div>
<p>Подставляя данное выражение в уравнение касательной поверхности, получим:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align}
L_j \left( \mathbf{r} \right)
&amp;= \sum_{i=1}^{N_c} \frac{\partial G_j}{\partial r_i} \bigg|_{n_{ji}} n_{ji} + \sum_{i=1}^{N_c} \frac{\partial G_j}{\partial r_i} \bigg|_{n_{ji}} r_i - \sum_{i=1}^{N_c} \frac{\partial G_j}{\partial r_i} \bigg|_{n_{ji}} n_{ji} \\
&amp;= \sum_{i=1}^{N_c} \frac{\partial G_j}{\partial r_i} \bigg|_{n_{ji}} r_i \\
&amp;= \sum_{i=1}^{N_c} \mu_{ji} r_i, \; j = 1 \, \ldots \, N_p.
\end{align} \end{split}\]</div>
<p>Поскольку для стационарного состояния выполняется условие постоянства химического потенциала компонентов, то есть химический потенциал каждого компонента не зависит от фазы, то есть <span class="math notranslate nohighlight">\(\mu_{ji} = \mu_{N_pi}, \, j = 1 \, \ldots \, N_p - 1, \, i = 1 \, \ldots \, N_c,\)</span> в соответствии с приведенной выше леммой, то <span class="math notranslate nohighlight">\(L_j \left( \mathbf{r} \right)\)</span> также не будет зависеть от фазы <span class="math notranslate nohighlight">\(j\)</span>, следовательно, для всех <span class="math notranslate nohighlight">\(j\)</span> в стационарном состоянии уравнение касательной плоскости к поверхности энергии Гиббса одинаково. Верно и обратное: если все <span class="math notranslate nohighlight">\(L_j\)</span> одинаковы, то химические потенциалы компонентов равны, и состояние является стационарным.</p>
</div>
<p>Представленная выше теорема говорит о том, что в стационарном состоянии <span class="math notranslate nohighlight">\(\hat{M}\)</span> касательная плоскость <span class="math notranslate nohighlight">\(L_j \left( \mathbf{r} \right)\)</span> к поверхности энергии Гиббса <span class="math notranslate nohighlight">\(G_j \left( \mathbf{r} \right)\)</span> одинакова для всех составов фаз <span class="math notranslate nohighlight">\(\mathbf{n}_j, \; j = 1 \, \ldots \, N_p,\)</span> определяющих рассматриваемое стационарное состояние <span class="math notranslate nohighlight">\(\hat{M} = \left\{ \mathbf{n}_j, \, j = 1 \, \ldots N_p \right\}\)</span>. Данное свойство будет проиллюстрировано примером в <a class="reference internal" href="SEC-5-Equilibrium.html"><span class="std std-doc">разделе</span></a>, посвященном определению равновесного состояния системы. Однако целью данного раздела является установление стабильности некоторого стационарного состояния системы. Для этого введем следующие обозначения.</p>
<p>Пусть <span class="math notranslate nohighlight">\(D \left( \mathbf{r} \right)\)</span> является функцией разности между энергией Гиббса <span class="math notranslate nohighlight">\(G \left( \mathbf{r} \right)\)</span> и функцией касательной плоскости к ней <span class="math notranslate nohighlight">\(L \left( \mathbf{r} \right)\)</span>:</p>
<div class="math notranslate nohighlight">
\[ D \left( \mathbf{r} \right) = G \left( \mathbf{r} \right) - L \left( \mathbf{r} \right). \]</div>
<p>Для равновесного состояния (которое также является стационарным) в соответствии с представленной выше леммой преобразуем уравнение касательной плоскости:</p>
<div class="math notranslate nohighlight">
\[ D \left( \mathbf{r} \right) = G \left( \mathbf{r} \right) - \sum_{i=1}^{N_c} \mu_i r_i.\]</div>
<p>Далее будет показано, что при любых значениях <span class="math notranslate nohighlight">\(\mathbf{r}\)</span> в равновесном состоянии функция <span class="math notranslate nohighlight">\(D \left( \mathbf{r} \right)\)</span> не принимает отрицательных значений. Однако прежде чем переходить к доказательству этого утверждения необходимо рассмотреть следующую лемму:</p>
<div class="danger admonition">
<p class="admonition-title">Лемма</p>
<p>Разница между энергией Гиббса системы в <em>любом состоянии</em> <span class="math notranslate nohighlight">\(\hat{K} = \left\{ \mathbf{r}_k, \, k = 1 \, \ldots \, K_p \right\}\)</span>, состоящем из <span class="math notranslate nohighlight">\(K_p\)</span> приемлемых фаз, компонентный состав которых удовлетворяет закону сохранения масс, и энергией Гиббса в <em>стационарном состоянии</em> <span class="math notranslate nohighlight">\(\hat{M} = \left\{ \mathbf{n}_j, \, j = 1 \, \ldots \, N_p \right\}\)</span> с <span class="math notranslate nohighlight">\(N_p\)</span> приемлемыми фазами, причем <span class="math notranslate nohighlight">\(K_p\)</span> может быть неравно <span class="math notranslate nohighlight">\(N_p\)</span>, есть сумма <span class="math notranslate nohighlight">\(D_k \left( \mathbf{r}_k \right), \, k = 1 \, \ldots \, K_p,\)</span> по количеству фаз <span class="math notranslate nohighlight">\(K_p\)</span>, то есть:</p>
<div class="math notranslate nohighlight">
\[ \sum_{k=1}^{K_p} G_k \left( \mathbf{r}_k \right) - \sum_{j=1}^{N_p} G_j \left( \mathbf{n}_j \right) = \sum_{k=1}^{K_p} D_k \left( \mathbf{r}_k \right). \]</div>
</div>
<p>Доказательство:</p>
<div class="proof admonition">
<p class="admonition-title">Доказательство</p>
<p>Поскольку система одна и та же, то выполняется закон сохранения масс:</p>
<div class="math notranslate nohighlight">
\[ n_i = \sum_{j=1}^{N_p} n_{ji} = \sum_{k=1}^{K_p} r_{ki}, \; i = 1 \, \ldots \, N_c. \]</div>
<p>Для стационарного состояния характерно постоянство химического потенциала компонента <span class="math notranslate nohighlight">\(\mu_{ji}\)</span> среди всех фаз <span class="math notranslate nohighlight">\(j = 1 \, \ldots \, N_p\)</span>. То есть справедливо следующее равенство:</p>
<div class="math notranslate nohighlight">
\[ \mu_{ji} = \mu_{N_pi}, \; j = 1 \, \ldots \, N_p, \; i = 1 \, \ldots \, N_c. \]</div>
<p>Следовательно:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align}
\sum_{j=1}^{N_p} G_j \left( \mathbf{n}_j \right)
&amp;= \sum_{j=1}^{N_p} \sum_{i=1}^{N_c} \mu_{ji} n_{ji} \\
&amp;= \sum_{j=1}^{N_p} \sum_{i=1}^{N_c} \mu_{N_pi} n_{ji} \\
&amp;= \sum_{i=1}^{N_c} \mu_{N_pi} \sum_{j=1}^{N_p} n_{ji} \\
&amp;= \sum_{i=1}^{N_c} \mu_{N_pi} \sum_{k=1}^{K_p} r_{ki} \\
&amp;= \sum_{k=1}^{K_p} \sum_{i=1}^{N_c} \mu_{N_pi} r_{ki} \\
&amp;= \sum_{k=1}^{K_p} L_k \left( \mathbf{r}_k \right).
\end{align} \end{split}\]</div>
<p>Тогда</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align}
\sum_{k=1}^{K_p} G_k \left( \mathbf{r}_k \right) - \sum_{j=1}^{N_p} G_j \left( \mathbf{n}_j \right)
&amp; = \sum_{k=1}^{K_p} G_k \left( \mathbf{r}_k \right) - \sum_{k=1}^{K_p} L_k \left( \mathbf{r}_k \right) \\
&amp; = \sum_{k=1}^{K_p} \left( G_k \left( \mathbf{r}_k \right) - L_k \left( \mathbf{r}_k \right) \right) \\
&amp; = \sum_{k=1}^{K_p} D_k \left( \mathbf{r}_k \right).
\end{align} \end{split}\]</div>
</div>
<p>Теперь можем перейти к доказательству основной теоремы:</p>
<div class="danger admonition">
<p class="admonition-title">Теорема</p>
<p>Пусть система находится в некотором <em>стационарном</em> состоянии <span class="math notranslate nohighlight">\(\hat{M} = \left\{ \mathbf{n}_j, \, j = 1 \, \ldots \, N_p \right\}\)</span>. Причем значение энергии Гиббса в <em>любом другом состоянии</em> <span class="math notranslate nohighlight">\(\hat{K} = \left\{ \mathbf{r}_k, \, k = 1 \, \ldots \, K_p \right\}\)</span> больше или равно касательной плоскости <span class="math notranslate nohighlight">\(L_k \left( \mathbf{r}_k \right), \, k = 1 \, \ldots \, K_p,\)</span> иными словами <span class="math notranslate nohighlight">\(D_k \left( \mathbf{r}_k \right) \geq 0, \, k = 1 \, \ldots \, K_p,\)</span> тогда данное стационарное состояние <span class="math notranslate nohighlight">\(\hat{M}\)</span> является <em><strong>равновесным</strong></em>.</p>
</div>
<p>Докажем данную теорему.</p>
<div class="proof admonition">
<p class="admonition-title">Доказательство</p>
<p>Рассмотрим любое состояние системы <span class="math notranslate nohighlight">\(\hat{K} = \left\{ \mathbf{r}_k, \, k = 1 \, \ldots \, K_p \right\}\)</span>. Тогда из условия <span class="math notranslate nohighlight">\(D_k \left( \mathbf{r}_k \right) \geq 0, \, k = 1 \, \ldots \, K_p,\)</span> следует, что</p>
<div class="math notranslate nohighlight">
\[ \sum_{k=1}^{K_p} D_k \left( \mathbf{r}_k \right) \geq 0. \]</div>
<p>Согласно доказанной ранее лемме, данное неравество можно записать следующим образом:</p>
<div class="math notranslate nohighlight">
\[ \sum_{k=1}^{K_p} G_k \left( \mathbf{r}_k \right) - \sum_{j=1}^{N_p} G_j \left( \mathbf{n}_j \right) \geq 0. \]</div>
<p>Или:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align}
\sum_{j=1}^{N_p} G_j \left( \mathbf{n}_j \right) &amp; \leq \sum_{k=1}^{K_p} G_k \left( \mathbf{r}_k \right), \\
G \left( \hat{M} \right) &amp; \leq G \left( \hat{K} \right).
\end{align} \end{split}\]</div>
<p>То есть для любых <span class="math notranslate nohighlight">\(\mathbf{r}_k, \, k = 1 \, \ldots \, K_p,\)</span> энергия Гиббса системы получается больше, чем при <span class="math notranslate nohighlight">\(\mathbf{n}_j, \, j = 1 \, \ldots \, N_p,\)</span> то есть стационарное состояние <span class="math notranslate nohighlight">\(\hat{M} = \left\{ \mathbf{n}_j, \, j = 1 \, \ldots \, N_p \right\}\)</span> характеризуется наименьшей энергией Гиббса, следовательно, оно является равновесным по определению.</p>
</div>
<p>В результате доказательства этой теоремы данное ранее определение равновесного состояния, как стационарного состояния, характеризующегося наименьшей энергией Гиббса, можно переформулировать следующим образом:</p>
<div class="tip admonition">
<p class="admonition-title">Определение</p>
<p><em><strong>Равновесным состоянием</strong></em> называется такое <em>стационарное</em> состояние системы, при котором касательная гиперплоскость к гиперповерхности энергии Гиббса, проведенная в точке с компонентным составом этого состояния, не пересекает гиперповерхность энергии Гиббса в любых других точках.</p>
</div>
<p>Таким образом, анализ стабильности некоторого стационарного состояния многофазной многокомпонентной системы можно проводить посредством исследования функции <span class="math notranslate nohighlight">\(D \left( \mathbf{r} \right)\)</span>, определяемой расстоянием от гиперповерхности энергии Гиббса до касательной гиперплоскости, проведенной в точке с рассматриваемым стационарным состоянием. Эту функцию обычно называют <em>TPD – tangent plane distance</em>. Прежде чем переходить к рассмотрению примеров анализа стабильности графическим способом необходимо выразить энергию Гиббса многофазной системы через <a class="reference internal" href="../1-TD/TD-15-Fugacity.html"><span class="std std-doc">летучести</span></a> компонентов в фазах:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align}
\sum_{j=1}^{N_p} G_j \left( P, \, T, \, \mathbf{n}_j \right)
&amp;= \sum_{j=1}^{N_p} \sum_{i=1}^{N_c} n_{ji} \mu_{ji} \left( P, \, T, \, \mathbf{n}_j \right) \\
&amp;= \sum_{j=1}^{N_p} \sum_{i=1}^{N_c} n_{ji} \left( \mu_i \left( P^*, \, T \right) +  R T \ln \frac{f_{ji}}{P^*} \right) \\
&amp;= \sum_{j=1}^{N_p} \sum_{i=1}^{N_c} n_{ji} \left( \mu_i \left( P^*, \, T \right) - R T \ln P^* \right) + R T \sum_{j=1}^{N_p} \sum_{i=1}^{N_c} n_{ji} \ln f_{ji} \\
&amp;= \sum_{i=1}^{N_c} \left( \mu_i \left( P^*, \, T \right) - R T \ln P^* \right) \sum_{j=1}^{N_p} n_{ji} + R T \sum_{j=1}^{N_p} \sum_{i=1}^{N_c} n_{ji} \ln f_{ji} \\
&amp;= \sum_{i=1}^{N_c} n_i \left( \mu_i \left( P^*, \, T \right) - R T \ln P^* \right) + R T \sum_{j=1}^{N_p} \sum_{i=1}^{N_c} n_{ji} \ln f_{ji} \\
&amp;= \Lambda \left( T, \mathbf{n} \right) + R T \sum_{j=1}^{N_p} \sum_{i=1}^{N_c} n_{ji} \ln f_{ji}.
\end{align} \end{split}\]</div>
<p>Первое слагаемое в данном выражении <span class="math notranslate nohighlight">\(\Lambda \left( T, \mathbf{n} \right)\)</span> является функцией от температуры и количеств вещества компонентов в системе в целом, которые являются фиксированными для рассматриваемой задачи анализа стабильности. То есть данное слагаемое можно рассматривать в качестве константы в выражении для энергии Гиббса. Следовательно, приведенные выше теоретические выкладки анализа стабильности будут применимы для <em>приведенной добавочной энергии Гиббса</em>, определяемой выражением:</p>
<div class="math notranslate nohighlight">
\[ \tilde{G}^E = \sum_{j=1}^{N_p} \sum_{i=1}^{N_c} n_{ji} \ln f_{ji}. \]</div>
<p>Рассмотрим применение анализа стабильности с использованием функции <em>TPD</em> на следующих примерах.</p>
<div class="exercise admonition">
<p class="admonition-title">Пример</p>
<p>Пусть имеется <span class="math notranslate nohighlight">\(1 \; моль\)</span> смеси из метана и диоксида углерода при температуре <span class="math notranslate nohighlight">\(40 \; ^{\circ} C\)</span> и давлении <span class="math notranslate nohighlight">\(2 \; МПа\)</span> с мольной долей метана <span class="math notranslate nohighlight">\(0.85\)</span>. Необходимо определить, является ли однофазное состояние данной системы стабильным.</p>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Решение</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Для решения данной задачи будем использовать <a class="reference internal" href="../2-EOS/EOS-2-SRK-PR.html"><span class="std std-doc">уравнение состояния Пенга-Робинсона</span></a>, реализованное <a class="reference external" href="https://github.com/DanielSkorov/ReservoirSimulation/blob/main/_src/eos.py">здесь</a>.</p>
<p class="sd-card-text">Импортирурем необходимые библиотеки:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;../../_src/&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">eos</span> <span class="kn">import</span> <span class="n">pr78</span>
</pre></div>
</div>
<p class="sd-card-text">Зададим исходные термобарические условия и компонентный состав.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">2e6</span><span class="p">)</span> <span class="c1"># Pressure [Pa]</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">40.</span> <span class="o">+</span> <span class="mf">273.15</span><span class="p">)</span> <span class="c1"># Temperature [K]</span>
<span class="n">yi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">.15</span><span class="p">,</span> <span class="mf">.85</span><span class="p">])</span> <span class="c1"># Mole fractions [fr.]</span>
</pre></div>
</div>
<p class="sd-card-text">Зададим свойства компонентов, необходимые для уравнения состояния Пенга-Робинсона.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Pci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">7.37646</span><span class="p">,</span> <span class="mf">4.600155</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1e6</span> <span class="c1"># Critical pressures [Pa]</span>
<span class="n">Tci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">304.2</span><span class="p">,</span> <span class="mf">190.6</span><span class="p">])</span> <span class="c1"># Critical temperatures [K]</span>
<span class="n">wi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">.225</span><span class="p">,</span> <span class="mf">.008</span><span class="p">])</span> <span class="c1"># Acentric factors</span>
<span class="n">mwi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.04401</span><span class="p">,</span> <span class="mf">0.016043</span><span class="p">])</span> <span class="c1"># Molar mass [kg/gmole]</span>
<span class="n">vsi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span> <span class="c1"># Volume shift parameters</span>
<span class="n">dij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">.025</span><span class="p">])</span> <span class="c1"># Binary interaction parameters</span>
</pre></div>
</div>
<p class="sd-card-text">Проинициализируем класс с используемым уравнением состояния.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pr</span> <span class="o">=</span> <span class="n">pr78</span><span class="p">(</span><span class="n">Pci</span><span class="p">,</span> <span class="n">Tci</span><span class="p">,</span> <span class="n">wi</span><span class="p">,</span> <span class="n">mwi</span><span class="p">,</span> <span class="n">vsi</span><span class="p">,</span> <span class="n">dij</span><span class="p">)</span>
</pre></div>
</div>
<p class="sd-card-text">Выполним расчет приведенной энергии Гиббса для всех возможных компонентных составов рассматриваемой смеси. Для расчета коэффициентов летучестей компонентов для различных составов будем использовать метод <code class="docutils literal notranslate"><span class="pre">get_lnphiji_Zj</span></code>, принимающий в качестве аргументов давление (в Па), температуру (в K) и набор компонентных составов в виде двумерного массива (размерностью <code class="docutils literal notranslate"><span class="pre">(Np,</span> <span class="pre">Nc)</span></code>, где <code class="docutils literal notranslate"><span class="pre">Np</span></code> – количество наборов компонентных составов, <code class="docutils literal notranslate"><span class="pre">Nc</span></code> – количество компонентов в каждом компонентном составе) и возвращающий соответствующие коэффициенты летучести компонентов в виде двумерного массива такой же размерности и коэффициенты сверхсжимаемости в виде одномерного массива для каждого компонентного состава. Затем вычислим летучести компонентов и энергии Гиббса для соответствующих компонентных составов.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">yj1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1e-4</span><span class="p">,</span> <span class="mf">0.9999</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">yji</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">yj1</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">yj1</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="n">lnphiji</span><span class="p">,</span> <span class="n">Zj</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">getPT_lnphiji_Zj</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">yji</span><span class="p">)</span>
<span class="n">lnfji</span> <span class="o">=</span> <span class="n">lnphiji</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">P</span> <span class="o">*</span> <span class="n">yji</span><span class="p">)</span>
<span class="n">Gj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vecdot</span><span class="p">(</span><span class="n">yji</span><span class="p">,</span> <span class="n">lnfji</span><span class="p">)</span>
</pre></div>
</div>
<p class="sd-card-text">Теперь вычислим летучести компонентов для заданного компонентного состава. Для этого будем использовать метод <code class="docutils literal notranslate"><span class="pre">get_lnfi</span></code>, принимающий на вход давление (в Па), температуру (в K) и компонентный состав в виде одномерного масива (размерностью <code class="docutils literal notranslate"><span class="pre">(Nc,)</span></code>) и возвращающий логарифмы летучести компонентов в виде одномерного массива такой же размерности. Затем выслим значения касательной к функции энергии Гиббса в точке с рассматриваемым компонентным составом.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lnfi</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">getPT_lnfi</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span>
<span class="n">Lj</span> <span class="o">=</span> <span class="n">yji</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">lnfi</span><span class="p">)</span>
</pre></div>
</div>
<p class="sd-card-text">Построим зависимости энергии Гиббса и касательной к ней от количества вещества диоксида углерода в системе.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig1</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">6.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yj1</span><span class="p">,</span> <span class="n">Gj</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;teal&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Приведенная добавочная энергия Гиббса&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yj1</span><span class="p">,</span> <span class="n">Lj</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;orchid&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Касательная&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Количество вещества диоксида углерода в системе, моль&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Приведенная добавочная энергия Гиббса&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/c2c636af4eaa2969b329dbb5ec5edd9d3db3db8a4b74985c84c8d1edb2a674cf.png" src="../../_images/c2c636af4eaa2969b329dbb5ec5edd9d3db3db8a4b74985c84c8d1edb2a674cf.png" />
<br>
<br>
<p class="sd-card-text">Из представленного результата видно, что при рассматриваемых термобарических условиях касательная, проведенная в точке с заданным компонентным составом, не пересекает функцию энергии Гиббса, следовательно, можно сделать вывод о том, что однофазное состояние является стабильным. Более того, учитывая выпуклую вниз форму функции энергии Гиббса, можно заключить, что при любых компонентных составах данная система будет стабильна в однофазовом состоянии при рассматриваемых термобарических условиях.</p>
<p class="sd-card-text">Вычислим и построим зависимость функции TPD от количества вещества диоксида углерода в системе.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Dj</span> <span class="o">=</span> <span class="n">Gj</span> <span class="o">-</span> <span class="n">Lj</span>
<span class="n">fig2</span><span class="p">,</span> <span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">6.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yj1</span><span class="p">,</span> <span class="n">Dj</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;lime&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Количество вещества диоксида углерода в системе, моль&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Tangent plane distance (TPD)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/b20edc8e91fb693013beab33b12b5cc74c87c6363ad87681936a0a802ae60551.png" src="../../_images/b20edc8e91fb693013beab33b12b5cc74c87c6363ad87681936a0a802ae60551.png" />
<br>
<br>
<p class="sd-card-text">Функция TPD на всем интервале количества вещества диоксида углерода в системе не принимает отрицательных значений, что также свидетельствует об отсутствии пересечении касательной и функции энергии Гиббса, то есть о стабильности однофазного состояния рассматриваемой системы.</p>
</div>
</details><div class="exercise admonition">
<p class="admonition-title">Пример</p>
<p>Пусть имеется <span class="math notranslate nohighlight">\(1 \; моль\)</span> смеси из метана и диоксида углерода при температуре <span class="math notranslate nohighlight">\(10 \; ^{\circ} C\)</span> и давлении <span class="math notranslate nohighlight">\(6 \; МПа\)</span> с мольной долей метана <span class="math notranslate nohighlight">\(0.1\)</span>. Необходимо определить, является ли однофазное состояние данной системы стабильным.</p>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Решение</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Зададим исходные термобарические условия и компонентный состав.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">6e6</span><span class="p">)</span> <span class="c1"># Pressure [Pa]</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">10.</span> <span class="o">+</span> <span class="mf">273.15</span><span class="p">)</span> <span class="c1"># Temperature [K]</span>
<span class="n">yi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">.9</span><span class="p">,</span> <span class="mf">.1</span><span class="p">])</span> <span class="c1"># Mole fractions [fr.]</span>
</pre></div>
</div>
<p class="sd-card-text">Выполним расчет приведенной энергии Гиббса для всех возможных компонентных составов рассматриваемой смеси. Затем определим летучести компонентов и энергии Гиббса для соответствующих компонентных составов. Для выполнения вычислений будем использовать проинициализированный в предыдущем примере класс с уравнением состояния.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lnphiji</span><span class="p">,</span> <span class="n">Zj</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">getPT_lnphiji_Zj</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">yji</span><span class="p">)</span>
<span class="n">lnfji</span> <span class="o">=</span> <span class="n">lnphiji</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">P</span> <span class="o">*</span> <span class="n">yji</span><span class="p">)</span>
<span class="n">Gj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vecdot</span><span class="p">(</span><span class="n">yji</span><span class="p">,</span> <span class="n">lnfji</span><span class="p">)</span>
</pre></div>
</div>
<p class="sd-card-text">Теперь вычислим летучести компонентов для заданного компонентного состава. Затем определим значения касательной к функции энергии Гиббса в точке с рассматриваемым компонентным составом.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lnfi</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">getPT_lnfi</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span>
<span class="n">Lj</span> <span class="o">=</span> <span class="n">yji</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">lnfi</span><span class="p">)</span>
</pre></div>
</div>
<p class="sd-card-text">Построим зависимости энергии Гиббса и касательной к ней от количества вещества диоксида углерода в системе.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig3</span><span class="p">,</span> <span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">6.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yj1</span><span class="p">,</span> <span class="n">Gj</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;teal&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Приведенная добавочная энергия Гиббса&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yj1</span><span class="p">,</span> <span class="n">Lj</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;orchid&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Касательная&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Количество вещества диоксида углерода в системе, моль&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Приведенная добавочная энергия Гиббса&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/b6b4b244b824005cacdaa8b870b24c0a909b4d9c0e9a253ab03c69ce6e187155.png" src="../../_images/b6b4b244b824005cacdaa8b870b24c0a909b4d9c0e9a253ab03c69ce6e187155.png" />
<br>
<br>
<p class="sd-card-text">Поскольку видно, что касательная, проведенная к функции энергии Гиббса в точке с рассматриваемым компонентным составом пересекает функцию энергии Гиббса, то однофазное состояние данной системы нестабильно. Построим зависимость функции TPD.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Dj</span> <span class="o">=</span> <span class="n">Gj</span> <span class="o">-</span> <span class="n">Lj</span>
<span class="n">fig4</span><span class="p">,</span> <span class="n">ax4</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">6.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yj1</span><span class="p">,</span> <span class="n">Dj</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;lime&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Количество вещества диоксида углерода в системе, моль&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Tangent plane distance (TPD)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/6cbf068296e1a1cfc81b07f06830f7474f26cf1f15b257309fcce0b1166977ec.png" src="../../_images/6cbf068296e1a1cfc81b07f06830f7474f26cf1f15b257309fcce0b1166977ec.png" />
<br>
<br>
<p class="sd-card-text">Функция TPD имеет отрицательные значения, что свидетельствует о пересечении касательной и функции энергии Гиббса, то есть о нестабильности однофазного состояния рассматриваемой системы.</p>
</div>
</details></section>
<section id="pvt-sec-stability-pt-num">
<span id="id3"></span><h3>Численный подход к проверке стабильности фазового состояния системы<a class="headerlink" href="#pvt-sec-stability-pt-num" title="Link to this heading">#</a></h3>
<p>Представленные выше примеры наглядно демонстрируют применение графического метода, основанного на пересечении гиперповерхности функции энергии Гиббса и касательной гиперплоскости, проведенной в точке с заданным компонентным составом. Однако применение графического метода не подходит для решения задач гидродинамического моделирования. В связи с этим в работе [<a class="reference external" href="https://doi.org/10.1016/0378-3812(82)85001-2">Michelsen, 1982</a>] был впервые представлен численный подход к проведению анализа стабильности, суть которого заключается в следующем. Для того чтобы определить, является ли фазовое состояние некоторой системы стабильным, необходимо понять, имеет ли функция <em>TPD (tangent plane distance)</em> отрицательные значения.</p>
<div class="note admonition">
<p class="admonition-title">NB</p>
<p>Необходимым критерием стабильности рассматриваемого фазового состояния системы с количествами вещества компонентов <span class="math notranslate nohighlight">\(\mathbf{n}\)</span> является:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align}
D \left( \mathbf{r} \right)
&amp;= G \left( \mathbf{r} \right) - L \left( \mathbf{r} \right) \\
&amp;= \sum_{i=1}^{N_c} \mu_i \left( \mathbf{y} \right) r_i - \sum_{i=1}^{N_c} \mu_i \left( \mathbf{z} \right) r_i \\
&amp;= \sum_{i=1}^{N_c} r_i \left( \mu_i \left( \mathbf{y} \right) - \mu_i \left( \mathbf{z} \right) \right) \geq 0, \; \forall \, \mathbf{r} \, : \, \sum_{i=1}^{N_c} r_i \leq \sum_{i=1}^{N_c} n_i, \; \mathbf{r} &gt; 0,
\end{align} \end{split}\]</div>
<p>где:
<span class="math notranslate nohighlight">\(\mathbf{r}\)</span> – произвольный состав рассматриваемой системы, моль;
<span class="math notranslate nohighlight">\(\mathbf{y} = \mathbf{r} \, / \sum_{i=1}^{N_c} r_i\)</span> – мольные доли компонентов для произвольного состава, д.ед.;
<span class="math notranslate nohighlight">\(\mathbf{\mu} \left( \mathbf{y} \right)\)</span> – химические потенциалы компонентов для произвольного состава системы, Дж/моль.;
<span class="math notranslate nohighlight">\(\mathbf{z} = \mathbf{n} \, / \sum_{i=1}^{N_c} n_i\)</span> – заданный компонентный состав системы, д.ед.;
<span class="math notranslate nohighlight">\(\mathbf{\mu} \left( \mathbf{z} \right)\)</span> – химические потенциалы компонентов для заданного компонентного состава системы, Дж/моль.</p>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="note admonition">
<p class="admonition-title">Дополнительно</p>
<p>Важно отметить, что рассматриваемый подход к проверке стабильности фазового состояния однофазной системы можно использовать и для проверки стабильности многофазной системы: для этого достаточно проверить на стабильность компонентный состав любой из фаз, применив данный метод.</p>
<!--- TODO: При условии, если свойства фаз рассчитываются с использованием одного и того же уравнения состояния. -->
</div>
</aside>
<p>Естественно, нет необходимости проверять значение функции TPD для всех составов системы, достаточно проверить значение функции TPD в ее глобальном минимуме: если в этой точке функция TPD неотрицательна, то систему можно считать стабильной. Однако поиск глобального минимума является достаточно сложной задачей для не выпуклых вниз функций. В связи с этим в работе [<a class="reference external" href="https://doi.org/10.1016/0378-3812(82)85001-2">Michelsen, 1982</a>] было предложено заменить поиск глобального минимума функции TPD на проверку ее значений в локальных минимумах (стационарных точках). Для этого, задаваясь некоторым начальным приближением, находится первый локальный минимум, и проверяется значение функции TPD в нем. Если это значение меньше нуля, то рассматриваемое фазовое состояние считается нестабильным, и проверка заканчивается. Если же это значение неотрицательно, то рассматривается следующее начальное приближение. Алгоритм повторяется, пока не будут рассмотрены все начальные приближения. Если после рассмотрения всех начальных приближений не было получено отрицательное значение функции TPD, то система считается стабильной. Прежде чем переходить к рассмотрению реализаций данного алгоритма, необходимо получить условие стационарности (выражение, определяющее положение стационарных точек) функции TPD.</p>
<p>Для этого в представленном выше критерии стабильности фазового состояния системы разделим левую и правую часть на <span class="math notranslate nohighlight">\(\sum_{i=1}^{N_c} r_i &gt; 0\)</span>:</p>
<div class="math notranslate nohighlight">
\[ D \left( \mathbf{y} \right) = \sum_{i=1}^{N_c} y_i \left( \mu_i \left( \mathbf{y} \right) - \mu_i \left( \mathbf{z} \right) \right) .\]</div>
<p>Положение стационарных точек функции определяется равенством нулю частных производных по независимым переменным. В качестве независимых переменных будут выступать мольные доли компонентов <span class="math notranslate nohighlight">\(y_j, \; j = 1 \, \ldots \, N_c - 1,\)</span> поскольку:</p>
<div class="math notranslate nohighlight">
\[ y_{N_c} = 1 - \sum_{i=1}^{N_c-1} y_i. \]</div>
<p>Запишем и преобразуем выражение для частных производных функции TPD:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align}
\frac{\partial D}{\partial y_j}
&amp;= \sum_{i=1}^{N_c} \frac{\partial y_i}{\partial y_j} \left( \mu_i \left( \mathbf{y} \right) - \mu_i \left( \mathbf{z} \right) \right) + \sum_{i=1}^{N_c} y_i \frac{\partial \mu_i \left( \mathbf{y} \right)}{\partial y_j} \\
&amp;= \sum_{i=1}^{N_c} \frac{\partial y_i}{\partial y_j} \left( \mu_i \left( \mathbf{y} \right) - \mu_i \left( \mathbf{z} \right) \right) \\
&amp;= \left( \mu_j \left( \mathbf{y} \right) - \mu_j \left( \mathbf{z} \right) \right) - \left( \mu_{N_c} \left( \mathbf{y} \right) - \mu_{N_c} \left( \mathbf{z} \right) \right) \\
&amp;= 0, \; j = 1 \, \ldots \, N_c - 1.
\end{align} \end{split}\]</div>
<p>В процессе этого преобразования было использовано <a class="reference internal" href="../1-TD/TD-12-GibbsDuhemEquation.html"><span class="std std-doc">соотношение Гиббса-Дюгема</span></a> при постоянных давлении и температуре:</p>
<div class="math notranslate nohighlight">
\[ \sum_{i=1}^{N_c} y_i \frac{\partial \mu_i \left( \mathbf{y} \right)}{\partial y_j} = 0. \]</div>
<p>Кроме того, частная производная <span class="math notranslate nohighlight">\(\frac{\partial y_i}{\partial y_j}\)</span> принимает следующие значения:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \frac{\partial y_i}{\partial y_j} = \begin{cases} 1, &amp; i=j, \, i = 1 \, \ldots \, N_c -1; \\ -1, &amp; i=j, \, i = N_c; \\ 0, &amp; i \neq j. \end{cases} \end{split}\]</div>
<p>Следовательно,</p>
<div class="math notranslate nohighlight">
\[ \mu_i \left( \mathbf{y} \right) - \mu_i \left( \mathbf{z} \right) = \mu_{N_c} \left( \mathbf{y} \right) - \mu_{N_c} \left( \mathbf{z} \right) = K, \; i = 1 \, \ldots \, N_c - 1. \]</div>
<p>В данном выражении разность химических потенциалов последнего компонента обозначена константой <span class="math notranslate nohighlight">\(K\)</span>, поскольку она не зависит от индекса <span class="math notranslate nohighlight">\(i\)</span>, то есть является одинаковой (постоянной) для всех компонентов. Иными словами, разность химических потенциалов одинакова для соответствующих компонентов в стационарных точках функции TPD. Из этого следует, что касательные, проведенные к функции энергии Гиббса в точках, соответствующих стационарным точкам функции TPD, будут параллельны друг другу и касательной, проведенной в точке с рассматриваемым компонентным составом. Докажем данное утверждение.</p>
<div class="proof admonition">
<p class="admonition-title">Доказательство</p>
<p>Из приведенного выше соотношения выразим значения химического потенциала в точке, соответствующей стационарной точке функции TPD:</p>
<div class="math notranslate nohighlight">
\[ \mu_i \left( \mathbf{y} \right) = \mu_i \left( \mathbf{z} \right) + K, \; i = 1 \, \ldots \, N_c - 1. \]</div>
<p>Тогда, согласно представленной выше теореме, уравнение касательной к функции энергии Гиббса в этой точке с компонентным составом <span class="math notranslate nohighlight">\(\mathbf{y}\)</span>:</p>
<div class="math notranslate nohighlight">
\[ L_y \left( \mathbf{x} \right) = \sum_{i=1}^{N_c} \mu_i \left( \mathbf{y} \right) x_i = \sum_{i=1}^{N_c} \mu_i \left( \mathbf{z} \right) x_i + K \sum_{i=1}^{N_c} x_i = L_z \left( \mathbf{x} \right) + K .\]</div>
<p>То есть значение касательной к функции энергии Гиббса, проведенной в точке, соответствующей стационарной точке функции TPD, отличается от касательной, проведенной в точке с рассматриваемым компонентным составом, на константу <span class="math notranslate nohighlight">\(K\)</span>, следовательно, они являются параллельными.</p>
</div>
<p>Рассмотрим значение функции TPD в стационарной точке:</p>
<div class="math notranslate nohighlight">
\[ D \left( \mathbf{y} \right) = \sum_{i=1}^{N_c} y_i \left( \mu_i \left( \mathbf{y} \right) - \mu_i \left( \mathbf{z} \right) \right) = K. \]</div>
<p>Тогда условие стабильности рассматриваемой системы <span class="math notranslate nohighlight">\(D \left( \mathbf{y} \right) \geq 0\)</span> можно представить в виде <span class="math notranslate nohighlight">\(K \geq 0\)</span>.</p>
<p>При этом условие стационарности функции TPD представляет собой систему нелинейных уравнений:</p>
<div class="math notranslate nohighlight">
\[ \mu_i \left( \mathbf{y} \right) - \mu_i \left( \mathbf{z} \right) = K, \; i = 1 \, \ldots \, N_c. \]</div>
<p>Эта система имеет тривиальное решение <span class="math notranslate nohighlight">\(\mathbf{y} = \mathbf{z}\)</span>, в этом случае <span class="math notranslate nohighlight">\(K = 0\)</span>.</p>
<p>Для квази-стационарного изотермического процесса разность химических потенциалов <a class="reference internal" href="../1-TD/TD-15-Fugacity.html#pvt-td-fugacity-realgasmixture"><span class="std std-ref">можно</span></a> заменить разностью логарифмов летучестей компонентов. Следовательно, условие стационарности функции TPD записывается следующим образом:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align}
RT \left( \ln f_i \left( \mathbf{y} \right) - \ln f_i \left( \mathbf{z} \right) \right) = K, \; i = 1 \, \ldots \, N_c, \\
\ln f_i \left( \mathbf{y} \right) - \ln f_i \left( \mathbf{z} \right) = \bar{K}, \; i = 1 \, \ldots \, N_c,
\end{align} \end{split}\]</div>
<p>где <span class="math notranslate nohighlight">\(\bar{K} = K \, / \, RT\)</span>.</p>
<p>Преобразуем данное выражение с учетом <a class="reference internal" href="../1-TD/TD-15-Fugacity.html"><span class="std std-doc">определения коэффициента летучести</span></a>:</p>
<div class="math notranslate nohighlight">
\[ \ln y_i + \ln \phi_i \left( \mathbf{y} \right) - h_i = \bar{K}, \; i = 1 \, \ldots \, N_c. \]</div>
<p>Здесь под переменной <span class="math notranslate nohighlight">\(h_i\)</span> обозначено следующее:</p>
<div class="math notranslate nohighlight">
\[ h_i = \ln \phi_i \left( \mathbf{z} \right) + \ln z_i, \; i = 1 \, \ldots \, N_c. \]</div>
<p>С учетом изложенного выше функцию TPD преобразуем к следующему виду:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align}
D \left( \mathbf{y} \right) &amp;= \sum_{i=1}^{N_c} y_i \left( \mu_i \left( \mathbf{y} \right) - \mu_i \left( \mathbf{z} \right) \right), \\
\bar{D} \left( \mathbf{y} \right) &amp;= \sum_{i=1}^{N_c} y_i \left( \ln y_i + \ln \phi_i \left( \mathbf{y} \right) - h_i \right).
\end{align} \end{split}\]</div>
<p>Пусть <span class="math notranslate nohighlight">\(Y_i = y_i \exp \left( -\bar{K} \right), \, i = 1 \, \ldots \, N_c,\)</span> тогда условие стационарности функции TPD:</p>
<div class="math notranslate nohighlight">
\[ \ln Y_i + \ln \phi_i \left( \mathbf{y} \right) - h_i = 0, \; i = 1 \, \ldots \, N_c. \]</div>
<p>При этом условие стабильности <span class="math notranslate nohighlight">\(\bar{K} \geq 0\)</span> можно представить в виде <span class="math notranslate nohighlight">\(\sum_{i=1}^{N_c} Y_i \leq 1\)</span>, поскольку</p>
<div class="math notranslate nohighlight">
\[ \sum_{i=1}^{N_c} Y_i = \sum_{i=1}^{N_c} y_i \mathrm{e}^{-\bar{K}} = \mathrm{e}^{-\bar{K}} \sum_{i=1}^{N_c} y_i = \mathrm{e}^{-\bar{K}}. \]</div>
<p>Логарифмируя левую и правую части, получим:</p>
<div class="math notranslate nohighlight">
\[ \ln \sum_{i=1}^{N_c} Y_i = - \bar{K}. \]</div>
<p>С учетом <span class="math notranslate nohighlight">\(\bar{K} \geq 0\)</span> можно записать следующее неравенство:</p>
<div class="math notranslate nohighlight">
\[ \ln \sum_{i=1}^{N_c} Y_i \leq 0 \Leftrightarrow \sum_{i=1}^{N_c} Y_i \leq 1. \]</div>
<p>Стоит отметить, что значение <span class="math notranslate nohighlight">\(Y_i, \, i = 1 \, \ldots \, N_c,\)</span> можно условно интерпретировать как количество вещества <span class="math notranslate nohighlight">\(i\)</span>-го компонента, действительно:</p>
<div class="math notranslate nohighlight">
\[ \frac{Y_i}{\sum_{i=1}^{N_c} Y_i} = \frac{y_i \mathrm{e}^{-\bar{K}}}{\sum_{i=1}^{N_c} y_i \mathrm{e}^{-\bar{K}}} = \frac{y_i \mathrm{e}^{-\bar{K}}}{\mathrm{e}^{-\bar{K}} \sum_{i=1}^{N_c} y_i} = y_i, \; i = 1 \, \ldots \, N_c,. \]</div>
<p>Таким образом, система нелинейных уравнений, определяющая условие стационарности функции TPD, записывается следующим образом:</p>
<div class="math notranslate nohighlight">
\[ g_i = \ln Y_i + \ln \phi_i \left( \mathbf{y} \right) - h_i = 0, \; i = 1 \, \ldots \, N_c. \]</div>
<p>После решения данной системы нелинейных уравнений относительно основных перменных <span class="math notranslate nohighlight">\(Y_i, \, i = 1 \, \ldots \, N_c,\)</span> выполняется проверка стабильности рассматриваемой многокомпонентной системы. Фазовое состояние будет считаться стабильным, если:</p>
<div class="math notranslate nohighlight">
\[ \sum_{i=1}^{N_c} Y_i \leq 1. \]</div>
<p>Рассмотрим некоторые численные алгоритмы решения данной системы нелинейных уравнений.</p>
</section>
<section id="pvt-sec-stability-pt-ss">
<span id="id4"></span><h3>Метод последовательных подстановок<a class="headerlink" href="#pvt-sec-stability-pt-ss" title="Link to this heading">#</a></h3>
<p>Одним из наиболее распространенных численных алгоритмов, используемых для определения стабильности фазового состояния многокомпонентной системы, является <em>метод последовательных подстановок (successive substitution method)</em>, также называемый <a class="reference external" href="https://en.wikipedia.org/wiki/Fixed-point_iteration">методом простой итерации</a>, суть которого заключается в итерационном обновлении основных переменных с использованием следующего выражения:</p>
<div class="math notranslate nohighlight">
\[ \mathbf{t}^{k+1} = f \left( \mathbf{t}^{k} \right), \]</div>
<p>где <span class="math notranslate nohighlight">\(\mathbf{t}^{k+1} \in {\rm I\!R}^n\)</span> – вектор основных переменных на <span class="math notranslate nohighlight">\(\left( k+1 \right)\)</span>-й итерации, <span class="math notranslate nohighlight">\(\mathbf{t}^{k} \in {\rm I\!R}^n\)</span> – вектор основных переменных на <span class="math notranslate nohighlight">\(\left( k \right)\)</span>-й итерации, <span class="math notranslate nohighlight">\(f \, : \, {\rm I\!R}^n \rightarrow {\rm I\!R}^n\)</span> – функция, принимающая на вход вектор размерности <span class="math notranslate nohighlight">\(n\)</span> и возвращающая вектор такой же размерности. Соответственно, такая система уравнений должна иметь решение, удовлетворяющее следующему соотношению:</p>
<div class="math notranslate nohighlight">
\[ \mathbf{t}^{*} = f \left( \mathbf{t}^{*} \right), \]</div>
<p>где <span class="math notranslate nohighlight">\(\mathbf{t}^{*} \in {\rm I\!R}^n\)</span> – вектор основных переменных, соответствующий решению системы нелинейных уравнений. Прежде чем переходить к применению метода последовательных подстановок, выполним некоторые преобразования рассматриваемой системы нелинейных уравнений:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align}
g_i
&amp;= \ln Y_i + \ln \phi_i \left( \mathbf{y} \right) - h_i \\
&amp;= \ln Y_i + \ln \phi_i \left( \mathbf{y} \right) - \ln \phi_i \left( \mathbf{z} \right) - \ln z_i \\
&amp;= \ln k_i + \ln \phi_i \left( \mathbf{y} \right) - \ln \phi_i \left( \mathbf{z} \right), \; i = 1 \, \ldots \, N_c.
\end{align} \end{split}\]</div>
<p>В процессе данного преобразования было введено обозначение для вектора отношений количеств вещества компонентов <span class="math notranslate nohighlight">\(Y_i, \, i = 1 \, \ldots \, N_c,\)</span> в произвольной фазе к соответствующим мольным долям в рассматриваемой системе <span class="math notranslate nohighlight">\(z_i, \, i = 1 \, \ldots \, N_c\)</span>:</p>
<div class="math notranslate nohighlight">
\[ k_i = \frac{Y_i}{z_i}, \; i = 1 \, \ldots \, N_c. \]</div>
<p>Тогда рассматриваемую систему нелинейных уравнений можно преобразовать к следующему виду:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align}
\ln k_i + \ln \phi_i \left( \mathbf{y} \right) - \ln \phi_i \left( \mathbf{z} \right) &amp;= 0, \; i = 1 \, \ldots \, N_c, \\
\ln k_i &amp;= \ln \phi_i \left( \mathbf{z} \right) - \ln \phi_i \left( \mathbf{y} \right), \; i = 1 \, \ldots \, N_c, \\
\ln k_i &amp;= \ln k_i - \left( \ln k_i + \ln \phi_i \left( \mathbf{y} \right) - \ln \phi_i \left( \mathbf{z} \right) \right), \; i = 1 \, \ldots \, N_c, \\
\ln k_i &amp;= \ln k_i - g_i, \; i = 1 \, \ldots \, N_c. \\
\end{align} \end{split}\]</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="note admonition">
<p class="admonition-title">Дополнительно</p>
<p>Метод последовательных подстановок может быть выражен относительно и других основных переменных, например, <span class="math notranslate nohighlight">\(Y_i, \, i = 1 \, \ldots \, N_c,\)</span> или <span class="math notranslate nohighlight">\(\ln Y_i, \, i = 1 \, \ldots \, N_c\)</span>. Анализ сходимости численных алгоритмов проверки стабильности при использовании различных основных переменных был выполнен авторами [<a class="reference external" href="https://doi.org/10.1016/j.fluid.2014.11.017">Petitfrere and Nichita, 2015</a>].</p>
</div>
</aside>
<p>Таким образом, метод последовательных подстановок может быть использован для решения рассматриваемой системы нелинейных уравнений относительно основных переменных <span class="math notranslate nohighlight">\(k_i, \, i = 1 \, \ldots \, N_c\)</span>, обновление которых на некоторой итерации осуществляется с использованием следующего выражения:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align}
\ln k_i^{k+1} &amp;= \ln k_i^{k} - g_i^{k}, \; i = 1 \, \ldots \, N_c, \\
k_i^{k+1} &amp;= k_i^{k} \cdot \exp \left(- g_i^{k} \right), \; i = 1 \, \ldots \, N_c.
\end{align} \end{split}\]</div>
<p>С учетом вышеизложенного представим алгоритм метода последовательных постановок для решения задачи проверки стабильности фазового состояния системы.</p>
<div class="algorithm admonition">
<p class="admonition-title">Алгоритм. Анализ стабильности с использованием метода SS</p>
<p><strong>Дано:</strong> Вектор компонентного состава исследуемой системы <span class="math notranslate nohighlight">\(\mathbf{z} \in {\rm I\!R}^{N_c}\)</span>; термобарические условия <span class="math notranslate nohighlight">\(P\)</span> и <span class="math notranslate nohighlight">\(T\)</span>; необходимые свойства компонентов для нахождения коэффициентов летучести компонентов с использованием уравнения состояния; максимальное число итераций <span class="math notranslate nohighlight">\(N_{iter}\)</span>; точность решения системы нелинейных уравнений <span class="math notranslate nohighlight">\(\epsilon_1\)</span>; численная погрешность расчета <span class="math notranslate nohighlight">\(0 &lt; \epsilon_2 \leq 10^{-4}\)</span>.</p>
<p><strong>Определить:</strong> Является ли однофазное состояние системы с компонентным составом <span class="math notranslate nohighlight">\(\mathbf{z}\)</span> при давлении <span class="math notranslate nohighlight">\(P\)</span> и температуре <span class="math notranslate nohighlight">\(T\)</span> стабильным.</p>
<p><strong>Псевдокод:</strong><br />
<strong>def</strong> <span class="math notranslate nohighlight">\(\phi \left( \mathbf{y} \in {\rm I\!R}^{N_c}, \, \ldots \right) \rightarrow \boldsymbol{\varphi} \in {\rm I\!R}^{N_c}\)</span> <span class="comment"># Функция для расчета вектора коэффициентов летучести</span><br />
<span class="math notranslate nohighlight">\(\mathbf{K} := \left\{ \mathbf{k}_0, \, \mathbf{k}_1, \, \ldots, \, \mathbf{k}_N \right\}\)</span> <span class="comment"># Инициализация набора (матрицы) начальных приближений</span><br />
<span class="math notranslate nohighlight">\(\mathbf{h} := \ln \phi \left( \mathbf{z} \right) + \ln \mathbf{z}\)</span>  <span class="comment"># Расчет коэффициентов летучести для начального состава</span><br />
<strong>for</strong> <span class="math notranslate nohighlight">\(i := 1\)</span> <strong>to</strong> <span class="math notranslate nohighlight">\(N\)</span> <strong>do</strong> <span class="comment"># Цикл перебора начальных приближений</span><br />
 <span class="math notranslate nohighlight">\(\mathbf{k} := \mathbf{K}\left[ i \right]\)</span> <span class="comment"># Вектор основных переменных</span><br />
 <span class="math notranslate nohighlight">\(\mathbf{Y} := \mathbf{k} \cdot \mathbf{z}\)</span><br />
 <span class="math notranslate nohighlight">\(\mathbf{y} := \mathbf{Y} \, / \, \sum_{i=1}^{N_c} Y_i\)</span><br />
 <span class="math notranslate nohighlight">\(\mathbf{g} := \ln \mathbf{Y} + \ln \phi \left( \mathbf{y} \right) - \mathbf{h}\)</span> <span class="comment"># Вектор невязок</span><br />
 <span class="math notranslate nohighlight">\(c := 1\)</span> <span class="comment"># Счетчик итераций решения системы нелинейных уравнений</span><br />
 <strong>while</strong> <span class="math notranslate nohighlight">\(\lVert \mathbf{g} \rVert_2 &gt; \epsilon_1\)</span> <strong>and</strong> <span class="math notranslate nohighlight">\(c &lt; N_{iter}\)</span> <strong>do</strong> <span class="comment"># Цикл решения системы нелинейных уравнений</span><br />
  <span class="math notranslate nohighlight">\(\mathbf{k} := \mathbf{k} \cdot \exp \left( - \mathbf{g} \right)\)</span> <span class="comment"># Расчет новых значений вектора основных переменных</span><br />
  <span class="math notranslate nohighlight">\(\mathbf{Y} := \mathbf{k} \cdot \mathbf{z}\)</span><br />
  <span class="math notranslate nohighlight">\(\mathbf{y} := \mathbf{Y} \, / \, \sum_{i=1}^{N_c} Y_i\)</span><br />
  <span class="math notranslate nohighlight">\(\mathbf{g} := \ln \mathbf{Y} + \ln \phi \left( \mathbf{y} \right) - \mathbf{h}\)</span> <span class="comment"># Новые значения вектора невязок</span><br />
  <span class="math notranslate nohighlight">\(c := c + 1\)</span> <span class="comment"># Обновление счетчика итераций</span><br />
 <strong>end while</strong><br />
 <span class="math notranslate nohighlight">\(TPD := - \ln \sum_{i=1}^{N_c} Y_i\)</span> <span class="comment"># Расчет значения функции TPD</span><br />
 <strong>if</strong> <span class="math notranslate nohighlight">\(\lVert \mathbf{g} \rVert_2 &lt; \epsilon_1\)</span> <strong>and</strong> <span class="math notranslate nohighlight">\(TPD &lt; -\epsilon_2\)</span> <strong>then</strong> <span class="comment"># Проверка условия стабильности</span><br />
  <span class="math notranslate nohighlight">\(is\_stable := \mathrm{False}\)</span><br />
  <strong>exit for</strong> <span class="comment"># Выход из цикла перебора начальных приближений</span><br />
 <strong>else</strong><br />
  <strong>continue</strong><br />
 <strong>end if</strong><br />
<strong>else</strong><br />
 <span class="math notranslate nohighlight">\(is\_stable := \mathrm{True}\)</span><br />
<strong>end for</strong></p>
</div>
<p>В данном алгоритме в качестве критерия, определяющего нестабильность рассматриваемого однофазового состояния, использовалось следующее выражение:</p>
<div class="math notranslate nohighlight">
\[ TPD = - \ln \sum_{i=1}^{N_c} Y_i &lt; -\epsilon_2, \]</div>
<p>где значение <span class="math notranslate nohighlight">\(\epsilon_2\)</span> выбирается из диапазона <span class="math notranslate nohighlight">\(0 &lt; \epsilon_2 \leq 10^{-4}\)</span>. Использование такого подхода необходимо в связи с применением численного метода, в ходе которого система нелинейных уравнений разрешается с некоторой точностью. Его преимуществом является сравнительная простота вычисления, а недостатком – ложное отнесение состояний, характеризующихся <span class="math notranslate nohighlight">\(- \epsilon_2 &lt; TPD &lt; 0\)</span>, к стабильным. Альтернативный и более строгий критерий можно сформулировать следующим образом:</p>
<div class="math notranslate nohighlight">
\[ \left( - \ln \sum_{i=1}^{N_c} Y_i &lt; 0 \right) \land \left( \max_i k_i - \min_i k_i &gt; \epsilon_1 \right). \]</div>
<p>Недостатком данной формулировки является необходимость нахождения минимального и максимального элемента вектора основных переменных <span class="math notranslate nohighlight">\(k_i, \, i = 1 \, \ldots \, N_c\)</span>.</p>
<section id="pvt-sec-stability-pt-ss-init">
<span id="id5"></span><h4>Начальные приближения<a class="headerlink" href="#pvt-sec-stability-pt-ss-init" title="Link to this heading">#</a></h4>
<p>Итак, рассматриваемая задача анализа стабильности фазового состояния системы заключается в проверке значений функции TPD в ее стационарных точках. Как уже было отмечено ранее, для нахождения различных стационарных точек необходимо задаться множеством начальных приближений. В связи с этим очевидным недостатком данного подхода является конечность набора начальных приближений (и с точки зрения времени счета – их количество, ведь чем больше начальных приближений мы рассмотрим, тем с большей вероятностью найдем глобальный минимум функции TPD, однако это приведет к увеличению времени работы алгоритма). Таким образом, корректный выбор начальных приближений является одним из залогов успешного решения задачи определения стабильности фазового состояния системы.</p>
<p>В работе [<a class="reference external" href="https://doi.org/10.1016/0378-3812(82)85001-2">Michelsen, 1982</a>] было предложено использовать корреляцию Уилсона для генерации начальных приближений углеводородной системы:</p>
<div class="math notranslate nohighlight">
\[ k_i^{go} = \frac{{P_c}_i}{P} \cdot \exp \left( 5.3727 \left(1 + \omega_i \right) \left(1 - \frac{{T_c}_i}{T} \right) \right), \; i = 1 \, \ldots \, N_c. \]</div>
<p>То есть в качестве начальных приближений <span class="math notranslate nohighlight">\(k_i, \, i = 1 \, \ldots \, N_c,\)</span> в работе [<a class="reference external" href="https://doi.org/10.1016/0378-3812(82)85001-2">Michelsen, 1982</a>] применялся набор из следующих векторов:</p>
<div class="math notranslate nohighlight">
\[ k_i = \left\{ k_i^{go}, \; \frac{1}{k_i^{go}} \right\}, \; i = 1 \, \ldots \, N_c. \]</div>
<p>Автором отмечается, что если рассматривать системы, состоящие из углеводородных компонентов, то при использовании одного из данных векторов в качестве начального приближения алгоритм сходится к тривиальному решению, а при использовании другого – к искомому решению системы нелинейных уравнений. Следовательно, для многих углеводородных смесей необходим только один из данных векторов: если заданный компонентный состав рассматриваемой системы больше походит на жидкость, то в качестве начального приближения подходит вектор <span class="math notranslate nohighlight">\(k_i^{go}, \, i = 1 \, \ldots \, N_c,\)</span> иначе: <span class="math notranslate nohighlight">\(1 \, / \, k_i^{go}, \, i = 1 \, \ldots \, N_c\)</span>. Однако для систем, находящихся вблизи критической точки, необходимо использование обоих начальных приближений, поскольку значения плотностей фаз становятся близкими друг к другу, и заранее неизвестно, к какому фазовому состоянию (жидкому или газообразному) ближе исходный компонентный состав рассматриваемой системы.</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="note admonition">
<p class="admonition-title">Дополнительно</p>
<p>Вблизи <a class="reference internal" href="SEC-7-Criticality.html"><span class="std std-doc">критической точки</span></a> компонентные составы фаз становятся похожими друг на друга, а отношения мольных долей компонентов в фазах стремятся к единице. Это обуславливает возведение элементов векторов начальных приближений в степень <span class="math notranslate nohighlight">\(\left( 1 \, / \, 3 \right)\)</span>, позволяющее снизить различие между максимальным и минимальным значениями элементов вектора.</p>
</div>
</aside>
<p>Для систем вблизи критической точки и систем, включающих неуглеводородные компоненты, в работе [<a class="reference external" href="https://doi.org/10.2118/129844-PA">Li and Firoozabadi, 2012</a>] было предложено дополнить данный набор следующими начальными приближениями:</p>
<div class="math notranslate nohighlight">
\[ k_i = \left\{ k_i^{go}, \; \frac{1}{k_i^{go}}, \; \sqrt[3]{k_i^{go}}, \; \frac{1}{\sqrt[3]{k_i^{go}}}, \; k_i^{pure} \right\}, \; i = 1 \, \ldots \, N_c, \]</div>
<p>где:</p>
<div class="math notranslate nohighlight">
\[\begin{split} k_i^{pure} = \begin{cases} \left(1 - \epsilon \right) / z_i, &amp; i = \mathrm{specific \, component}, \\ \left( \epsilon / \left( N_c - 1 \right) \right) / z_i, &amp; i = \mathrm{others}. \end{cases} \end{split}\]</div>
<p>Данный набор начальных приближений хорошо подходит для проверки стабильности систем, где мольная доля одного компонента в потенциальной (мнимой) фазе много больше мольных долей других. Например, к таким системам относится смесь углеводородов с водой, в этом случае <span class="math notranslate nohighlight">\(\epsilon = 1\mathrm{e}-3\)</span>, согласно [<a class="reference external" href="https://doi.org/10.1021/acs.iecr.9b00695">Connolly et al, 2019</a>] (для водных растворов иногда имеет смысл задать <span class="math notranslate nohighlight">\(\epsilon = 1\mathrm{e}-15\)</span>, согласно [<a class="reference external" href="https://doi.org/10.1016/j.fuel.2019.02.026">Li and Li, 2019</a>]). Для систем с высоким содержанием диоксида углерода рекомендуется <span class="math notranslate nohighlight">\(\epsilon = 0.05\)</span>, согласно [<a class="reference external" href="https://doi.org/10.1016/j.fluid.2019.06.002">Imai at al, 2019</a>].</p>
</section>
<section id="pvt-sec-stability-pt-ss-examples">
<span id="id6"></span><h4>Примеры<a class="headerlink" href="#pvt-sec-stability-pt-ss-examples" title="Link to this heading">#</a></h4>
<p>Рассмотрим реализацию данного алгоритма для приведенных выше примеров.</p>
<div class="exercise admonition">
<p class="admonition-title">Пример</p>
<p>Пусть имеется <span class="math notranslate nohighlight">\(1 \; моль\)</span> смеси из метана и диоксида углерода при температуре <span class="math notranslate nohighlight">\(40 \; ^{\circ} C\)</span> и давлении <span class="math notranslate nohighlight">\(2 \; МПа\)</span> с мольной долей метана <span class="math notranslate nohighlight">\(0.85\)</span>. Необходимо определить, является ли однофазное состояние данной системы стабильным, с использованием численного алгоритма.</p>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Решение</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Зададим исходные термобарические условия и компонентный состав.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">2e6</span><span class="p">)</span> <span class="c1"># Pressure [Pa]</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">40.</span> <span class="o">+</span> <span class="mf">273.15</span><span class="p">)</span> <span class="c1"># Temperature [K]</span>
<span class="n">yi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">.15</span><span class="p">,</span> <span class="mf">.85</span><span class="p">])</span> <span class="c1"># Mole fractions [fr.]</span>
</pre></div>
</div>
<p class="sd-card-text">Также зададим максимальное число итераций <span class="math notranslate nohighlight">\(N_{iter}\)</span>, точность решения системы нелинейных уравнений <span class="math notranslate nohighlight">\(\epsilon_1\)</span>, численную погрешность расчета <span class="math notranslate nohighlight">\(\epsilon_2\)</span>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">maxiter</span> <span class="o">=</span> <span class="mi">50</span> <span class="c1"># Maximum number of iterations</span>
<span class="n">eps1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">1e-6</span><span class="p">)</span> <span class="c1"># Tolerance</span>
<span class="n">eps2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">1e-4</span><span class="p">)</span>
</pre></div>
</div>
<p class="sd-card-text">Для выполнения вычислений будем использовать свойства компонентов и класс с уравнением состояния, заданные при рассмотрении предыдущих примеров. Рассчитаем матрицу начальных приближений <span class="math notranslate nohighlight">\(\mathbf{K}\)</span>. Для данного примера нам будет достаточно два приближения, рассчитанных по уравнению Уилсона:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ki</span> <span class="o">=</span> <span class="n">Pci</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">5.3727</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">wi</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">Tci</span> <span class="o">/</span> <span class="n">T</span><span class="p">))</span> <span class="o">/</span> <span class="n">P</span> <span class="c1"># Wilson&#39;s correlation</span>
<span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">ki</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">ki</span><span class="p">])</span> <span class="c1"># Matrix of initial estimates</span>
</pre></div>
</div>
<p class="sd-card-text">Создадим функцию, которая будет принимать на вход кортеж из результатов предыдущей итерации, точность и максимальное число итераций, и возвращать необходимость расчета следующей итерации цикла решения системы нелинейных уравнений:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">condit_ss</span><span class="p">(</span><span class="n">carry</span><span class="p">,</span> <span class="n">tol</span><span class="p">,</span> <span class="n">maxiter</span><span class="p">):</span>
    <span class="n">k</span><span class="p">,</span> <span class="n">ki</span><span class="p">,</span> <span class="n">gi</span> <span class="o">=</span> <span class="n">carry</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">k</span> <span class="o">&lt;</span> <span class="n">maxiter</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">gi</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">)</span>
</pre></div>
</div>
<p class="sd-card-text">Также создадим функцию, которая будет принимать на вход результаты предыдущей итерации в виде кортежа и рассчитывать результаты для новой итерации:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">update_ss</span><span class="p">(</span><span class="n">carry</span><span class="p">,</span> <span class="n">hi</span><span class="p">,</span> <span class="n">yi</span><span class="p">,</span> <span class="n">plnphi</span><span class="p">):</span>
    <span class="n">k</span><span class="p">,</span> <span class="n">ki</span><span class="p">,</span> <span class="n">gi</span> <span class="o">=</span> <span class="n">carry</span>
    <span class="n">ki_kp1</span> <span class="o">=</span> <span class="n">ki_k</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">gi_k</span><span class="p">)</span>
    <span class="n">ni</span> <span class="o">=</span> <span class="n">ki_kp1</span> <span class="o">*</span> <span class="n">yi</span>
    <span class="n">gi_kp1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">ni</span><span class="p">)</span> <span class="o">+</span> <span class="n">plnphi</span><span class="p">(</span><span class="n">yi</span><span class="o">=</span><span class="n">ni</span><span class="o">/</span><span class="n">ni</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="o">-</span> <span class="n">hi</span>
    <span class="k">return</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ki_kp1</span><span class="p">,</span> <span class="n">gi_kp1</span>
</pre></div>
</div>
<p class="sd-card-text">Выполним расчет коэффициентов летучести для начального компонентного состава. Для этого будем использовать метод <code class="docutils literal notranslate"><span class="pre">getPT_lnphii</span></code> инициализированного класса с уравнением состояния, принимающий на вход давление (в Па), температуру (в K) и компонентный состав в виде одномерного массива (размерностью <code class="docutils literal notranslate"><span class="pre">(Nc,)</span></code>) и возвращающий массив логарифмов коэффициентов летучести компонента такой же размерности:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hi</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">getPT_lnphii</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">yi</span><span class="p">)</span>
</pre></div>
</div>
<p class="sd-card-text">Проинициализируем функции <code class="docutils literal notranslate"><span class="pre">condit</span></code> и <code class="docutils literal notranslate"><span class="pre">update</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>

<span class="n">pcondit</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">condit_ss</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">eps1</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="n">maxiter</span><span class="p">)</span>
<span class="n">pupdate</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">update_ss</span><span class="p">,</span> <span class="n">hi</span><span class="o">=</span><span class="n">hi</span><span class="p">,</span> <span class="n">yi</span><span class="o">=</span><span class="n">yi</span><span class="p">,</span> <span class="n">plnphi</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">pr</span><span class="o">.</span><span class="n">getPT_lnphii</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">))</span>
</pre></div>
</div>
<p class="sd-card-text">Выполним расчет функции TPD для различных начальных приближений:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ki</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
    <span class="n">ni</span> <span class="o">=</span> <span class="n">ki</span> <span class="o">*</span> <span class="n">yi</span>
    <span class="n">gi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">ni</span><span class="p">)</span> <span class="o">+</span> <span class="n">pr</span><span class="o">.</span><span class="n">getPT_lnphii</span><span class="p">(</span><span class="n">P</span><span class="o">=</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span> <span class="n">yi</span><span class="o">=</span><span class="n">ni</span><span class="o">/</span><span class="n">ni</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="o">-</span> <span class="n">hi</span>
    <span class="n">carry</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ki</span><span class="p">,</span> <span class="n">gi</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">pcondit</span><span class="p">(</span><span class="n">carry</span><span class="p">):</span>
        <span class="n">carry</span> <span class="o">=</span> <span class="n">pupdate</span><span class="p">(</span><span class="n">carry</span><span class="p">)</span>
    <span class="n">c</span><span class="p">,</span> <span class="n">ki</span><span class="p">,</span> <span class="n">gi</span> <span class="o">=</span> <span class="n">carry</span>
    <span class="n">ni</span> <span class="o">=</span> <span class="n">ki</span> <span class="o">*</span> <span class="n">yi</span>
    <span class="n">TPD</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">ni</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
    <span class="n">gnorm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">gi</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;For the initial guess #</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">:</span><span class="se">\n</span><span class="s1">&#39;</span>
          <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">tolerance of equations: </span><span class="si">{</span><span class="n">gnorm</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
          <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">number of iterations: </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
          <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">k-values: </span><span class="si">{</span><span class="n">ki</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
          <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">TPD: </span><span class="si">{</span><span class="n">TPD</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">gnorm</span> <span class="o">&lt;</span> <span class="n">eps1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">TPD</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">eps2</span><span class="p">):</span>
        <span class="n">is_stable</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">break</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">is_stable</span> <span class="o">=</span> <span class="kc">True</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The system is stable: </span><span class="si">{</span><span class="n">is_stable</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="output text_html">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre id="codecell20" tabindex="0"><span></span>For the initial guess #0:<br>	tolerance of equations: 4.10989548708671e-08<br>	number of iterations: 4<br>	k-values: [0.99999996 1.00000001]<br>	TPD: 3.785860513971856e-14<br>For the initial guess #1:<br>	tolerance of equations: 1.0848436052428515e-07<br>	number of iterations: 4<br>	k-values: [1.00000011 0.99999998]<br>	TPD: 2.6489921367559744e-13<br>The system is stable: True
</pre><button class="copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#codecell20">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#000000" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <title>Copy to clipboard</title>
  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
  <rect x="8" y="8" width="12" height="12" rx="2"></rect>
  <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path>
</svg>
    </button></div>
</div>
</div><p class="sd-card-text">По результатам расчетов видно, что для обоих начальных приближений алгоритм сошелся на тривиальном решении, в котором значение TPD равно нулю. Таким образом, можно сделать вывод, что система стабильна.</p>
</div>
</details><p>Рассмотрим применение данного алгоритма для следующего примера.</p>
<div class="exercise admonition">
<p class="admonition-title">Пример</p>
<p>Пусть имеется <span class="math notranslate nohighlight">\(1 \; моль\)</span> смеси из метана и диоксида углерода при температуре <span class="math notranslate nohighlight">\(10 \; ^{\circ} C\)</span> и давлении <span class="math notranslate nohighlight">\(6 \; МПа\)</span> с мольной долей метана <span class="math notranslate nohighlight">\(0.1\)</span>. Необходимо определить, является ли однофазное состояние данной системы стабильным, с использованием численного алгоритма.</p>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Решение</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Зададим исходные термобарические условия и компонентный состав.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">6e6</span><span class="p">)</span> <span class="c1"># Pressure [Pa]</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">10.</span> <span class="o">+</span> <span class="mf">273.15</span><span class="p">)</span> <span class="c1"># Temperature [K]</span>
<span class="n">yi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">.9</span><span class="p">,</span> <span class="mf">.1</span><span class="p">])</span> <span class="c1"># Mole fractions [fr.]</span>
</pre></div>
</div>
<p class="sd-card-text">Для выполнения вычислений будем использовать свойства компонентов и класс с уравнением состояния, заданные при рассмотрении предыдущих примеров. Рассчитаем матрицу начальных приближений <span class="math notranslate nohighlight">\(\mathbf{K}\)</span>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ki</span> <span class="o">=</span> <span class="n">Pci</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">5.3727</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">wi</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">Tci</span> <span class="o">/</span> <span class="n">T</span><span class="p">))</span> <span class="o">/</span> <span class="n">P</span> <span class="c1"># Wilson&#39;s correlation</span>
<span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">ki</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">ki</span><span class="p">])</span> <span class="c1"># Matrix of initial estimates</span>
</pre></div>
</div>
<p class="sd-card-text">Выполним расчет коэффициентов летучести для начального компонентного состава:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hi</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">getPT_lnphii</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">yi</span><span class="p">)</span>
</pre></div>
</div>
<p class="sd-card-text">Проинициализируем функции <code class="docutils literal notranslate"><span class="pre">condit</span></code> и <code class="docutils literal notranslate"><span class="pre">update</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pcondit</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">condit_ss</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">eps1</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="n">maxiter</span><span class="p">)</span>
<span class="n">pupdate</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">update_ss</span><span class="p">,</span> <span class="n">hi</span><span class="o">=</span><span class="n">hi</span><span class="p">,</span> <span class="n">yi</span><span class="o">=</span><span class="n">yi</span><span class="p">,</span> <span class="n">plnphi</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">pr</span><span class="o">.</span><span class="n">getPT_lnphii</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">))</span>
</pre></div>
</div>
<p class="sd-card-text">Выполним расчет функции TPD для различных начальных приближений:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ki</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
    <span class="n">ni</span> <span class="o">=</span> <span class="n">ki</span> <span class="o">*</span> <span class="n">yi</span>
    <span class="n">gi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">ni</span><span class="p">)</span> <span class="o">+</span> <span class="n">pr</span><span class="o">.</span><span class="n">getPT_lnphii</span><span class="p">(</span><span class="n">P</span><span class="o">=</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span> <span class="n">yi</span><span class="o">=</span><span class="n">ni</span><span class="o">/</span><span class="n">ni</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="o">-</span> <span class="n">hi</span>
    <span class="n">carry</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ki</span><span class="p">,</span> <span class="n">gi</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">pcondit</span><span class="p">(</span><span class="n">carry</span><span class="p">):</span>
        <span class="n">carry</span> <span class="o">=</span> <span class="n">pupdate</span><span class="p">(</span><span class="n">carry</span><span class="p">)</span>
    <span class="n">c</span><span class="p">,</span> <span class="n">ki</span><span class="p">,</span> <span class="n">gi</span> <span class="o">=</span> <span class="n">carry</span>
    <span class="n">ni</span> <span class="o">=</span> <span class="n">ki</span> <span class="o">*</span> <span class="n">yi</span>
    <span class="n">TPD</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">ni</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
    <span class="n">gnorm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">gi</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;For the initial guess #</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">:</span><span class="se">\n</span><span class="s1">&#39;</span>
          <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">tolerance of equations: </span><span class="si">{</span><span class="n">gnorm</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
          <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">number of iterations: </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
          <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">k-values: </span><span class="si">{</span><span class="n">ki</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
          <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">TPD: </span><span class="si">{</span><span class="n">TPD</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">gnorm</span> <span class="o">&lt;</span> <span class="n">eps1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">TPD</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">eps2</span><span class="p">):</span>
        <span class="n">is_stable</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">break</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">is_stable</span> <span class="o">=</span> <span class="kc">True</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The system is stable: </span><span class="si">{</span><span class="n">is_stable</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="output text_html">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre id="codecell20" tabindex="0"><span></span>For the initial guess #0:<br>	tolerance of equations: 1.5607517358997374e-07<br>	number of iterations: 8<br>	k-values: [0.89240884 2.13512243]<br>	TPD: -0.01654261679169803<br>The system is stable: False
</pre><button class="copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#codecell20">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#000000" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <title>Copy to clipboard</title>
  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
  <rect x="8" y="8" width="12" height="12" rx="2"></rect>
  <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path>
</svg>
    </button></div>
</div>
</div><p class="sd-card-text">Реализованный алгоритм проверки стабильности уже для первого начального приближения нашел решение системы нелинейных уравнений, характеризующееся отрицательным значением функции TPD, следовательно, однофазное состояние не является стабильным.</p>
</div>
</details><p>Важно отметить, что метод последовательных подстановок может характеризоваться малой скоростью сходимости, в особенности для термобарических условий вблизи границы двухфазной области. Проиллюстрируем данное свойство следующим примером.</p>
<!-- TODO: добавить анализ сходимости метода SS. См. 10.1016/0378-3812(82)85001-2, 10.1021/ie00042a032, 10.1002/aic.690210314 -->
<div class="exercise admonition">
<p class="admonition-title">Пример</p>
<p>Пусть имеется <span class="math notranslate nohighlight">\(1 \; моль\)</span> смеси следующего мольного состава:</p>
<div class="pst-scrollable-table-container"><table class="table" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Компонент</p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(\mathrm{CH_4}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(\mathrm{C_2 H_6}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(\mathrm{C_3 H_8}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(\mathrm{n \mbox{-} C_4}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(\mathrm{C_{5+}}\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>Мольная доля</p></td>
<td class="text-center"><p>0.7167</p></td>
<td class="text-center"><p>0.0895</p></td>
<td class="text-center"><p>0.0917</p></td>
<td class="text-center"><p>0.0448</p></td>
<td class="text-center"><p>0.0573</p></td>
</tr>
</tbody>
</table>
</div>
<br>
<p>Необходимо определить является ли однофазное состояние стабильным при давлении <span class="math notranslate nohighlight">\(17 \; МПа\)</span> и температуре <span class="math notranslate nohighlight">\(68 \; ^{\circ} C\)</span>.</p>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Решение</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Зададим исходные термобарические условия и компонентный состав.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">17e6</span><span class="p">)</span> <span class="c1"># Pressure [Pa]</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">68.</span> <span class="o">+</span> <span class="mf">273.15</span><span class="p">)</span> <span class="c1"># Temperature [K]</span>
<span class="n">yi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.7167</span><span class="p">,</span> <span class="mf">0.0895</span><span class="p">,</span> <span class="mf">0.0917</span><span class="p">,</span> <span class="mf">0.0448</span><span class="p">,</span> <span class="mf">0.0573</span><span class="p">])</span> <span class="c1"># Mole fractions [fr.]</span>
</pre></div>
</div>
<p class="sd-card-text">Зададим свойства компонентов, необходимые для уравнения состояния Пенга-Робинсона, и выполним инициализацию класса.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Pci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">4.599</span><span class="p">,</span> <span class="mf">4.872</span><span class="p">,</span> <span class="mf">4.248</span><span class="p">,</span> <span class="mf">3.796</span><span class="p">,</span> <span class="mf">2.398</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1e6</span> <span class="c1"># Critical pressures [Pa]</span>
<span class="n">Tci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">190.56</span><span class="p">,</span> <span class="mf">305.32</span><span class="p">,</span> <span class="mf">369.83</span><span class="p">,</span> <span class="mf">425.12</span><span class="p">,</span> <span class="mf">551.02</span><span class="p">])</span> <span class="c1"># Critical temperatures [K]</span>
<span class="n">wi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.012</span><span class="p">,</span> <span class="mf">0.100</span><span class="p">,</span> <span class="mf">0.152</span><span class="p">,</span> <span class="mf">0.200</span><span class="p">,</span> <span class="mf">0.414</span><span class="p">])</span> <span class="c1"># Acentric factors</span>
<span class="n">mwi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.016043</span><span class="p">,</span> <span class="mf">0.03007</span><span class="p">,</span> <span class="mf">0.044097</span><span class="p">,</span> <span class="mf">0.058123</span><span class="p">,</span> <span class="mf">0.120</span><span class="p">])</span> <span class="c1"># Molar mass [kg/gmole]</span>
<span class="n">vsi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.1595</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1134</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0863</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0675</span><span class="p">,</span> <span class="mf">0.05661</span><span class="p">])</span> <span class="c1"># Volume shift parameters</span>
<span class="n">dij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="mf">0.002689</span><span class="p">,</span>
    <span class="mf">0.008537</span><span class="p">,</span> <span class="mf">0.001662</span><span class="p">,</span>
    <span class="mf">0.014748</span><span class="p">,</span> <span class="mf">0.004914</span><span class="p">,</span> <span class="mf">0.000866</span><span class="p">,</span>
    <span class="mf">0.039265</span><span class="p">,</span> <span class="mf">0.021924</span><span class="p">,</span> <span class="mf">0.011676</span><span class="p">,</span> <span class="mf">0.006228</span><span class="p">,</span>
<span class="p">])</span> <span class="c1"># Binary interaction parameters</span>
<span class="n">pr</span> <span class="o">=</span> <span class="n">pr78</span><span class="p">(</span><span class="n">Pci</span><span class="p">,</span> <span class="n">Tci</span><span class="p">,</span> <span class="n">wi</span><span class="p">,</span> <span class="n">mwi</span><span class="p">,</span> <span class="n">vsi</span><span class="p">,</span> <span class="n">dij</span><span class="p">)</span>
</pre></div>
</div>
<p class="sd-card-text">Рассчитаем матрицу начальных приближений <span class="math notranslate nohighlight">\(\mathbf{K}\)</span>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ki</span> <span class="o">=</span> <span class="n">Pci</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">5.3727</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">wi</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">Tci</span> <span class="o">/</span> <span class="n">T</span><span class="p">))</span> <span class="o">/</span> <span class="n">P</span> <span class="c1"># Wilson&#39;s correlation</span>
<span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">ki</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">ki</span><span class="p">])</span> <span class="c1"># Matrix of initial estimates</span>
</pre></div>
</div>
<p class="sd-card-text">Выполним расчет коэффициентов летучести для начального компонентного состава:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hi</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">getPT_lnphii</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">yi</span><span class="p">)</span>
</pre></div>
</div>
<p class="sd-card-text">Зададим максимальное число итераций <span class="math notranslate nohighlight">\(N_{iter}\)</span>, точность решения системы нелинейных уравнений <span class="math notranslate nohighlight">\(\epsilon_1\)</span>, численную погрешность расчета <span class="math notranslate nohighlight">\(\epsilon_2\)</span>. Для данного примера увеличим максимальное число итераций:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">maxiter</span> <span class="o">=</span> <span class="mi">200</span> <span class="c1"># Maximum number of iterations</span>
<span class="n">eps1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">1e-6</span><span class="p">)</span> <span class="c1"># Tolerance</span>
<span class="n">eps2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">1e-4</span><span class="p">)</span>
</pre></div>
</div>
<p class="sd-card-text">Проинициализируем функции <code class="docutils literal notranslate"><span class="pre">condit</span></code> и <code class="docutils literal notranslate"><span class="pre">update</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pcondit</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">condit_ss</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">eps1</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="n">maxiter</span><span class="p">)</span>
<span class="n">pupdate</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">update_ss</span><span class="p">,</span> <span class="n">hi</span><span class="o">=</span><span class="n">hi</span><span class="p">,</span> <span class="n">yi</span><span class="o">=</span><span class="n">yi</span><span class="p">,</span> <span class="n">plnphi</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">pr</span><span class="o">.</span><span class="n">getPT_lnphii</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">))</span>
</pre></div>
</div>
<p class="sd-card-text">Выполним расчет функции TPD для различных начальных приближений:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ki</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
    <span class="n">ni</span> <span class="o">=</span> <span class="n">ki</span> <span class="o">*</span> <span class="n">yi</span>
    <span class="n">gi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">ni</span><span class="p">)</span> <span class="o">+</span> <span class="n">pr</span><span class="o">.</span><span class="n">getPT_lnphii</span><span class="p">(</span><span class="n">P</span><span class="o">=</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span> <span class="n">yi</span><span class="o">=</span><span class="n">ni</span><span class="o">/</span><span class="n">ni</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="o">-</span> <span class="n">hi</span>
    <span class="n">carry</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ki</span><span class="p">,</span> <span class="n">gi</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">pcondit</span><span class="p">(</span><span class="n">carry</span><span class="p">):</span>
        <span class="n">carry</span> <span class="o">=</span> <span class="n">pupdate</span><span class="p">(</span><span class="n">carry</span><span class="p">)</span>
    <span class="n">c</span><span class="p">,</span> <span class="n">ki</span><span class="p">,</span> <span class="n">gi</span> <span class="o">=</span> <span class="n">carry</span>
    <span class="n">ni</span> <span class="o">=</span> <span class="n">ki</span> <span class="o">*</span> <span class="n">yi</span>
    <span class="n">TPD</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">ni</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
    <span class="n">gnorm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">gi</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;For the initial guess #</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">:</span><span class="se">\n</span><span class="s1">&#39;</span>
          <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">tolerance of equations: </span><span class="si">{</span><span class="n">gnorm</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
          <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">number of iterations: </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
          <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">k-values: </span><span class="si">{</span><span class="n">ki</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
          <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">TPD: </span><span class="si">{</span><span class="n">TPD</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">gnorm</span> <span class="o">&lt;</span> <span class="n">eps1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">TPD</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">eps2</span><span class="p">):</span>
        <span class="n">is_stable</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">break</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">is_stable</span> <span class="o">=</span> <span class="kc">True</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The system is stable: </span><span class="si">{</span><span class="n">is_stable</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="output text_html">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre id="codecell20" tabindex="0"><span></span>For the initial guess #0:<br>	tolerance of equations: 9.693061940332048e-07<br>	number of iterations: 186<br>	k-values: [1.00000264 0.99999854 0.99999547 0.99999243 0.99998243]<br>	TPD: 7.001066393288688e-13<br>For the initial guess #1:<br>	tolerance of equations: 9.116302252707581e-07<br>	number of iterations: 72<br>	k-values: [0.79433225 1.03491285 1.25365307 1.51437834 2.73407127]<br>	TPD: -0.0013880767263051163<br>The system is stable: False
</pre><button class="copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#codecell20">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#000000" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <title>Copy to clipboard</title>
  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
  <rect x="8" y="8" width="12" height="12" rx="2"></rect>
  <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path>
</svg>
    </button></div>
</div>
</div><p class="sd-card-text">По результатам расчетов метод последовательных подстановок для первого начального приближения сошелся к тривиальному решению за 186 итераций, а для следующего начального приближения нашел решение, характеризующееся отрицательным значением функции TPD, за 72 итерации. Таким образом, рассматриваемое однофазное состояние не является стабильным.</p>
</div>
</details><!-- TODO: показать на примере увеличение количества итераций метода последовательных подстановок вблизи критической точки -->
<p>Существует также множество работ, посвященных разработке алгоритмов, направленных на оптимизацию метода последовательных подстановок. В работе [<a class="reference external" href="https://doi.org/10.1016/0378-3812(82)85001-2">Michelsen, 1982</a>] было предложено использовать метод GDEM. В работах [<a class="reference external" href="https://doi.org/10.2118/12242-MS">Nghiem, 1983</a>; <a class="reference external" href="https://doi.org/10.1016/0378-3812(84)80013-8">Nghiem and Li, 1984</a>] авторы рассмотрели различные подходы к оптимизации метода последовательных подстановок путем введения длины шага итерации и его расчета на основе результатов предыдущей итерации. Примеры реализации некоторых из алгоритмов представлены <a class="reference external" href="https://github.com/DanielSkorov/ReservoirSimulation/blob/main/_src/stability.py">здесь</a>.</p>
</section>
</section>
<section id="pvt-sec-stability-pt-newton">
<span id="id7"></span><h3>Метод минимизации функции<a class="headerlink" href="#pvt-sec-stability-pt-newton" title="Link to this heading">#</a></h3>
<p>К решению задачи определения стабильности некоторой системы можно подойти с точки зрения минимизации функции TPD:</p>
<div class="math notranslate nohighlight">
\[ \bar{D} \left( \mathbf{y} \right) = \sum_{i=1}^{N_c} y_i \left( \ln y_i + \ln \phi_i \left( \mathbf{y} \right) - h_i \right). \]</div>
<p>Если использовать в качестве основных переменных мольные доли компонентов для произвольного состава <span class="math notranslate nohighlight">\(y_i, \, i = 1 \, \ldots \, N_c,\)</span>, то такая задача будет являться <em>задачей условной минимизации</em> или <em>задачей минимизации с ограничениями (constrained minimization)</em>. В качестве условий будут выступать следующие соотношения:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align}
&amp; y_i &gt; 0, \; i = 1 \, \ldots \, N_c, \\
&amp; \sum_{i=1}^{N_c} y_i = 1.
\end{align} \end{split}\]</div>
<p>Решение задачи условной минимизации зачастую сложнее <em>безусловной (unconstrained minimization)</em>. В связи с этим имеет смысл исключить данные условия из рассмотрения путем замены основных переменных. Для исключения второго условия в качестве основных переменных можно использовать уже упомянутые ранее количества вещества компонентов в произвольной (мнимой) фазе:</p>
<div class="math notranslate nohighlight">
\[ Y_i = y_i \mathrm{e}^{-\bar{K}}, \; i = 1 \, \ldots \, N_c. \]</div>
<p>В связи с изложенным выше при использовании <span class="math notranslate nohighlight">\(Y_i, \, i = 1 \, \ldots \, N_c,\)</span> в качестве основных переменных положение стационарных точек функции TPD будет определяться следующей системой нелинейных уравнений:</p>
<div class="math notranslate nohighlight">
\[ g_i = \ln Y_i + \ln \phi_i \left( \mathbf{y} \right) - h_i = 0, \; i = 1 \, \ldots \, N_c. \]</div>
<p>При этом в работе [<a class="reference external" href="https://doi.org/10.1016/0378-3812(82)85001-2">Michelsen, 1982</a>] было предложено использовать вместо функции TPD ее модификацию:</p>
<div class="math notranslate nohighlight">
\[ \bar{D}^* \left( \mathbf{Y} \right) = 1 + \sum_{i=1}^{N_c} Y_i \left( \ln Y_i + \ln \phi_i \left( \mathbf{y} \right) - h_i - 1 \right). \]</div>
<p>Докажем, что замена функции <span class="math notranslate nohighlight">\(\bar{D} \left( \mathbf{y} \right)\)</span> на модифицированную <span class="math notranslate nohighlight">\(\bar{D}^* \left( \mathbf{Y} \right)\)</span> является допустимой для рассматриваемой задачи проверки стабильности фазового состояния.</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="note admonition">
<p class="admonition-title">Дополнительно</p>
<p>Используя <a class="reference internal" href="../1-TD/TD-12-GibbsDuhemEquation.html"><span class="std std-doc">уравнение Гиббса-Дюгема</span></a> при постоянных (фиксированных) давлении и температуре, получим:</p>
<div class="math notranslate nohighlight">
\[ \sum_{i=1}^{N_c} n_i d \mu_i = 0. \]</div>
<p>С учетом <a class="reference internal" href="../1-TD/TD-15-Fugacity.html"><span class="std std-doc">соотношения</span></a> между дифференциалом химического потенциала <span class="math notranslate nohighlight">\(i\)</span>-го компонента и дифференциалом логарифма его летучести данное равенство преобразуется следующим образом:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align}
\sum_{i=1}^{N_c} n_i RT d \ln f_i = 0, \\
\sum_{i=1}^{N_c} n_i d \ln f_i = 0.
\end{align} \end{split}\]</div>
<p>Разделив левую и правую части на <span class="math notranslate nohighlight">\(\partial n_j, \, j = 1 \, \ldots \, N_c,\)</span>, получим:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align}
&amp; \sum_{i=1}^{N_c} n_i \frac{\partial \ln f_i}{\partial n_j} = 0, \\
&amp; j = 1 \, \ldots \, N_c.
\end{align} \end{split}\]</div>
<p>Далее воспользуемся соотношением между частными производными логарифма летучести и логарифма коэффициента летучести, полученным <a class="reference internal" href="#../2-EOS/EOS/Appendix-A-PD.md"><span class="xref myst">ранее</span></a>:</p>
<div class="math notranslate nohighlight">
\[ \frac{\partial \ln f_i}{\partial n_j}  = \frac{\partial \ln \phi_i}{\partial n_j} + \frac{\delta_{ij}}{n_i} - \frac{1}{n}. \]</div>
<p>Подставив данное выражение в уравнение Гиббса-Дюгема и выполнив некоторые преобразования, получим:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align}
&amp; \sum_{i=1}^{N_c} n_i \frac{\partial \ln \phi_i}{\partial n_j} = 0, \\
&amp; j = 1 \, \ldots \, N_c.
\end{align} \end{split}\]</div>
</div>
</aside>
<div class="proof admonition">
<p class="admonition-title">Доказательство</p>
<p>В рамках решения задачи стабильности многокомпонентной системы, сводимой к решению задачи поиска локальных минимумов функции TPD и проверки ее значений в них, замена функции TPD возможна при условии одинаковости положения (координат) стационарных точек и знака функции в них. Для проверки соответствия положения стационарных точек модифицированной функции TPD получим систему уравнений, характеризующую их координаты, которая определяется равенством нулю частных производных функции по основным переменным:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align}
\frac{\partial \bar{D}^*}{\partial Y_j}
&amp;= \frac{\partial}{\partial Y_j} \left( 1 + \sum_{i=1}^{N_c} Y_i \left( \ln Y_i + \ln \phi_i \left( \mathbf{y} \right) - h_i - 1 \right) \right) \\
&amp;= \sum_{i=1}^{N_c} \frac{\partial Y_i}{\partial Y_j} \left( \ln Y_i + \ln \phi_i \left( \mathbf{y} \right) - h_i - 1 \right) + \sum_{i=1}^{N_c} Y_i \left( \frac{\partial \ln Y_i}{\partial Y_j} + \frac{\partial \ln \phi_i \left( \mathbf{y} \right)}{\partial Y_j} \right) \\
&amp;= \sum_{i=1}^{N_c} \delta_{ij} \left( \ln Y_i + \ln \phi_i \left( \mathbf{y} \right) - h_i - 1 \right) + \sum_{i=1}^{N_c} Y_i \left( \frac{1}{Y_i} \delta_{ij} + \frac{\partial \ln \phi_i \left( \mathbf{y} \right)}{\partial Y_j} \right) \\
&amp;= \ln Y_j + \ln \phi_j \left( \mathbf{y} \right) - h_j - 1 + \sum_{i=1}^{N_c} \delta_{ij} + \sum_{i=1}^{N_c} Y_i \frac{\partial \ln \phi_i \left( \mathbf{y} \right)}{\partial Y_j} \\
&amp;= \ln Y_j + \ln \phi_j \left( \mathbf{y} \right) - h_j, \; j = 1 \, \ldots \, N_c.
\end{align} \end{split}\]</div>
<p>При выводе данного выражения использовалось <a class="reference internal" href="../1-TD/TD-12-GibbsDuhemEquation.html"><span class="std std-doc">уравнение Гиббса-Дюгема</span></a>.</p>
<p>Таким образом, положение стационарных точек исходной и модифицированной функций TPD определяется одной и той же системой нелинейных уравнений. Получим выражение для модифицированной функции TPD в стационарных точках, в которых значения частных производных функции по основным переменным равны нулю:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align}
\bar{D}^*_{sp}
&amp;= 1 + \sum_{i=1}^{N_c} Y_i \left( \ln Y_i + \ln \phi_i \left( \mathbf{y} \right) - h_i - 1 \right) \\
&amp;= 1 - \sum_{i=1}^{N_c} Y_i + \sum_{i=1}^{N_c} Y_i \left( \ln Y_i + \ln \phi_i \left( \mathbf{y} \right) - h_i \right) \\
&amp;= 1 - \sum_{i=1}^{N_c} Y_i \\
&amp;= 1 - \exp \left( -\bar{K} \right) \\
&amp;= 1 - \exp \left( -\bar{D}_{sp} \right).
\end{align} \end{split}\]</div>
<p>Таким образом, при <span class="math notranslate nohighlight">\(\bar{D}_{sp} \geq 0\)</span> значения модифицированной функции TPD в стационарных точках также <span class="math notranslate nohighlight">\(D^*_{sp} \geq 0\)</span>. Если же <span class="math notranslate nohighlight">\(\bar{D}_{sp} &lt; 0\)</span>, то и <span class="math notranslate nohighlight">\(D^*_{sp} &lt; 0\)</span>. То есть модифицированная функция TPD имеет идентичные положения стационарных точек, как и исходная функция TPD, а также сохраняет знак в этих точках. Следовательно, в рамках задачи определения стабильности многокомпонентной системы замена функции TPD <span class="math notranslate nohighlight">\(\bar{D} \left( \mathbf{Y} \right)\)</span> на модифицированную <span class="math notranslate nohighlight">\(\bar{D}^* \left( \mathbf{Y} \right)\)</span> допустима.</p>
</div>
<p>Задачу минимизации функции TPD можно решать, используя метод Ньютона, являющийся алгоритмом второго порядка, то есть характеризующийся более быстрой сходимостью, по сравнению с рассмотренным ранее методом последовательных подстановок, относящимся к алгоритмам первого порядка. Для использования метода Ньютона необходимо получить аналитические выражения для вторых частных производных модифицированной функции TPD по основным переменным, формирующих матрицу гессиана <span class="math notranslate nohighlight">\(\mathbf{H} \in {\rm I\!R}^{N_c \times N_c}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align}
H_{ij}
&amp;= \frac{\partial^2 \bar{D}^*}{\partial Y_i \partial Y_j} \\
&amp;= \frac{\partial}{\partial Y_j} \left( \frac{\partial \bar{D}^*}{\partial Y_i} \right) \\
&amp;= \frac{\partial}{\partial Y_j} \left( \ln Y_i + \ln \phi_i - h_i \right) \\
&amp;= \frac{\delta_{ij}}{Y_i} + \frac{\partial \ln \phi_i}{\partial Y_j}, \; i = 1 \, \ldots \, N_c, \; j = 1 \, \ldots \, N_c.
\end{align} \end{split}\]</div>
<p>Аналитические выражения частных производных логарифма коэффициента летучести с использованием уравнений состояния были получены <a class="reference internal" href="#../2-EOS/EOS/Appendix-A-PD.md"><span class="xref myst">ранее</span></a>.</p>
<p>При этом задача минимизации модифицированной функции <span class="math notranslate nohighlight">\(\bar{D}^* \left( \mathbf{Y} \right)\)</span> по-прежнему является условной, поскольку должны рассматриваться значения вектора <span class="math notranslate nohighlight">\(\mathbf{Y}\)</span> имеющие физический смысл, то есть <span class="math notranslate nohighlight">\(Y_i &gt; 0, \, i = 1 \, \ldots \, N_c\)</span>. Для исключения данного условия автором работы [<a class="reference external" href="https://doi.org/10.1016/0378-3812(82)85001-2">Michelsen, 1982</a>] было предложено ввести следующую замену основных переменных:</p>
<div class="math notranslate nohighlight">
\[ \alpha_i = 2 \sqrt{Y_i}, \; i = 1 \, \ldots \, N_c. \]</div>
<p>В этом случае значения вектора <span class="math notranslate nohighlight">\(\mathbf{Y}\)</span> всегда будут неотрицательными, поскольку <span class="math notranslate nohighlight">\(Y_i = \alpha_i^2 \, / \, 4, \, i = 1 \, \ldots \, N_c\)</span>. При использовании <span class="math notranslate nohighlight">\(\alpha_i, \, i = 1 \, \ldots \, N_c,\)</span> в качестве основных переменных положения стационарных точек модифицированной функции TPD будут определяться равенством нулю частных производных функции по основным переменным:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align}
\frac{\partial \bar{D}^*}{\partial \alpha_j}
&amp;= \frac{\partial \bar{D}^*}{\partial Y_j} \frac{\partial Y_j}{\partial \alpha_j} \\
&amp;= \left( \ln Y_j + \ln \phi_j \left( \mathbf{y} \right) - h_j \right) \frac{\partial}{\partial \alpha_j} \left( \frac{\alpha_j^2}{4} \right) \\
&amp;= \left( \ln Y_j + \ln \phi_j \left( \mathbf{y} \right) - h_j \right) \frac{\alpha_j}{2} \\
&amp;= \sqrt{Y_j} \left( \ln Y_j + \ln \phi_j \left( \mathbf{y} \right) - h_j \right), \; j = 1 \, \ldots \, N_c.
\end{align} \end{split}\]</div>
<p>При этом изменится и аналитическое выражение элемента матрицы гессиана при использовании <span class="math notranslate nohighlight">\(\alpha_i, \, i = 1 \, \ldots \, N_c,\)</span> в качестве основных переменных:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align}
\frac{\partial^2 \bar{D}^*}{\partial \alpha_j \partial \alpha_k}
&amp;= \frac{\partial \bar{D}^*}{\partial \alpha_k} \left( \frac{\partial \bar{D}^*}{\partial \alpha_j} \right) \\
&amp;= \frac{\partial \bar{D}^*}{\partial \alpha_k} \left( \sqrt{Y_j} \left( \ln Y_j + \ln \phi_j - h_j \right) \right) \\
&amp;= \left( \ln Y_j + \ln \phi_j - h_j \right) \frac{\partial \sqrt{Y_j}}{\partial \alpha_k} + \sqrt{Y_j} \frac{\partial}{\partial \alpha_k} \left( \ln Y_j + \ln \phi_j - h_j \right) \\
&amp;= \left( \ln Y_j + \ln \phi_j - h_j \right) \frac{1}{2 Y_j} \frac{\partial Y_j}{\alpha_k} + \sqrt{Y_j} \frac{\partial}{\partial Y_k} \left( \ln Y_j + \ln \phi_j - h_j \right) \frac{\partial Y_k}{\partial \alpha_k} \\
&amp;= \frac{1}{2} \delta_{jk} \left( \ln Y_j + \ln \phi_j - h_j \right) + \sqrt{Y_j} \left( \frac{\delta_{jk}}{Y_j} + \frac{\partial \ln \phi_j}{\partial Y_k} \right) \\
&amp;= \frac{1}{2} \delta_{jk} \left( \ln Y_j + \ln \phi_j - h_j \right) + \frac{\sqrt{Y_j Y_k} \delta_{jk}}{Y_j} + \sqrt{Y_j Y_k} \frac{\partial \ln \phi_j}{\partial Y_k} \\
&amp;= \frac{1}{2} \delta_{jk} \left( \ln Y_j + \ln \phi_j - h_j \right) + \delta_{jk} + \sqrt{Y_j Y_k} \frac{\partial \ln \phi_j}{\partial Y_k}, \; j = 1 \, \ldots \, N_c, \; k = 1 \, \ldots \, N_c.
\end{align} \end{split}\]</div>
<p>В процессе получения данного выражения было использовано следующее соотношение: <span class="math notranslate nohighlight">\(\sqrt{Y_j Y_k} \delta_{jk} = Y_j \delta_{jk}, \, j = 1 \, \ldots \, N_c, \, k = 1 \, \ldots \, N_c\)</span>. То есть в результате поэлементного произведения некоторой матрицы с единичной матрицей получится диагональная матрица с элементами, соответствующими главной диагонали умножаемой матрицы.</p>
<p>При использовании метода Ньютона для решения задачи оптимизации обновление основных переменных <span class="math notranslate nohighlight">\(\alpha_i, \, i = 1 \, \ldots \, N_c,\)</span> на <span class="math notranslate nohighlight">\(\left( k+1 \right)\)</span>-й итерации осуществляется с использованием следующего выражения:</p>
<div class="math notranslate nohighlight">
\[ \boldsymbol{\alpha}^{k+1} = \boldsymbol{\alpha}^{k} + \Delta \boldsymbol{\alpha}^{k}, \]</div>
<p>где вектор <span class="math notranslate nohighlight">\(\Delta \boldsymbol{\alpha}^{k} \in {\rm I\!R}^{N_c}\)</span> определяется при решении системы линейных уравнений:</p>
<div class="math notranslate nohighlight">
\[ \mathbf{H}^{k} \Delta \boldsymbol{\alpha}^{k} = - \mathbf{g}^{k}. \]</div>
<p>Таким образом, алгоритм определения стабильности фазового состояния с использованием метода Ньютона можно представить следующим образом:</p>
<div class="algorithm admonition">
<p class="admonition-title">Алгоритм. Анализ стабильности с использованием метода Ньютона</p>
<p><strong>Дано:</strong> Вектор компонентного состава исследуемой системы <span class="math notranslate nohighlight">\(\mathbf{z} \in {\rm I\!R}^{N_c}\)</span>; термобарические условия <span class="math notranslate nohighlight">\(P\)</span> и <span class="math notranslate nohighlight">\(T\)</span>; необходимые свойства компонентов для нахождения коэффициентов летучести компонентов с использованием уравнения состояния; максимальное число итераций <span class="math notranslate nohighlight">\(N_{iter}\)</span>; точность решения системы нелинейных уравнений <span class="math notranslate nohighlight">\(\epsilon_1\)</span>; численная погрешность расчета <span class="math notranslate nohighlight">\(0 &lt; \epsilon_2 \leq 10^{-4}\)</span>.</p>
<p><strong>Определить:</strong> Является ли однофазное состояние системы с компонентным составом <span class="math notranslate nohighlight">\(\mathbf{z}\)</span> при давлении <span class="math notranslate nohighlight">\(P\)</span> и температуре <span class="math notranslate nohighlight">\(T\)</span> стабильным.</p>
<p><strong>Псевдокод:</strong><br />
<strong>def</strong> <span class="math notranslate nohighlight">\(\phi \left( \mathbf{y} \in {\rm I\!R}^{N_c}, \, \ldots \right) \rightarrow \boldsymbol{\varphi} \in {\rm I\!R}^{N_c}, \, \mathbf{\Phi} \in {\rm I\!R}^{N_c \times N_c}\)</span> <span class="multilinecomment"># Функция, возвращающая вектор коэффициентов летучести и матрицу их частных производных по количеству вещества компонентов</span><br />
<span class="math notranslate nohighlight">\(\mathbf{K} := \left\{ \mathbf{k}_0, \, \mathbf{k}_1, \, \ldots, \, \mathbf{k}_N \right\}\)</span><br />
<span class="math notranslate nohighlight">\(\mathbf{h} := \ln \phi \left( \mathbf{z} \right) + \ln \mathbf{z}\)</span><br />
<strong>for</strong> <span class="math notranslate nohighlight">\(i := 1\)</span> <strong>to</strong> <span class="math notranslate nohighlight">\(N\)</span> <strong>do</strong><br />
 <span class="math notranslate nohighlight">\(\mathbf{k} := \mathbf{K}\left[ i \right]\)</span><br />
 <span class="math notranslate nohighlight">\(\mathbf{n} := \mathbf{k} \cdot \mathbf{z}\)</span><br />
 <span class="math notranslate nohighlight">\(\boldsymbol{\alpha} := 2 \sqrt{\mathbf{n}}\)</span> <span class="comment"># Вектор основных переменных</span><br />
 <span class="math notranslate nohighlight">\(\mathbf{y} := \mathbf{n} \, / \, \sum_{i=1}^{N_c} n_i\)</span><br />
 <span class="math notranslate nohighlight">\(\boldsymbol{\varphi}, \, \mathbf{\Phi} := \phi \left( \mathbf{y} \right)\)</span> <span class="comment"># Расчет вектора коэффициентов летучести и матрицы их частных производных</span><br />
 <span class="math notranslate nohighlight">\(\mathbf{g} := \sqrt{\mathbf{n}} \cdot \left(\ln \mathbf{n} + \ln \boldsymbol{\varphi} - \mathbf{h} \right)\)</span> <span class="comment"># Вектор невязок</span><br />
 <span class="math notranslate nohighlight">\(c := 1\)</span><br />
 <strong>while</strong> <span class="math notranslate nohighlight">\(\lVert \mathbf{g} \rVert_2 &gt; \epsilon_1\)</span> <strong>and</strong> <span class="math notranslate nohighlight">\(c &lt; N_{iter}\)</span> <strong>do</strong><br />
  <span class="math notranslate nohighlight">\(\mathbf{H} := \mathrm{diag} \left( {\frac{1}{2} \mathbf{g} }\right) + \mathbf{I} + \sqrt{\mathbf{n} \mathbf{n}^\top} \cdot \mathbf{\Phi}\)</span> <span class="comment"># Гессиан</span><br />
  <span class="math notranslate nohighlight">\(\Delta \boldsymbol{\alpha} := -\mathbf{H}^{-1} \mathbf{g}\)</span> <span class="comment"># Вектор изменения основных переменных</span><br />
  <span class="math notranslate nohighlight">\(\boldsymbol{\alpha} := \boldsymbol{\alpha} + \Delta \boldsymbol{\alpha}\)</span> <span class="comment"># Обновление вектора основных переменных</span><br />
  <span class="math notranslate nohighlight">\(\mathbf{n} := \boldsymbol{\alpha} \cdot \boldsymbol{\alpha} \, / \, 4\)</span><br />
  <span class="math notranslate nohighlight">\(\mathbf{y} := \mathbf{n} \, / \, \sum_{i=1}^{N_c} n_i\)</span><br />
  <span class="math notranslate nohighlight">\(\boldsymbol{\varphi}, \, \mathbf{\Phi} := \phi \left( \mathbf{y} \right)\)</span> <span class="comment"># Вектор коэффициентов летучести и матрица их частных производных</span><br />
  <span class="math notranslate nohighlight">\(\mathbf{g} := \sqrt{\mathbf{n}} \cdot \left(\ln \mathbf{n} + \ln \boldsymbol{\varphi} - \mathbf{h} \right)\)</span> <span class="comment"># Вектор невязок</span><br />
  <span class="math notranslate nohighlight">\(c := c + 1\)</span><br />
 <strong>end while</strong><br />
 <span class="math notranslate nohighlight">\(TPD := - \ln \sum_{i=1}^{N_c} n_i\)</span><br />
 <strong>if</strong> <span class="math notranslate nohighlight">\(\lVert \mathbf{g} \rVert_2 &lt; \epsilon_1\)</span> <strong>and</strong> <span class="math notranslate nohighlight">\(TPD &lt; -\epsilon_2\)</span> <strong>then</strong><br />
  <span class="math notranslate nohighlight">\(is\_stable := \mathrm{False}\)</span><br />
  <strong>exit for</strong><br />
 <strong>else</strong><br />
  <strong>continue</strong><br />
 <strong>end if</strong><br />
<strong>else</strong><br />
 <span class="math notranslate nohighlight">\(is\_stable := \mathrm{True}\)</span><br />
<strong>end for</strong></p>
</div>
<section id="pvt-sec-stability-pt-newton-init">
<span id="id8"></span><h4>Начальные приближения<a class="headerlink" href="#pvt-sec-stability-pt-newton-init" title="Link to this heading">#</a></h4>
<p>Начальные значения вектора <span class="math notranslate nohighlight">\(\alpha_i, \, i = 1 \, \ldots \, N_c,\)</span> при использовании метода Ньютона для минимизации функции TPD могут быть получены аналогично способу, рассмотренному <a class="reference internal" href="#pvt-sec-stability-pt-ss-init"><span class="std std-ref">ранее</span></a> для метода последовательных подстановок. Однако поскольку метод Ньютона является алгоритмом второго порядка, то <a class="reference external" href="https://en.wikipedia.org/wiki/Fixed-point_iteration#Iterative_methods">обычно является менее стабильным</a> по сравнению с алгоритмами первого порядка для не полностью выпуклых функций. В связи с этим начальные приближения вектора основных переменных для метода Ньютона, рассчитанные с использованием корреляции Уилсона или другим способом, могут быть уточнены в ходе нескольких итераций метода последовательных подстановок. При этом, например, в работе [<a class="reference external" href="https://doi.org/10.1002/aic.10908">Hoteit and Firoozabadi, 2006</a>] количество итераций метода последовательных подстановок перед переключением на метод Ньютона для анализа стабильности определялось следующим условием:</p>
<div class="math notranslate nohighlight">
\[ \lVert \mathbf{g} \rVert_2 &gt; \epsilon_{ssi}, \]</div>
<p>где <span class="math notranslate nohighlight">\(\lVert \mathbf{g} \rVert_2\)</span> – длина вектора невязки, а <span class="math notranslate nohighlight">\(\epsilon_{ssi} = 10^{-2}\)</span>. Несколько отличное значение параметра <span class="math notranslate nohighlight">\(\epsilon_{ssi} = 10^{-1}\)</span> было получено авторами работы [<a class="reference external" href="https://doi.org/10.1021/acs.iecr.8b05229">Pan et al, 2019</a>] при сравнении среднего времени работы алгоритма проверки стабильности на исследуемой выборке термодинамических систем.</p>
<p>Стоит также отметить, что для повышения стабильности (<em>robustness</em>) метода Ньютона, особенно в тех случаях, когда начальное приближение неидеально, может быть реализовано переключение итерации на метод последовательных подстановок [<a class="reference external" href="https://doi.org/10.1016/j.fluid.2016.01.015">Nichita, 2016</a>] или на метод оптимизации с доверительной областью [<a class="reference external" href="https://doi.org/10.1016/j.fluid.2013.08.039">Petitfrere and Nichita, 2014</a>; <a class="reference external" href="https://doi.org/10.1021/acs.iecr.8b05229">Pan et al, 2019</a>]. В качестве критерия переключения можно рассматривать увеличение длины вектора градиента оптимизируемой функции (длины вектора невязки решаемой системы нелинейных уравнений) или увеличение значения минимизируемой функции.</p>
</section>
<section id="pvt-sec-stability-pt-newton-examples">
<span id="id9"></span><h4>Примеры<a class="headerlink" href="#pvt-sec-stability-pt-newton-examples" title="Link to this heading">#</a></h4>
<p>Рассмотрим применение метода Ньютона для определения стабильности однофазного состояния следующей системы:</p>
<div class="exercise admonition">
<p class="admonition-title">Пример</p>
<p>Пусть имеется <span class="math notranslate nohighlight">\(1 \; моль\)</span> смеси следующего мольного состава:</p>
<div class="pst-scrollable-table-container"><table class="table" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Компонент</p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(\mathrm{CH_4}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(\mathrm{C_2 H_6}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(\mathrm{C_3 H_8}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(\mathrm{n \mbox{-} C_4}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(\mathrm{C_{5+}}\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>Мольная доля</p></td>
<td class="text-center"><p>0.7167</p></td>
<td class="text-center"><p>0.0895</p></td>
<td class="text-center"><p>0.0917</p></td>
<td class="text-center"><p>0.0448</p></td>
<td class="text-center"><p>0.0573</p></td>
</tr>
</tbody>
</table>
</div>
<br>
<p>Необходимо определить является ли однофазное состояние стабильным при давлении <span class="math notranslate nohighlight">\(17 \; МПа\)</span> и температуре <span class="math notranslate nohighlight">\(68 \; ^{\circ} C\)</span>.</p>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Решение</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Зададим исходные термобарические условия и компонентный состав.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">17e6</span><span class="p">)</span> <span class="c1"># Pressure [Pa]</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">68.</span> <span class="o">+</span> <span class="mf">273.15</span><span class="p">)</span> <span class="c1"># Temperature [K]</span>
<span class="n">yi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.7167</span><span class="p">,</span> <span class="mf">0.0895</span><span class="p">,</span> <span class="mf">0.0917</span><span class="p">,</span> <span class="mf">0.0448</span><span class="p">,</span> <span class="mf">0.0573</span><span class="p">])</span> <span class="c1"># Mole fractions [fr.]</span>
</pre></div>
</div>
<p class="sd-card-text">Для выполнения вычислений будем использовать свойства компонентов и класс с уравнением состояния, заданные при рассмотрении предыдущего примера. Начальные приближения рассчитаем по корреляции Уилсона:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ki</span> <span class="o">=</span> <span class="n">Pci</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">5.3727</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">wi</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">Tci</span> <span class="o">/</span> <span class="n">T</span><span class="p">))</span> <span class="o">/</span> <span class="n">P</span> <span class="c1"># Wilson&#39;s correlation</span>
<span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">ki</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">ki</span><span class="p">])</span> <span class="c1"># Matrix of initial estimates</span>
</pre></div>
</div>
<p class="sd-card-text">Выполним расчет коэффициентов летучести для начального компонентного состава:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hi</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">getPT_lnphii</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">yi</span><span class="p">)</span>
</pre></div>
</div>
<p class="sd-card-text">Зададим максимальное число итераций <span class="math notranslate nohighlight">\(N_{iter}\)</span>, точность решения системы нелинейных уравнений <span class="math notranslate nohighlight">\(\epsilon_1\)</span>, численную погрешность расчета <span class="math notranslate nohighlight">\(\epsilon_2\)</span>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">maxiter</span> <span class="o">=</span> <span class="mi">20</span> <span class="c1"># Maximum number of iterations</span>
<span class="n">eps1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">1e-6</span><span class="p">)</span> <span class="c1"># Tolerance</span>
<span class="n">eps2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">1e-4</span><span class="p">)</span>
</pre></div>
</div>
<p class="sd-card-text">Создадим функцию, которая будет принимать на вход кортеж из результатов предыдущей итерации, точность и максимальное число итераций, и возвращать необходимость расчета следующей итерации цикла минимизации:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">condit_newt</span><span class="p">(</span><span class="n">carry</span><span class="p">,</span> <span class="n">tol</span><span class="p">,</span> <span class="n">maxiter</span><span class="p">):</span>
    <span class="n">k</span><span class="p">,</span> <span class="n">alphai</span><span class="p">,</span> <span class="n">gi</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">carry</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">k</span> <span class="o">&lt;</span> <span class="n">maxiter</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">gi</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">)</span>
</pre></div>
</div>
<p class="sd-card-text">Также создадим функцию, которая будет принимать на вход результаты предыдущей итерации в виде кортежа и рассчитывать результаты для новой итерации. Вектор изменения основных переменных будет определяться путем решения системы линейных уравнений с использованием <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.linalg.solve.html"><code class="docutils literal notranslate"><span class="pre">numpy.linalg.solve</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">update_newt</span><span class="p">(</span><span class="n">carry</span><span class="p">,</span> <span class="n">hi</span><span class="p">,</span> <span class="n">yi</span><span class="p">,</span> <span class="n">plnphi</span><span class="p">):</span>
    <span class="n">k</span><span class="p">,</span> <span class="n">alphai_k</span><span class="p">,</span> <span class="n">gi_k</span><span class="p">,</span> <span class="n">H_k</span> <span class="o">=</span> <span class="n">carry</span>
    <span class="n">dalphai_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">H_k</span><span class="p">,</span> <span class="o">-</span><span class="n">gi_k</span><span class="p">)</span>
    <span class="n">alphai_kp1</span> <span class="o">=</span> <span class="n">alphai_k</span> <span class="o">+</span> <span class="n">dalphai_k</span>
    <span class="n">sqrtni</span> <span class="o">=</span> <span class="n">alphai_kp1</span> <span class="o">*</span> <span class="mf">0.5</span>
    <span class="n">ni</span> <span class="o">=</span> <span class="n">sqrtni</span> <span class="o">*</span> <span class="n">sqrtni</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">ni</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">xi</span> <span class="o">=</span> <span class="n">ni</span> <span class="o">/</span> <span class="n">n</span>
    <span class="n">lnphixi</span><span class="p">,</span> <span class="n">Zx</span><span class="p">,</span> <span class="n">dlnphixidnj</span> <span class="o">=</span> <span class="n">plnphi</span><span class="p">(</span><span class="n">yi</span><span class="o">=</span><span class="n">xi</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
    <span class="n">gi_kp1</span> <span class="o">=</span> <span class="n">sqrtni</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">ni</span><span class="p">)</span> <span class="o">+</span> <span class="n">lnphixi</span> <span class="o">-</span> <span class="n">hi</span><span class="p">)</span>
    <span class="n">H_kp1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diagflat</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">gi_kp1</span> <span class="o">+</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">sqrtni</span><span class="p">[:,</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">sqrtni</span><span class="p">)</span> <span class="o">*</span> <span class="n">dlnphixidnj</span>
    <span class="k">return</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">alphai_kp1</span><span class="p">,</span> <span class="n">gi_kp1</span><span class="p">,</span> <span class="n">H_kp1</span>
</pre></div>
</div>
<p class="sd-card-text">Проинициализируем функции <code class="docutils literal notranslate"><span class="pre">condit</span></code> и <code class="docutils literal notranslate"><span class="pre">update</span></code>. Для расчета коэффициентов летучестей и их частных производных по количеству вещества компонентов будем использовать метод <code class="docutils literal notranslate"><span class="pre">getPT_lnphii_Z_dnj</span></code> инициализированного класса с уравнением состояния, принимающий в качестве аргументов давление (в Па), температуру (в K) и компонентный состав в виде одномерного массива (размерностью <code class="docutils literal notranslate"><span class="pre">(Nc,)</span></code>) и возвращающий кортеж с логарифмами коэффициентов летучести компонентов в виде одномерного массива такой же размерности, коэффициентом сверхсжимаемости заданного компонентного состава, а также с матрицей размерностью <code class="docutils literal notranslate"><span class="pre">(Nc,</span> <span class="pre">Nc)</span></code>, состоящей из значений частных производных логарифмов коэффициентов летучести компонентов по их количеству вещества:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pcondit</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">condit_newt</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">eps1</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="n">maxiter</span><span class="p">)</span>
<span class="n">pupdate</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">update_newt</span><span class="p">,</span> <span class="n">hi</span><span class="o">=</span><span class="n">hi</span><span class="p">,</span> <span class="n">yi</span><span class="o">=</span><span class="n">yi</span><span class="p">,</span> <span class="n">plnphi</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">pr</span><span class="o">.</span><span class="n">getPT_lnphii_Z_dnj</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">))</span>
</pre></div>
</div>
<p class="sd-card-text">Выполним расчет функции TPD для различных начальных приближений:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ki</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
    <span class="n">ni</span> <span class="o">=</span> <span class="n">ki</span> <span class="o">*</span> <span class="n">yi</span>
    <span class="n">sqrtni</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ni</span><span class="p">)</span>
    <span class="n">alphai</span> <span class="o">=</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">sqrtni</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">ni</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">xi</span> <span class="o">=</span> <span class="n">ni</span> <span class="o">/</span> <span class="n">n</span>
    <span class="n">lnphixi</span><span class="p">,</span> <span class="n">Zx</span><span class="p">,</span> <span class="n">dlnphixidnj</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">getPT_lnphii_Z_dnj</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">gi</span> <span class="o">=</span> <span class="n">sqrtni</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">ni</span><span class="p">)</span> <span class="o">+</span> <span class="n">lnphixi</span> <span class="o">-</span> <span class="n">hi</span><span class="p">)</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diagflat</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">gi</span> <span class="o">+</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">sqrtni</span><span class="p">[:,</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">sqrtni</span><span class="p">)</span> <span class="o">*</span> <span class="n">dlnphixidnj</span>
    <span class="n">carry</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">alphai</span><span class="p">,</span> <span class="n">gi</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">pcondit</span><span class="p">(</span><span class="n">carry</span><span class="p">):</span>
        <span class="n">carry</span> <span class="o">=</span> <span class="n">pupdate</span><span class="p">(</span><span class="n">carry</span><span class="p">)</span>
    <span class="n">c</span><span class="p">,</span> <span class="n">alphai</span><span class="p">,</span> <span class="n">gi</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">carry</span>
    <span class="n">ni</span> <span class="o">=</span> <span class="n">alphai</span> <span class="o">*</span> <span class="n">alphai</span> <span class="o">*</span> <span class="mf">0.25</span>
    <span class="n">TPD</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">ni</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
    <span class="n">gnorm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">gi</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;For the initial guess #</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">:</span><span class="se">\n</span><span class="s1">&#39;</span>
          <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">tolerance of equations: </span><span class="si">{</span><span class="n">gnorm</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
          <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">number of iterations: </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
          <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">k-values: </span><span class="si">{</span><span class="n">ni</span><span class="o">/</span><span class="n">yi</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
          <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">TPD: </span><span class="si">{</span><span class="n">TPD</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">gnorm</span> <span class="o">&lt;</span> <span class="n">eps1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">TPD</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">eps2</span><span class="p">):</span>
        <span class="n">is_stable</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">break</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">is_stable</span> <span class="o">=</span> <span class="kc">True</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The system is stable: </span><span class="si">{</span><span class="n">is_stable</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="output text_html">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre id="codecell20" tabindex="0"><span></span>For the initial guess #0:<br>	tolerance of equations: 5.5417348647642805e-08<br>	number of iterations: 10<br>	k-values: [1.00000053 0.99999975 0.99999916 0.99999856 0.99999652]<br>	TPD: -1.615439879917523e-08<br>For the initial guess #1:<br>	tolerance of equations: 1.7727191726099974e-10<br>	number of iterations: 14<br>	k-values: [0.79433382 1.03491309 1.25365184 1.51437505 2.73405577]<br>	TPD: -0.0013880767813186329<br>The system is stable: False
</pre><button class="copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#codecell20">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#000000" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <title>Copy to clipboard</title>
  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
  <rect x="8" y="8" width="12" height="12" rx="2"></rect>
  <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path>
</svg>
    </button></div>
</div>
</div><p class="sd-card-text">По результатам расчетов можно отметить, что подход к определению стабильности фазового состояния системы, основанный на минимизации функции TPD с использованием метода Ньютона, позволяет существенно снизить количество итераций по сравнению методом последовательных подстановок.</p>
</div>
</details><p>В данном примере начальные приближения рассчитывались с использованием корреляции Уилсона. Пример реализации алгоритма определения стабильности фазового состояния системы, основанного на применении метода последовательных подстановок для уточнения начальных приближений, представлен <a class="reference external" href="https://github.com/DanielSkorov/ReservoirSimulation/blob/main/_src/stability.py">здесь</a>.</p>
<p>Кроме того, важно отметить, что метод Ньютона для оптимизации функции нескольких переменных <a class="reference internal" href="../../0-Math/1-OM/OM-0-Introduction.html"><span class="std std-doc">сходится к ее локальному минимуму</span></a>, если матрица гессиана является <a class="reference internal" href="../../0-Math/0-LAB/LAB-8-MatrixDefiniteness.html"><span class="std std-doc">положительно определенной матрицей</span></a>, то есть если функция является выпуклой для всех значений вектора основных переменных, что в общем не свойственно для рассматриваемой модифицированной функции TPD, за исключением локальных областей вблизи стационарных точек, что обуславливает и подтверждает необходимость наличия хорошего начального приближения. Однако на практике начальные приближения не гарантируют положительную определенность матрицы гессиана в этой точке. Для решения этой проблемы могут применяться различные подходы. Одним из таких является использование модифицированного разложения Шолески для нахождения вектора изменения основных переменных, позволяющего определить такую диагональную матрицу <span class="math notranslate nohighlight">\(\mathbf{E}\)</span>, элементы которой не на много больше, чем необходимо, чтобы матрица <span class="math notranslate nohighlight">\(\hat{\mathbf{H}}\)</span>, определяемая выражением:</p>
<div class="math notranslate nohighlight">
\[ \hat{\mathbf{H}} = \mathbf{H} + \mathbf{E}, \]</div>
<p>являлась положительно определенной матрицей. Примеры алгоритмов модифицированного разложения Шолески рассмотрены в работах [<a class="reference external" href="https://doi.org/10.1137/0911064">Schnabel and Eskow, 1990</a>] и [<a class="reference external" href="https://doi.org/10.1137/S105262349833266X">Schnabel and Eskow, 1999</a>].</p>
<p>Другим подходом к решению данной проблемы является использование аппроксимации гессиана на основе результатов предыдущих итераций, которая гарантирует положительную определенность. Такой подход лежит в основе квази-ньютоновских методов оптимизации, к которым относится, например, метод <a class="reference external" href="https://en.wikipedia.org/wiki/Broyden%E2%80%93Fletcher%E2%80%93Goldfarb%E2%80%93Shanno_algorithm">BFGS</a>. Применение данного метода к определению стабильности фазового состояния системы было рассмотрено в работе [<a class="reference external" href="https://doi.org/10.1016/0378-3812(82)85001-2">Michelsen, 1982</a>]. Впоследствии применение метода BFGS для решения данной задачи получило свое развитие в работах [<a class="reference external" href="https://doi.org/10.1002/aic.10908">Hoteit and Firoozabadi, 2006</a>; <a class="reference external" href="https://doi.org/10.1016/j.fluid.2015.07.035">Nichita and Petitfrere, 2015</a>].</p>
<p>Кроме того, коррекция гессиана для обеспечения его положительной определенности реализуется при использовании методов оптимизации с доверительной областью [<a class="reference external" href="https://doi.org/10.1016/j.fluid.2013.08.039">Petitfrere and Nichita, 2014</a>].</p>
</section>
</section>
</section>
<section id="vt">
<span id="pvt-sec-stability-vt"></span><h2>VT-термодинамика<a class="headerlink" href="#vt" title="Link to this heading">#</a></h2>
<p>Таким образом, в данном разделе были получены критерии стабильности для различных формулировок, а также рассмотрены некоторые численные алгоритмы проверки стабильности фазового состояния. <a class="reference internal" href="SEC-2-RR.html"><span class="std std-doc">Следующие разделы</span></a> будут посвящены изучению уравнения Речфорда-Райса (уравнения фазовых концентраций).</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./1-PVT\3-SEC"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="SEC-0-Introduction.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Стабильность. Равновесие. Критическое состояние</p>
      </div>
    </a>
    <a class="right-next"
       href="SEC-2-RR.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Уравнение Речфорда-Райса</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pt">PT-термодинамика</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pvt-sec-stability-pt-theory">Теоретические основы анализа стабильности фазового состояния системы</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pvt-sec-stability-pt-num">Численный подход к проверке стабильности фазового состояния системы</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pvt-sec-stability-pt-ss">Метод последовательных подстановок</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pvt-sec-stability-pt-ss-init">Начальные приближения</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pvt-sec-stability-pt-ss-examples">Примеры</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pvt-sec-stability-pt-newton">Метод минимизации функции</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pvt-sec-stability-pt-newton-init">Начальные приближения</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pvt-sec-stability-pt-newton-examples">Примеры</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vt">VT-термодинамика</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Daniel Skorov
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022 – 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>