---
jupytext:
  text_representation:
    extension: .md
    format_name: myst
    format_version: 0.13
    jupytext_version: 1.10.3
kernelspec:
  display_name: Python 3 (ipykernel)
  language: python
  name: python3
---

<a id='pvt-td-phase_equilibrium'></a>
# Свободная энергия и фазовое равновесие
Представим две системы, которые изолированы от окружающих систем, находящиеся в тепловом контакте. Эти системы будут обмениваться энергией до тех пор, пока не установится одинаковая температура в них ([нулевое начало термодинамики](TD-2-ThermalEquilibrium.html#pvt-td-thermal_equilibrium-zero_law)). Такой обмен энергии будет сопровождаться ростом энтропии всей изолированной системы ([второе начало термодинамики](TD-6-Entropy.html#pvt-td-entropy-second_law-entropy)). Верно и обратное: если энтропия изолированной системы в процессе релаксации увеличивается и достигает максимума, то такое состояние макросистемы является равновесным. С другой стороны, если рассматриваемая система не является изолированной, то есть она модет обмениваться энергием с некоторой окружающей средой, то энтропия такой системы в процессе релаксации может снизиться. В связи с этим необходимо расширить термодинамическое описание процесса релаксации на незакрытые системы. Для этого могут использоваться такие параметры, как энергия Гельмгольца и энергия Гиббса.

+++

## Определение равновесного состояния с точки зрения энергий Гельмгольца и Гиббса
[Ранее](TD-8-Helmholtz-Gibbs.html#pvt-td-helmholtz_gibbs-helmholtz) было показано, что для изотермического процесса с постоянным количеством частиц характерно следующее выражение:

$$ \Delta F \leq W. $$

Если рассматривать процесс, в котором не происходит передача энергии в виде работы, то

$$ \Delta F \leq 0. $$

```{admonition} NB
В процессе релаксации системы ее энергия Гельмгольца снижается до достижения равновесного состояния вне зависимости от окружающей среды.
```

Также [ранее](TD-8-Helmholtz-Gibbs.html#pvt-td-helmholtz_gibbs-gibbs) было показано, что если рассматриваемый процесс является изобарным и изотермическим, при этом количество частиц системы также не изменяется, то

$$ \Delta G \leq W'. $$

При этом, если рассматривать процесс, в котором не происходит передачи энергии в виде работы, за исключением механической (работы расширения / сжатия), то

$$ \Delta G \leq 0. $$

```{admonition} NB
В процессе релаксации свободная энергия Гиббса снижается до достижения равновесного состояния. То есть, если энергия Гиббса достигла своего минимума, то система пришла к равновесному состоянию.
```

<a id='pvt-td-phase_equilibrium-chemical_potential'></a>
## Фазовое равновесие
Полученное правило можно применить к фазовым переходам. Из сформулированного выше условия равновесия следует, что наиболее стабильное состояние системы при прочих равных условиях будет характеризоваться минимальным значением энергии Гиббса. Известно, что несколько фаз могут находиться в равновесии. Например, водяной пар с определенной сухостью, когда в равновесии находится и жидкая вода, и газообразная вода. Например, в процессе испарения при постоянных атмосферном давлении и температуре $100 \; \unicode{xB0} C$ воде сообщается некоторое количество энергии, что приводит к постепенному ее переходу в парообразное состояние. В процессе этого фазового перехода существует множество равновесных состояний двух фаз – воды и пара, при постоянных давлении и температуре. Верно и другое: существует множество пар значений давления и температуры, для которых характерно равновесное многофазное состояние. То есть эти значения давления и температуры определяют условия, при которых происходит переход вещества из одной фазы в другую. Пусть одна из этих фаз имеет индекс 1, а другая – 2. При фиксированных давлении и температуре **минимум энергии Гиббса** будет соответствовать состоянию, при котором будут равны химические потенциалы, поскольку [ранее](TD-10-MixtureGibbsEnergy.html#pvt-td-mixture_gibbs_energy) было показано, что при постоянных давлении и температуре энергия Гиббса $G = \mu N.$ То есть:

```{admonition} NB
Находящиеся в равновесии фазы характеризуются одинаковыми химическими потенциалами:
+++
$$\mu_1 \left(P, T \right) = \mu_2 \left(P, T \right).$$
+++
```

Данное выражение определяет геометрическое место точек, характеризующиеся давлением $P$ и температурой $T$, определяющих существование в равновесии нескольких фаз.

+++

<a id='pvt-td-phase_equilibrium-rule'></a>
Если рассматриваемая система состоит из нескольких компонентов, то энергия Гиббса такой системы определяется выражением $\sum_i \mu_i N_i$. Запишем условие многофазного равновесного состояния:

```{admonition} NB
Две многокомпонентные фазы находятся в равновесии, если химический потенциал каждого компонентов в одной фазе равен соответственно химическому потенциалу компонента в другой фазе:
+++
$${\mu_1}_i = {\mu_2}_i, \; i=1...N_c.$$
+++
```

$N_c$ – количество компонентов в системе.

+++

Рассмотрим некоторые фазовые диаграммы на примере воды. Для расчета свойств будет использоваться библиотека *[iapws](https://iapws.readthedocs.io/en/latest/)*, а для построения графиков – *[matplotlib](https://matplotlib.org)*. Первой построим PT-диаграмму.

+++

Ранее было показано, что две фазы системы, состоящей из одного компонента, находятся в равновесии, если равны их химические потенциалы. Следовательно, решая уравнение

$$ \mu_1 \left(P, T\right) - \mu_2 \left(P, T\right) = 0,$$

можно определить давление фазового перехода между жидкостью и паром. Разность химических потенциалов можно заменить разностью удельных [энергий Гиббса](TD-8-Helmholtz-Gibbs.html#pvt-td-helmholtz_gibbs-gibbs). Для решения данного нелинейного уравнения будет использоваться библиотека *[scipy](https://scipy.org/)*. Например, для температуры $500 \; K$ давление фазового перехода в $МПа$:

```{code-cell} python
from iapws import iapws97
from scipy.optimize import fsolve
liquid = lambda P, T: iapws97._Region1(T, P)['h'] - T * iapws97._Region1(T, P)['s']
steam = lambda P, T: iapws97._Region2(T, P)['h'] - T * iapws97._Region2(T, P)['s']
eq = lambda P, T: liquid(P, T) - steam(P, T)
fsolve(eq, 2.5, args=(500))[0]
```

Получим значения давлений фазового перехода для диапазона температур. В качестве начального приближения будет использоваться функция из библиотеки *[iapws](https://iapws.readthedocs.io/en/latest/)*.

```{code-cell} python
import numpy as np
TT = np.linspace(273.15, 647.096, 50)
PP_calc = []
for T in TT:
    PP_calc.append(fsolve(eq, iapws97._PSat_T(T), args=(T))[0])
```

Сравним расчетные значения давлений фазового перехода с табличными значениями из библиотеки *iapws*.

```{code-cell} python
:tags: [hide-input]

import numpy as np
from iapws import iapws97
from matplotlib import pyplot as plt
plt.rcParams.update({'figure.max_open_warning': False})
%matplotlib widget

PP_iapws = list(map(iapws97._PSat_T, TT))
fig, ax = plt.subplots(figsize=(6, 4))
fig.canvas.header_visible = False
ax.grid()
ax.set_xlabel('Температура, K')
ax.set_ylabel('Давление, МПа')
ax.set_xlim(TT[0], TT[-1])
ax.set_ylim(PP_calc[0], PP_calc[-1])
ax.text(350, 12.5, 'Жидкость', size=25, bbox=dict(boxstyle='round', ec=(0.1, 0.5, 0.5), fc=(0.1, 0.8, 0.8)))
ax.text(575, 2.5, 'Пар', size=25, bbox=dict(boxstyle='round', ec=(1., 0.5, 0.5), fc=(1., 0.8, 0.8)))
ax.plot(TT, PP_iapws, label='IAPWS97')
ax.plot(TT, PP_calc, '.', label='Расчет')
ax.legend(loc='best')

fig.tight_layout()
```

Действительно, из данной диаграммы видно, что на границе фазового перехода жидкость и пар характеризуются одинаковыми химическими потенциалами.

+++

PT-диаграмма позволяет определить давление и температуру фазового перехода – из жидкости в пар и наоборот. Стоит также отметить, что это лишь часть диаграммы, отражающее существование только двух фаз – жидкости и пара. Также вода может находиться в твердом агрегатном состоянии – лед. Такие значения давления и температуры, при которых находятся три фазы одновременно, характеризуют *тройной точкой*. Для воды давление и температура тройной точки равны соответственно $0.611 \; кПа$ и $273.15 \; K$. Также имеется еще одна характерная точка, называемая *критической*. В этой точке параметры двух фаз (жидкости и пара) становятся тождественны друг другу. Давление и температура в критической точке воды равны соответственно $22.064 \; МПа$ и $647.096 \; K$.

+++

Далее рассмотрим диаграмму "давление – удельный объем" для воды.

```{code-cell} python
:tags: [hide-input]

from iapws import IAPWS97

vol_px = lambda P, x: IAPWS97(P=P, x=x).v
PP_px = np.linspace(0.000612, 22.064, 100)
v_steam = []
v_water = []
v_025 = []
v_05 = []
v_075 = []
for P in PP_px:
    v_steam.append(vol_px(P, 1))
    v_water.append(vol_px(P, 0))
    v_025.append(vol_px(P, 0.25))
    v_05.append(vol_px(P, 0.5))
    v_075.append(vol_px(P, 0.75))
PP_pt = np.linspace(0.1, 30, 1000)
vol_pt = lambda P, T: IAPWS97(P=P, T=T).v
v_500 = []
v_600 = []
v_c = []
for P in PP_pt:
    v_500.append(vol_pt(P, 500))
    v_600.append(vol_pt(P, 600))
    v_c.append(vol_pt(P, TT[-1]))
fig, ax = plt.subplots(figsize=(6, 4))
fig.canvas.header_visible = False
ax.grid()
ax.set_xlabel('Удельный объем, м³/кг')
ax.set_ylabel('Давление, МПа')
ax.plot(v_water, PP_px, c='dodgerblue', label='Кривая насыщения')
ax.plot(v_025, PP_px, c='dodgerblue', ls='--', alpha=0.75, label='Сухость пара 0.25')
ax.plot(v_05, PP_px, c='dodgerblue', ls='--', alpha=0.5, label='Сухость пара 0.50')
ax.plot(v_075, PP_px, c='dodgerblue', ls='--', alpha=0.25, label='Сухость пара 0.75')
ax.plot(v_steam, PP_px, c='salmon', label='Кривая конденсации')
ax.plot(v_500, PP_pt, c='green', alpha=0.33, label='Изотерма T = 500 K')
ax.plot(v_600, PP_pt, c='green', alpha=0.67, label='Изотерма T = 600 K')
ax.plot(v_c, PP_pt, c='green', alpha=1.0, label='Изотерма T = 647.096 K')
ax.scatter(vol_px(22.064, x=1), 22.064, c='red', label='Критическая точка', zorder=3)
ax.set_xscale('log')
ax.legend(loc='best')

fig.tight_layout()
```

+++

<a id='pvt-td-phase_equilibrium-critical_point'></a>

```{prf:определение}
:nonumber:
***Кривая насыщения*** представляет собой геометрическое место точек, при которых в результате изотермического расширения происходит выделение первого пузырька газа.
```

```{prf:определение}
:nonumber:
***Кривой конденсации*** называется геометрическое место точек, при которых в результате изотермического сжатия происходит формирование первой капли жидкости.
```

В совокупности кривые насыщения и конденсации отделяют *двухфазную область* – область существования двух фаз (жидкости и пара) в термодинамическом равновесии. Под *сухостью пара* понимается массовая доля пара в рассматриваемой системе. Из определения критической точки (равенство параметров фаз) следует, что она находится в месте "соединения" кривых конденсации и насыщения. Рассмотрим поведение изотермы $T = T_c \approx 647.096 \; K.$ В критической точке изотерма имеет [точку перегиба](https://en.wikipedia.org/wiki/Inflection_point) (то есть вторая частная производная давления по удельному объему при постоянной температуре равна нулю), при этом, как для, например, кубической параболы, эта точка также является [стационарной](https://en.wikipedia.org/wiki/Stationary_point), то есть частная производная давления по удельному объему при постоянной температуре равна нулю.

```{admonition} NB
Критическая точка характеризуется следующим соотношением:
+++
$$ \left( \frac{\partial P}{\partial v} \right)_{T_c} = \left( \frac{\partial^2 P}{\partial v^2} \right)_{T_c} = 0.$$
+++
```

На практике также используют и другие диаграммы для однокомпонентных субстанций. Например, "давление – энтальпия", "температура – энтропия".
