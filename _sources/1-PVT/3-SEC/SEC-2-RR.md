---
jupytext:
  text_representation:
    extension: .md
    format_name: myst
    format_version: 3.0.1
    jupytext_version: 1.16.3
kernelspec:
  display_name: Python 3 (ipykernel)
  language: python
  name: python3
---

(pvt-esc-rr)=
# Уравнение Речфорда-Райса

Рассмотрим многофазную ($N_p$ – количество фаз) многокомпонентную ($N_c$ – количество компонентов) систему с количеством вещества в системе $n$. Количество вещества $i$-го компонента в системе обозначим $n_i, \, i = 1 \, \ldots \, N_c,$ причем сумма количеств вещества всех компонентов будет составлять количество вещества всей системы:

$$ \sum_{i=1}^{N_c} n_i = n. $$

Пусть количество вещества $j$-й фазы будет $n_j, \, j = 1 \, \ldots \, N_p,$ тогда сумма количеств вещества всех фаз также будет составлять количество вещества всей системы:

$$ \sum_{j=1}^{N_p} n_j = n. $$

````{margin}
```{admonition} Дополнительно
:class: note
При использовании двойного индексирования здесь и далее первый индекс будет обозначать фазу, второй – компонент. То есть под $n_{ji}$ следует понимать количество вещества $i$-го компонента в $j$-й фазе, а под, например, $y_{Rk}$ – мольную долю $k$-го компонента в $R$-й фазе. При использовании одинарного индексирования будет явно указано отношение данного элемента к вектору, характеризующему свойства фаз или компонентов.
```
````

Обозначим количество вещества $i$-го компонента в $j$-й фазе $n_{ji}, \, j = 1 \, \ldots \, N_p, \, i = 1 \, \ldots \, N_c,$ следовательно:

$$ \begin{align}
\sum_{i=1}^{N_c} n_{ji} &= n_j, \; j = 1 \, \ldots \, N_p, \\
\sum_{j=1}^{N_p} n_{ji} &= n_i, \; i = 1 \, \ldots \, N_c, \\
\sum_{i=1}^{N_c} \sum_{j=1}^{N_p} n_{ji} &= n.
\end{align} $$

Пусть мольная доля $i$-го компонента в системе в целом обозначается $y_i, \, i = 1 \, \ldots \, N_c,$ и характеризует отношение количества вещества $i$-го компонента к количеству вещества всей системы, то есть:

$$ y_i = \frac{n_i}{n}, \; i = 1 \, \ldots \, N_c. $$

Причем,

$$ \sum_{i=1}^{N_c} y_i = 1. $$

Пусть мольная доля $j$-й фазы в системе обозначается $f_j, \, j = 1 \, \ldots \, N_p,$ и соответствует следующему выражению:

$$ f_j = \frac{n_j}{n}, \; j = 1 \, \ldots \, N_p. $$

То есть мольная доля $j$-й фазы характеризует отношение количества вещества $j$-й фазы к количеству вещества всей систеы. При этом

$$ \sum_{j=1}^{N_p} f_j = 1. $$

Пусть мольная доля $i$-го компонента в $j$-й фазе обозначается $y_{ji}, \, j = 1 \, \ldots \, N_p, \, i = 1 \, \ldots \, N_c,$ и характеризует отношение количества вещества $i$-го компонента в $j$-й фазе к количеству вещества $j$-й фазы. Математически это записывается следующим образом:

$$ y_{ji} = \frac{n_{ji}}{n_j}, \; j = 1 \, \ldots \, N_p, \; i = 1 \, \ldots \, N_c. $$

Причем,

$$ \sum_{i=1}^{N_c} y_{ji} = 1, \; j = 1 \, \ldots \, N_p. $$

Введем понятие константы фазового равновесия (*k-value*):

```{admonition} Определение
:class: tip
***Константа фазового равновесия*** $i$-го компонента (коэффициент распределения) характеризует отношение мольной доли компонента в фазе $j$ к мольной доли этого же компонета в референсной фазе $R$:

$$ K_{ji} = \frac{y_{ji}}{y_{Ri}}, \; j = \left\{ 1 \, \ldots \, N_p \right\} - \left\{ R \right\}, \; i = 1 \, \ldots \, N_c. $$

```

При этом

$$ K_{Ri} = \frac{y_{Ri}}{y_{Ri}} = 1, \; i = 1 \, \ldots \, N_c. $$

Кроме того, необходимо отметить, что референсной фазой может быть любая. Рассмотрим следующее соотношение:

$$ \sum_{k=1}^{N_p} n_{ki} = n_i, \; i = 1 \, \ldots \, N_c. $$

Разделим левую и правую части данного выражения на количество вещества системы $n$:

$$ \sum_{k=1}^{N_p} \frac{n_{ki}}{n} = \frac{n_i}{n}, \; i = 1 \, \ldots \, N_c. $$

В левой части выражения домножим числитель и знаменатель каждого слагаемого на количество вещества соответствующей $k$-й фазы $n_k, \, k = 1 \, \ldots \, N_p$:

$$ \sum_{k=1}^{N_p} \frac{n_{ki}}{n} \frac{n_k}{n_k} = \sum_{k=1}^{N_p} \frac{n_{ki}}{n_k} \frac{n_k}{n} = \frac{n_i}{n}, \; i = 1 \, \ldots \, N_c. $$

С учетом представленных выше соотношений, данное выражение преобразуется к следующему:

$$ \sum_{k=1}^{N_p} y_{ki} f_k = y_i, \; i = 1 \, \ldots \, N_c. $$

В левой части выражения выразим $y_{ki}, \, k = 1 \, \ldots \, N_p, \, i = 1 \, \ldots \, N_c,$ через константу фазового равновесия (для простоты обозначения в качестве референсной выберем фазу с индексом $N_p$):

$$ \sum_{k=1}^{N_p} K_{ki} y_{N_pi} f_k = y_i, \; i = 1 \, \ldots \, N_c. $$

Поскольку мольная доля $i$-го компонента в референсной фазе $N_p$, обозначаемая $y_{N_pi}, \, i = 1 \, \ldots \, N_c,$ в левой части выражения не зависит от индекса суммирования $k$, то ее можно вынести за знак суммирования:

$$ y_{N_pi} \sum_{k=1}^{N_p} K_{ki} f_k = y_i, \; i = 1 \, \ldots \, N_c. $$

Тогда:

$$ y_{N_pi} = \frac{y_i}{\sum_{k=1}^{N_p} K_{ki} f_k}, \; i = 1 \, \ldots \, N_c. $$

Поскольку $y_{ji} = K_{ji} y_{N_pi}, \, j = 1 \, \ldots \, N_p - 1, \, i = 1 \, \ldots \, N_c$, то:

$$ y_{ji} = \frac{y_i K_{ji}}{\sum_{k=1}^{N_p} K_{ki} f_k}, \; j = 1 \, \ldots \, N_p - 1, \; i = 1 \, \ldots \, N_c. $$

Учитывая

$$ \sum_{i=1}^{N_c} y_{ji} = 1, \; j = 1 \, \ldots \, N_p, $$

можно записать следующую систему уравнений:

$$ \sum_{i=1}^{N_c} y_{ji} - \sum_{i=1}^{N_c} y_{N_pi} = 0, \; j = 1 \, \ldots \, N_p - 1. $$

Подставляя полученные ранее выражения для мольной доли $i$-го компонента в фазе $j$ и референсной фазе $N_p$, получим:

$$ \begin{align}
\sum_{i=1}^{N_c} y_{ji} - \sum_{i=1}^{N_c} y_{N_pi} &= 0, \; j = 1 \, \ldots \, N_p - 1, \\
\sum_{i=1}^{N_c} \left( y_{ji} - y_{N_pi} \right) &= 0, \; j = 1 \, \ldots \, N_p - 1, \\
\sum_{i=1}^{N_c} \left( \frac{y_i K_{ji}}{\sum_{k=1}^{N_p} K_{ki} f_k} - \frac{y_i}{\sum_{k=1}^{N_p} K_{ki} f_k} \right) &= 0, \; j = 1 \, \ldots \, N_p - 1, \\
\sum_{i=1}^{N_c} \frac{y_i \left( K_{ji} - 1 \right)}{\sum_{k=1}^{N_p} K_{ki} f_k} &= 0, \; j = 1 \, \ldots \, N_p - 1.
\end{align} $$

С учетом $\sum_{k=1}^{N_p} f_k = 1$ представленную выше систему уравнений можно преобразовать следующим образом:

$$ \begin{align}
\sum_{i=1}^{N_c} \frac{y_i \left( K_{ji} - 1 \right)}{\sum_{k=1}^{N_p} K_{ki} f_k} &= 0, \; j = 1 \, \ldots \, N_p - 1, \\
\sum_{i=1}^{N_c} \frac{y_i \left( K_{ji} - 1 \right)}{\sum_{k=1}^{N_p-1} K_{ki} f_k + K_{N_pi} f_{N_p}} &= 0, \; j = 1 \, \ldots \, N_p - 1, \\
\sum_{i=1}^{N_c} \frac{y_i \left( K_{ji} - 1 \right)}{\sum_{k=1}^{N_p-1} K_{ki} f_k + 1 - \sum_{k=1}^{N_p-1} f_k} &= 0, \; j = 1 \, \ldots \, N_p - 1, \\
\sum_{i=1}^{N_c} \frac{y_i \left( K_{ji} - 1 \right)}{\sum_{k=1}^{N_p-1} f_k \left( K_{ki} - 1 \right) + 1} &= 0, \; j = 1 \, \ldots \, N_p - 1. \\
\end{align} $$

Таким образом, система уравнений

$$ \sum_{i=1}^{N_c} \frac{y_i \left( K_{ji} - 1 \right)}{\sum_{k=1}^{N_p-1} f_k \left( K_{ki} - 1 \right) + 1} = 0, \; j = 1 \, \ldots \, N_p - 1, $$

называется ***системой уравнений Речфорда-Райса (системой уравнений фазовых концентраций)***. Она содержит $\left( N_p - 1 \right)$ уравнений и разрешается относительно $f_k, \, k = 1 \, \ldots \, N_p - 1,$ неизвестных при фиксировании значений констант фазового равновесия. После определения мольных долей фаз мольные доли компонентов в них определяются с использованием полученных ранее выражений:

$$ \begin{align}
y_{N_pi} &= \frac{y_i}{\sum_{k=1}^{N_p-1} f_k \left( K_{ki} - 1 \right) + 1}, \; i = 1 \, \ldots \, N_c, \\
y_{ji} &=  K_{ji} y_{N_pi}, \; j = 1 \, \ldots \, N_p - 1, \; i = 1 \, \ldots \, N_c. \\
\end{align} $$

В следующих разделах подробнее остановимся на численных методах решения уравнения Речфорда-Райса для [двухфазной](SEC-3-RR-2P.md) и [многофазной](SEC-4-RR-NP.md) систем.
