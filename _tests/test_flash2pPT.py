import sys

sys.path.append('../_src/')

import logging

logger = logging.getLogger('flash')
logger.setLevel(logging.DEBUG)
handler = logging.StreamHandler(sys.stdout)
formatter = logging.Formatter('%(message)s')
handler.setFormatter(formatter)
logger.addHandler(handler)

import unittest

import numpy as np

np.set_printoptions(linewidth=np.inf)

from eos import (
  pr78,
)

from flash import (
  flash2pPT,
)


class flash2p(unittest.TestCase):

  def test_01(self):
    P = 6e6
    T = 10. + 273.15
    yi = np.array([0.9, 0.1])
    Pci = np.array([7.37646e6, 4.600155e6])
    Tci = np.array([304.2, 190.6])
    wi = np.array([0.225, 0.008])
    mwi = np.array([0.04401, 0.016043])
    vsi = np.array([0., 0.])
    dij = np.array([0.025])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='ss', maxiter=12)
    res = flash.run(P, T, yi)
    pass

  def test_02(self):
    P = 6e6
    T = 10. + 273.15
    yi = np.array([0.9, 0.1])
    Pci = np.array([7.37646e6, 4.600155e6])
    Tci = np.array([304.2, 190.6])
    wi = np.array([0.225, 0.008])
    mwi = np.array([0.04401, 0.016043])
    vsi = np.array([0., 0.])
    dij = np.array([0.025])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='qnss', maxiter=12)
    res = flash.run(P, T, yi)
    pass

  def test_03(self):
    P = 6e6
    T = 10. + 273.15
    yi = np.array([0.9, 0.1])
    Pci = np.array([7.37646e6, 4.600155e6])
    Tci = np.array([304.2, 190.6])
    wi = np.array([0.225, 0.008])
    mwi = np.array([0.04401, 0.016043])
    vsi = np.array([0., 0.])
    dij = np.array([0.025])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='newton', maxiter=3)
    res = flash.run(P, T, yi)
    pass

  def test_04(self):
    P = 6e6
    T = 10. + 273.15
    yi = np.array([0.9, 0.1])
    Pci = np.array([7.37646e6, 4.600155e6])
    Tci = np.array([304.2, 190.6])
    wi = np.array([0.225, 0.008])
    mwi = np.array([0.04401, 0.016043])
    vsi = np.array([0., 0.])
    dij = np.array([0.025])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='ss-newton', maxiter=12)
    res = flash.run(P, T, yi)
    pass

  def test_05(self):
    P = 6e6
    T = 10. + 273.15
    yi = np.array([0.9, 0.1])
    Pci = np.array([7.37646e6, 4.600155e6])
    Tci = np.array([304.2, 190.6])
    wi = np.array([0.225, 0.008])
    mwi = np.array([0.04401, 0.016043])
    vsi = np.array([0., 0.])
    dij = np.array([0.025])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='qnss-newton', maxiter=7)
    res = flash.run(P, T, yi)
    pass

  def test_06(self):
    P = 17e6
    T = 68. + 273.15
    yi = np.array([0.7167, 0.0895, 0.0917, 0.0448, 0.0573])
    Pci = np.array([4.599e6, 4.872e6, 4.248e6, 3.796e6, 2.398e6])
    Tci = np.array([190.56, 305.32, 369.83, 425.12, 551.02])
    wi = np.array([0.012, 0.100, 0.152, 0.200, 0.414])
    mwi = np.array([0.016043, 0.03007, 0.044097, 0.058123, 0.120])
    vsi = np.array([-0.1595, -0.1134, -0.0863, -0.0675, 0.05661])
    dij = np.array([
      0.002689,
      0.008537, 0.001662,
      0.014748, 0.004914, 0.000866,
      0.039265, 0.021924, 0.011676, 0.006228,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='ss', maxiter=147)
    res = flash.run(P, T, yi)
    pass

  def test_07(self):
    P = 17e6
    T = 68. + 273.15
    yi = np.array([0.7167, 0.0895, 0.0917, 0.0448, 0.0573])
    Pci = np.array([4.599e6, 4.872e6, 4.248e6, 3.796e6, 2.398e6])
    Tci = np.array([190.56, 305.32, 369.83, 425.12, 551.02])
    wi = np.array([0.012, 0.100, 0.152, 0.200, 0.414])
    mwi = np.array([0.016043, 0.03007, 0.044097, 0.058123, 0.120])
    vsi = np.array([-0.1595, -0.1134, -0.0863, -0.0675, 0.05661])
    dij = np.array([
      0.002689,
      0.008537, 0.001662,
      0.014748, 0.004914, 0.000866,
      0.039265, 0.021924, 0.011676, 0.006228,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='qnss', maxiter=28)
    res = flash.run(P, T, yi)
    pass

  def test_08(self):
    P = 17e6
    T = 68. + 273.15
    yi = np.array([0.7167, 0.0895, 0.0917, 0.0448, 0.0573])
    Pci = np.array([4.599e6, 4.872e6, 4.248e6, 3.796e6, 2.398e6])
    Tci = np.array([190.56, 305.32, 369.83, 425.12, 551.02])
    wi = np.array([0.012, 0.100, 0.152, 0.200, 0.414])
    mwi = np.array([0.016043, 0.03007, 0.044097, 0.058123, 0.120])
    vsi = np.array([-0.1595, -0.1134, -0.0863, -0.0675, 0.05661])
    dij = np.array([
      0.002689,
      0.008537, 0.001662,
      0.014748, 0.004914, 0.000866,
      0.039265, 0.021924, 0.011676, 0.006228,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='newton', maxiter=5)
    res = flash.run(P, T, yi)
    pass

  def test_09(self):
    P = 17e6
    T = 68. + 273.15
    yi = np.array([0.7167, 0.0895, 0.0917, 0.0448, 0.0573])
    Pci = np.array([4.599e6, 4.872e6, 4.248e6, 3.796e6, 2.398e6])
    Tci = np.array([190.56, 305.32, 369.83, 425.12, 551.02])
    wi = np.array([0.012, 0.100, 0.152, 0.200, 0.414])
    mwi = np.array([0.016043, 0.03007, 0.044097, 0.058123, 0.120])
    vsi = np.array([-0.1595, -0.1134, -0.0863, -0.0675, 0.05661])
    dij = np.array([
      0.002689,
      0.008537, 0.001662,
      0.014748, 0.004914, 0.000866,
      0.039265, 0.021924, 0.011676, 0.006228,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='ss-newton', maxiter=5)
    res = flash.run(P, T, yi)
    pass

  def test_10(self):
    P = 17e6
    T = 68. + 273.15
    yi = np.array([0.7167, 0.0895, 0.0917, 0.0448, 0.0573])
    Pci = np.array([4.599e6, 4.872e6, 4.248e6, 3.796e6, 2.398e6])
    Tci = np.array([190.56, 305.32, 369.83, 425.12, 551.02])
    wi = np.array([0.012, 0.100, 0.152, 0.200, 0.414])
    mwi = np.array([0.016043, 0.03007, 0.044097, 0.058123, 0.120])
    vsi = np.array([-0.1595, -0.1134, -0.0863, -0.0675, 0.05661])
    dij = np.array([
      0.002689,
      0.008537, 0.001662,
      0.014748, 0.004914, 0.000866,
      0.039265, 0.021924, 0.011676, 0.006228,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='qnss-newton', maxiter=5)
    res = flash.run(P, T, yi)
    pass

  def test_11(self):
    P = 1e6
    T = 160.
    yi = np.array([0.9430, 0.0270, 0.0074, 0.0049, 0.0027, 0.0010, 0.0140])
    Pci = np.array([4.599, 4.872, 4.248, 3.796, 3.370, 3.025, 3.400]) * 1e6
    Tci = np.array([190.56, 305.32, 369.83, 425.12, 469.70, 507.60, 126.20])
    wi = np.array([0.0115, 0.0995, 0.1523, 0.2002, 0.2515, 0.3013, 0.0377])
    mwi = np.array([0.0160, 0.0301, 0.0441, 0.0581, 0.0722, 0.0860, 0.0280])
    vsi = np.array([0., 0., 0., 0., 0., 0., 0.])
    dij = np.array([
      0.00269,
      0.00854, 0.00166,
      0.01475, 0.00491, 0.00087,
      0.02064, 0.00858, 0.00271, 0.00051,
      0.02535, 0.01175, 0.00462, 0.00149, 0.0002,
      0.02500, 0.06000, 0.09000, 0.09500, 0.11000, 0.11000,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='ss', maxiter=17)
    res = flash.run(P, T, yi)
    pass

  def test_12(self):
    P = 1e6
    T = 160.
    yi = np.array([0.9430, 0.0270, 0.0074, 0.0049, 0.0027, 0.0010, 0.0140])
    Pci = np.array([4.599, 4.872, 4.248, 3.796, 3.370, 3.025, 3.400]) * 1e6
    Tci = np.array([190.56, 305.32, 369.83, 425.12, 469.70, 507.60, 126.20])
    wi = np.array([0.0115, 0.0995, 0.1523, 0.2002, 0.2515, 0.3013, 0.0377])
    mwi = np.array([0.0160, 0.0301, 0.0441, 0.0581, 0.0722, 0.0860, 0.0280])
    vsi = np.array([0., 0., 0., 0., 0., 0., 0.])
    dij = np.array([
      0.00269,
      0.00854, 0.00166,
      0.01475, 0.00491, 0.00087,
      0.02064, 0.00858, 0.00271, 0.00051,
      0.02535, 0.01175, 0.00462, 0.00149, 0.0002,
      0.02500, 0.06000, 0.09000, 0.09500, 0.11000, 0.11000,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='qnss', maxiter=10)
    res = flash.run(P, T, yi)
    pass

  def test_13(self):
    P = 1e6
    T = 160.
    yi = np.array([0.9430, 0.0270, 0.0074, 0.0049, 0.0027, 0.0010, 0.0140])
    Pci = np.array([4.599, 4.872, 4.248, 3.796, 3.370, 3.025, 3.400]) * 1e6
    Tci = np.array([190.56, 305.32, 369.83, 425.12, 469.70, 507.60, 126.20])
    wi = np.array([0.0115, 0.0995, 0.1523, 0.2002, 0.2515, 0.3013, 0.0377])
    mwi = np.array([0.0160, 0.0301, 0.0441, 0.0581, 0.0722, 0.0860, 0.0280])
    vsi = np.array([0., 0., 0., 0., 0., 0., 0.])
    dij = np.array([
      0.00269,
      0.00854, 0.00166,
      0.01475, 0.00491, 0.00087,
      0.02064, 0.00858, 0.00271, 0.00051,
      0.02535, 0.01175, 0.00462, 0.00149, 0.0002,
      0.02500, 0.06000, 0.09000, 0.09500, 0.11000, 0.11000,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='newton', maxiter=5)
    res = flash.run(P, T, yi)
    pass

  def test_14(self):
    P = 1e6
    T = 160.
    yi = np.array([0.9430, 0.0270, 0.0074, 0.0049, 0.0027, 0.0010, 0.0140])
    Pci = np.array([4.599, 4.872, 4.248, 3.796, 3.370, 3.025, 3.400]) * 1e6
    Tci = np.array([190.56, 305.32, 369.83, 425.12, 469.70, 507.60, 126.20])
    wi = np.array([0.0115, 0.0995, 0.1523, 0.2002, 0.2515, 0.3013, 0.0377])
    mwi = np.array([0.0160, 0.0301, 0.0441, 0.0581, 0.0722, 0.0860, 0.0280])
    vsi = np.array([0., 0., 0., 0., 0., 0., 0.])
    dij = np.array([
      0.00269,
      0.00854, 0.00166,
      0.01475, 0.00491, 0.00087,
      0.02064, 0.00858, 0.00271, 0.00051,
      0.02535, 0.01175, 0.00462, 0.00149, 0.0002,
      0.02500, 0.06000, 0.09000, 0.09500, 0.11000, 0.11000,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='ss-newton', maxiter=17)
    res = flash.run(P, T, yi)
    pass

  def test_15(self):
    P = 1e6
    T = 160.
    yi = np.array([0.9430, 0.0270, 0.0074, 0.0049, 0.0027, 0.0010, 0.0140])
    Pci = np.array([4.599, 4.872, 4.248, 3.796, 3.370, 3.025, 3.400]) * 1e6
    Tci = np.array([190.56, 305.32, 369.83, 425.12, 469.70, 507.60, 126.20])
    wi = np.array([0.0115, 0.0995, 0.1523, 0.2002, 0.2515, 0.3013, 0.0377])
    mwi = np.array([0.0160, 0.0301, 0.0441, 0.0581, 0.0722, 0.0860, 0.0280])
    vsi = np.array([0., 0., 0., 0., 0., 0., 0.])
    dij = np.array([
      0.00269,
      0.00854, 0.00166,
      0.01475, 0.00491, 0.00087,
      0.02064, 0.00858, 0.00271, 0.00051,
      0.02535, 0.01175, 0.00462, 0.00149, 0.0002,
      0.02500, 0.06000, 0.09000, 0.09500, 0.11000, 0.11000,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='qnss-newton', maxiter=9)
    res = flash.run(P, T, yi)
    pass

  def test_16(self):
    P = 8.7625e6
    T = 316.48
    yi = np.array([
      0.590516, 0.028933, 0.072729, 0.081162, 0.131012, 0.064671, 0.030977,
    ])
    Pci = np.array([73.36, 45.99, 45.53, 33.68, 20.95, 15.88, 15.84]) * 1e5
    Tci = np.array([304.20, 166.67, 338.81, 466.12, 611.11, 777.78, 972.22])
    wi = np.array([0.225, 0.008, 0.126, 0.244, 0.639, 1.000, 1.281])
    vsi = np.array([0., 0., 0., 0., 0., 0., 0.])
    mwi = np.array([0.044, 0.016, 0.037, 0.072, 0.161, 0.312, 0.495])
    dij = np.array([
      0.05,
      0.05, 0.00853,
      0.05, 0.02064, 0.00271,
      0.09, 0.05428, 0.02079, 0.00863,
      0.09, 0.09301, 0.04829, 0.02887, 0.00615,
      0.09, 0.12546, 0.07402, 0.05002, 0.01794, 0.00316,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='ss', maxiter=191)
    res = flash.run(P, T, yi)
    pass

  def test_17(self):
    P = 8.7625e6
    T = 316.48
    yi = np.array([
      0.590516, 0.028933, 0.072729, 0.081162, 0.131012, 0.064671, 0.030977,
    ])
    Pci = np.array([73.36, 45.99, 45.53, 33.68, 20.95, 15.88, 15.84]) * 1e5
    Tci = np.array([304.20, 166.67, 338.81, 466.12, 611.11, 777.78, 972.22])
    wi = np.array([0.225, 0.008, 0.126, 0.244, 0.639, 1.000, 1.281])
    vsi = np.array([0., 0., 0., 0., 0., 0., 0.])
    mwi = np.array([0.044, 0.016, 0.037, 0.072, 0.161, 0.312, 0.495])
    dij = np.array([
      0.05,
      0.05, 0.00853,
      0.05, 0.02064, 0.00271,
      0.09, 0.05428, 0.02079, 0.00863,
      0.09, 0.09301, 0.04829, 0.02887, 0.00615,
      0.09, 0.12546, 0.07402, 0.05002, 0.01794, 0.00316,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='qnss', maxiter=47)
    res = flash.run(P, T, yi)
    pass

  def test_18(self):
    P = 8.7625e6
    T = 316.48
    yi = np.array([
      0.590516, 0.028933, 0.072729, 0.081162, 0.131012, 0.064671, 0.030977,
    ])
    Pci = np.array([73.36, 45.99, 45.53, 33.68, 20.95, 15.88, 15.84]) * 1e5
    Tci = np.array([304.20, 166.67, 338.81, 466.12, 611.11, 777.78, 972.22])
    wi = np.array([0.225, 0.008, 0.126, 0.244, 0.639, 1.000, 1.281])
    vsi = np.array([0., 0., 0., 0., 0., 0., 0.])
    mwi = np.array([0.044, 0.016, 0.037, 0.072, 0.161, 0.312, 0.495])
    dij = np.array([
      0.05,
      0.05, 0.00853,
      0.05, 0.02064, 0.00271,
      0.09, 0.05428, 0.02079, 0.00863,
      0.09, 0.09301, 0.04829, 0.02887, 0.00615,
      0.09, 0.12546, 0.07402, 0.05002, 0.01794, 0.00316,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='newton', maxiter=7)
    res = flash.run(P, T, yi)
    pass

  def test_19(self):
    P = 8.7625e6
    T = 316.48
    yi = np.array([
      0.590516, 0.028933, 0.072729, 0.081162, 0.131012, 0.064671, 0.030977,
    ])
    Pci = np.array([73.36, 45.99, 45.53, 33.68, 20.95, 15.88, 15.84]) * 1e5
    Tci = np.array([304.20, 166.67, 338.81, 466.12, 611.11, 777.78, 972.22])
    wi = np.array([0.225, 0.008, 0.126, 0.244, 0.639, 1.000, 1.281])
    vsi = np.array([0., 0., 0., 0., 0., 0., 0.])
    mwi = np.array([0.044, 0.016, 0.037, 0.072, 0.161, 0.312, 0.495])
    dij = np.array([
      0.05,
      0.05, 0.00853,
      0.05, 0.02064, 0.00271,
      0.09, 0.05428, 0.02079, 0.00863,
      0.09, 0.09301, 0.04829, 0.02887, 0.00615,
      0.09, 0.12546, 0.07402, 0.05002, 0.01794, 0.00316,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='ss-newton', maxiter=22)
    res = flash.run(P, T, yi)
    pass

  def test_20(self):
    P = 8.7625e6
    T = 316.48
    yi = np.array([
      0.590516, 0.028933, 0.072729, 0.081162, 0.131012, 0.064671, 0.030977,
    ])
    Pci = np.array([73.36, 45.99, 45.53, 33.68, 20.95, 15.88, 15.84]) * 1e5
    Tci = np.array([304.20, 166.67, 338.81, 466.12, 611.11, 777.78, 972.22])
    wi = np.array([0.225, 0.008, 0.126, 0.244, 0.639, 1.000, 1.281])
    vsi = np.array([0., 0., 0., 0., 0., 0., 0.])
    mwi = np.array([0.044, 0.016, 0.037, 0.072, 0.161, 0.312, 0.495])
    dij = np.array([
      0.05,
      0.05, 0.00853,
      0.05, 0.02064, 0.00271,
      0.09, 0.05428, 0.02079, 0.00863,
      0.09, 0.09301, 0.04829, 0.02887, 0.00615,
      0.09, 0.12546, 0.07402, 0.05002, 0.01794, 0.00316,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='qnss-newton', maxiter=10)
    res = flash.run(P, T, yi)
    pass

  def test_21(self):
    P = 101325.
    T = 20. + 273.15
    yi = np.array([0.1, 0.6, 0.3])
    Pci = np.array([4.600155, 3.2890095, 22.04832]) * 1e6
    Tci = np.array([190.6, 507.5, 647.3])
    wi = np.array([0.008, 0.27504, 0.344])
    vsi = np.array([0., 0., 0.])
    mwi = np.array([0.016043, 0.086, 0.018015])
    dij = np.array([
      0.0253,
      0.4907, 0.48,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij, kvlevel=1)
    flash = flash2pPT(pr, method='ss', maxiter=6)
    res = flash.run(P, T, yi)
    pass

  def test_22(self):
    P = 101325.
    T = 20. + 273.15
    yi = np.array([0.1, 0.6, 0.3])
    Pci = np.array([4.600155, 3.2890095, 22.04832]) * 1e6
    Tci = np.array([190.6, 507.5, 647.3])
    wi = np.array([0.008, 0.27504, 0.344])
    vsi = np.array([0., 0., 0.])
    mwi = np.array([0.016043, 0.086, 0.018015])
    dij = np.array([
      0.0253,
      0.4907, 0.48,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij, kvlevel=1)
    flash = flash2pPT(pr, method='qnss', maxiter=5)
    res = flash.run(P, T, yi)
    pass

  def test_23(self):
    P = 101325.
    T = 20. + 273.15
    yi = np.array([0.1, 0.6, 0.3])
    Pci = np.array([4.600155, 3.2890095, 22.04832]) * 1e6
    Tci = np.array([190.6, 507.5, 647.3])
    wi = np.array([0.008, 0.27504, 0.344])
    vsi = np.array([0., 0., 0.])
    mwi = np.array([0.016043, 0.086, 0.018015])
    dij = np.array([
      0.0253,
      0.4907, 0.48,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij, kvlevel=1)
    flash = flash2pPT(pr, method='newton', maxiter=3)
    res = flash.run(P, T, yi)
    pass

  def test_24(self):
    P = 101325.
    T = 20. + 273.15
    yi = np.array([0.1, 0.6, 0.3])
    Pci = np.array([4.600155, 3.2890095, 22.04832]) * 1e6
    Tci = np.array([190.6, 507.5, 647.3])
    wi = np.array([0.008, 0.27504, 0.344])
    vsi = np.array([0., 0., 0.])
    mwi = np.array([0.016043, 0.086, 0.018015])
    dij = np.array([
      0.0253,
      0.4907, 0.48,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij, kvlevel=1)
    flash = flash2pPT(pr, method='ss-newton', maxiter=6)
    res = flash.run(P, T, yi)
    pass

  def test_25(self):
    P = 101325.
    T = 20. + 273.15
    yi = np.array([0.1, 0.6, 0.3])
    Pci = np.array([4.600155, 3.2890095, 22.04832]) * 1e6
    Tci = np.array([190.6, 507.5, 647.3])
    wi = np.array([0.008, 0.27504, 0.344])
    vsi = np.array([0., 0., 0.])
    mwi = np.array([0.016043, 0.086, 0.018015])
    dij = np.array([
      0.0253,
      0.4907, 0.48,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij, kvlevel=1)
    flash = flash2pPT(pr, method='qnss-newton', maxiter=5)
    res = flash.run(P, T, yi)
    pass

  def test_26(self):
    P = 8.7625e6
    T = 316.48
    yi = np.array([0.590516, 0.02893275, 0.0727285, 0.081162, 0.1310115,
                   0.06467075, 0.0309785])
    Pci = np.array([73.76, 46.00, 45.53, 33.68, 20.95, 15.88, 15.84]) * 1e5
    Tci = np.array([304.2, 190.6, 338.8, 466.1, 611.1, 777.8, 972.2])
    mwi = np.array([44.01, 16.04, 36.01, 70.52, 147.18, 301.48, 562.81]) / 1e3
    wi = np.array([0.2250, 0.0080, 0.1260, 0.2439, 0.6386, 1.0002, 1.2812])
    vsi = np.array([0., 0., 0., 0., 0., 0., 0.])
    dij = np.array([
      0.05,
      0.05, 0.0052,
      0.05, 0.0214, 0.0057,
      0.09, 0.0494, 0.0234, 0.0062,
      0.09, 0.0717, 0.0401, 0.0162, 0.0024,
      0.09, 0.0783, 0.0452, 0.0196, 0.0038, 0.0002,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='ss', maxiter=447)
    res = flash.run(P, T, yi)
    pass

  def test_27(self):
    P = 8.7625e6
    T = 316.48
    yi = np.array([0.590516, 0.02893275, 0.0727285, 0.081162, 0.1310115,
                   0.06467075, 0.0309785])
    Pci = np.array([73.76, 46.00, 45.53, 33.68, 20.95, 15.88, 15.84]) * 1e5
    Tci = np.array([304.2, 190.6, 338.8, 466.1, 611.1, 777.8, 972.2])
    mwi = np.array([44.01, 16.04, 36.01, 70.52, 147.18, 301.48, 562.81]) / 1e3
    wi = np.array([0.2250, 0.0080, 0.1260, 0.2439, 0.6386, 1.0002, 1.2812])
    vsi = np.array([0., 0., 0., 0., 0., 0., 0.])
    dij = np.array([
      0.05,
      0.05, 0.0052,
      0.05, 0.0214, 0.0057,
      0.09, 0.0494, 0.0234, 0.0062,
      0.09, 0.0717, 0.0401, 0.0162, 0.0024,
      0.09, 0.0783, 0.0452, 0.0196, 0.0038, 0.0002,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='qnss', maxiter=114)
    res = flash.run(P, T, yi)
    pass

  def test_28(self):
    P = 8.7625e6
    T = 316.48
    yi = np.array([0.590516, 0.02893275, 0.0727285, 0.081162, 0.1310115,
                   0.06467075, 0.0309785])
    Pci = np.array([73.76, 46.00, 45.53, 33.68, 20.95, 15.88, 15.84]) * 1e5
    Tci = np.array([304.2, 190.6, 338.8, 466.1, 611.1, 777.8, 972.2])
    mwi = np.array([44.01, 16.04, 36.01, 70.52, 147.18, 301.48, 562.81]) / 1e3
    wi = np.array([0.2250, 0.0080, 0.1260, 0.2439, 0.6386, 1.0002, 1.2812])
    vsi = np.array([0., 0., 0., 0., 0., 0., 0.])
    dij = np.array([
      0.05,
      0.05, 0.0052,
      0.05, 0.0214, 0.0057,
      0.09, 0.0494, 0.0234, 0.0062,
      0.09, 0.0717, 0.0401, 0.0162, 0.0024,
      0.09, 0.0783, 0.0452, 0.0196, 0.0038, 0.0002,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='newton', maxiter=4)
    res = flash.run(P, T, yi)
    pass

  def test_29(self):
    P = 8.7625e6
    T = 316.48
    yi = np.array([0.590516, 0.02893275, 0.0727285, 0.081162, 0.1310115,
                   0.06467075, 0.0309785])
    Pci = np.array([73.76, 46.00, 45.53, 33.68, 20.95, 15.88, 15.84]) * 1e5
    Tci = np.array([304.2, 190.6, 338.8, 466.1, 611.1, 777.8, 972.2])
    mwi = np.array([44.01, 16.04, 36.01, 70.52, 147.18, 301.48, 562.81]) / 1e3
    wi = np.array([0.2250, 0.0080, 0.1260, 0.2439, 0.6386, 1.0002, 1.2812])
    vsi = np.array([0., 0., 0., 0., 0., 0., 0.])
    dij = np.array([
      0.05,
      0.05, 0.0052,
      0.05, 0.0214, 0.0057,
      0.09, 0.0494, 0.0234, 0.0062,
      0.09, 0.0717, 0.0401, 0.0162, 0.0024,
      0.09, 0.0783, 0.0452, 0.0196, 0.0038, 0.0002,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='ss-newton', maxiter=57)
    res = flash.run(P, T, yi)
    pass

  def test_30(self):
    P = 8.7625e6
    T = 316.48
    yi = np.array([0.590516, 0.02893275, 0.0727285, 0.081162, 0.1310115,
                   0.06467075, 0.0309785])
    Pci = np.array([73.76, 46.00, 45.53, 33.68, 20.95, 15.88, 15.84]) * 1e5
    Tci = np.array([304.2, 190.6, 338.8, 466.1, 611.1, 777.8, 972.2])
    mwi = np.array([44.01, 16.04, 36.01, 70.52, 147.18, 301.48, 562.81]) / 1e3
    wi = np.array([0.2250, 0.0080, 0.1260, 0.2439, 0.6386, 1.0002, 1.2812])
    vsi = np.array([0., 0., 0., 0., 0., 0., 0.])
    dij = np.array([
      0.05,
      0.05, 0.0052,
      0.05, 0.0214, 0.0057,
      0.09, 0.0494, 0.0234, 0.0062,
      0.09, 0.0717, 0.0401, 0.0162, 0.0024,
      0.09, 0.0783, 0.0452, 0.0196, 0.0038, 0.0002,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='qnss-newton', maxiter=18)
    res = flash.run(P, T, yi)
    pass

  def test_31(self):
    P = 9.39375e6
    T = 305.35
    yi = np.array([0.646, 0.1040406, 0.0360726, 0.0295590, 0.0117174,
                   0.0426216, 0.0559674, 0.0291342, 0.0186912, 0.0097704,
                   0.0164256])
    Pci = np.array([73.82, 45.40, 48.20, 41.90, 37.50, 28.82, 23.74, 18.59,
                    14.80, 11.95, 8.52]) * 1e5
    Tci = np.array([304.211, 190.60, 305.40, 369.80, 425.20, 516.667, 590.00,
                    668.611, 745.778, 812.667, 914.889])
    mwi = np.array([44.0, 16.0, 30.1, 44.1, 58.1, 89.9, 125.7, 174.4, 240.3,
                    336.1, 536.7]) / 1e3
    wi = np.array([0.225, 0.008, 0.098, 0.152, 0.193, 0.2651, 0.3644, 0.4987,
                   0.6606, 0.8771, 1.2789])
    vsi = np.array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])
    dij = np.array([
      0.115,
      0.115, 0.000,
      0.115, 0.000, 0.,
      0.115, 0.000, 0., 0.,
      0.115, 0.045, 0., 0., 0.,
      0.115, 0.055, 0., 0., 0., 0.,
      0.115, 0.055, 0., 0., 0., 0., 0.,
      0.115, 0.060, 0., 0., 0., 0., 0., 0.,
      0.115, 0.080, 0., 0., 0., 0., 0., 0., 0.,
      0.115, 0.280, 0., 0., 0., 0., 0., 0., 0., 0.,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='ss', maxiter=210)
    res = flash.run(P, T, yi)
    pass

  def test_32(self):
    P = 9.39375e6
    T = 305.35
    yi = np.array([0.646, 0.1040406, 0.0360726, 0.0295590, 0.0117174,
                   0.0426216, 0.0559674, 0.0291342, 0.0186912, 0.0097704,
                   0.0164256])
    Pci = np.array([73.82, 45.40, 48.20, 41.90, 37.50, 28.82, 23.74, 18.59,
                    14.80, 11.95, 8.52]) * 1e5
    Tci = np.array([304.211, 190.60, 305.40, 369.80, 425.20, 516.667, 590.00,
                    668.611, 745.778, 812.667, 914.889])
    mwi = np.array([44.0, 16.0, 30.1, 44.1, 58.1, 89.9, 125.7, 174.4, 240.3,
                    336.1, 536.7]) / 1e3
    wi = np.array([0.225, 0.008, 0.098, 0.152, 0.193, 0.2651, 0.3644, 0.4987,
                   0.6606, 0.8771, 1.2789])
    vsi = np.array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])
    dij = np.array([
      0.115,
      0.115, 0.000,
      0.115, 0.000, 0.,
      0.115, 0.000, 0., 0.,
      0.115, 0.045, 0., 0., 0.,
      0.115, 0.055, 0., 0., 0., 0.,
      0.115, 0.055, 0., 0., 0., 0., 0.,
      0.115, 0.060, 0., 0., 0., 0., 0., 0.,
      0.115, 0.080, 0., 0., 0., 0., 0., 0., 0.,
      0.115, 0.280, 0., 0., 0., 0., 0., 0., 0., 0.,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='qnss', maxiter=52)
    res = flash.run(P, T, yi)
    pass

  def test_33(self):
    P = 9.39375e6
    T = 305.35
    yi = np.array([0.646, 0.1040406, 0.0360726, 0.0295590, 0.0117174,
                   0.0426216, 0.0559674, 0.0291342, 0.0186912, 0.0097704,
                   0.0164256])
    Pci = np.array([73.82, 45.40, 48.20, 41.90, 37.50, 28.82, 23.74, 18.59,
                    14.80, 11.95, 8.52]) * 1e5
    Tci = np.array([304.211, 190.60, 305.40, 369.80, 425.20, 516.667, 590.00,
                    668.611, 745.778, 812.667, 914.889])
    mwi = np.array([44.0, 16.0, 30.1, 44.1, 58.1, 89.9, 125.7, 174.4, 240.3,
                    336.1, 536.7]) / 1e3
    wi = np.array([0.225, 0.008, 0.098, 0.152, 0.193, 0.2651, 0.3644, 0.4987,
                   0.6606, 0.8771, 1.2789])
    vsi = np.array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])
    dij = np.array([
      0.115,
      0.115, 0.000,
      0.115, 0.000, 0.,
      0.115, 0.000, 0., 0.,
      0.115, 0.045, 0., 0., 0.,
      0.115, 0.055, 0., 0., 0., 0.,
      0.115, 0.055, 0., 0., 0., 0., 0.,
      0.115, 0.060, 0., 0., 0., 0., 0., 0.,
      0.115, 0.080, 0., 0., 0., 0., 0., 0., 0.,
      0.115, 0.280, 0., 0., 0., 0., 0., 0., 0., 0.,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='newton', maxiter=5)
    res = flash.run(P, T, yi)
    pass

  def test_34(self):
    P = 9.39375e6
    T = 305.35
    yi = np.array([0.646, 0.1040406, 0.0360726, 0.0295590, 0.0117174,
                   0.0426216, 0.0559674, 0.0291342, 0.0186912, 0.0097704,
                   0.0164256])
    Pci = np.array([73.82, 45.40, 48.20, 41.90, 37.50, 28.82, 23.74, 18.59,
                    14.80, 11.95, 8.52]) * 1e5
    Tci = np.array([304.211, 190.60, 305.40, 369.80, 425.20, 516.667, 590.00,
                    668.611, 745.778, 812.667, 914.889])
    mwi = np.array([44.0, 16.0, 30.1, 44.1, 58.1, 89.9, 125.7, 174.4, 240.3,
                    336.1, 536.7]) / 1e3
    wi = np.array([0.225, 0.008, 0.098, 0.152, 0.193, 0.2651, 0.3644, 0.4987,
                   0.6606, 0.8771, 1.2789])
    vsi = np.array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])
    dij = np.array([
      0.115,
      0.115, 0.000,
      0.115, 0.000, 0.,
      0.115, 0.000, 0., 0.,
      0.115, 0.045, 0., 0., 0.,
      0.115, 0.055, 0., 0., 0., 0.,
      0.115, 0.055, 0., 0., 0., 0., 0.,
      0.115, 0.060, 0., 0., 0., 0., 0., 0.,
      0.115, 0.080, 0., 0., 0., 0., 0., 0., 0.,
      0.115, 0.280, 0., 0., 0., 0., 0., 0., 0., 0.,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='ss-newton', maxiter=45)
    res = flash.run(P, T, yi)
    pass

  def test_35(self):
    P = 9.39375e6
    T = 305.35
    yi = np.array([0.646, 0.1040406, 0.0360726, 0.0295590, 0.0117174,
                   0.0426216, 0.0559674, 0.0291342, 0.0186912, 0.0097704,
                   0.0164256])
    Pci = np.array([73.82, 45.40, 48.20, 41.90, 37.50, 28.82, 23.74, 18.59,
                    14.80, 11.95, 8.52]) * 1e5
    Tci = np.array([304.211, 190.60, 305.40, 369.80, 425.20, 516.667, 590.00,
                    668.611, 745.778, 812.667, 914.889])
    mwi = np.array([44.0, 16.0, 30.1, 44.1, 58.1, 89.9, 125.7, 174.4, 240.3,
                    336.1, 536.7]) / 1e3
    wi = np.array([0.225, 0.008, 0.098, 0.152, 0.193, 0.2651, 0.3644, 0.4987,
                   0.6606, 0.8771, 1.2789])
    vsi = np.array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])
    dij = np.array([
      0.115,
      0.115, 0.000,
      0.115, 0.000, 0.,
      0.115, 0.000, 0., 0.,
      0.115, 0.045, 0., 0., 0.,
      0.115, 0.055, 0., 0., 0., 0.,
      0.115, 0.055, 0., 0., 0., 0., 0.,
      0.115, 0.060, 0., 0., 0., 0., 0., 0.,
      0.115, 0.080, 0., 0., 0., 0., 0., 0., 0.,
      0.115, 0.280, 0., 0., 0., 0., 0., 0., 0., 0.,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='qnss-newton', maxiter=12)
    res = flash.run(P, T, yi)
    pass

  def test_36(self):
    P = 16.18e6
    T = 68. + 273.15
    yi = np.array([0.7167, 0.0895, 0.0917, 0.0448, 0.0573])
    Pci = np.array([4.599e6, 4.872e6, 4.248e6, 3.796e6, 2.398e6])
    Tci = np.array([190.56, 305.32, 369.83, 425.12, 551.02])
    wi = np.array([0.012, 0.100, 0.152, 0.200, 0.414])
    mwi = np.array([0.016043, 0.03007, 0.044097, 0.058123, 0.120])
    vsi = np.array([-0.1595, -0.1134, -0.0863, -0.0675, 0.05661])
    dij = np.array([
      0.002689,
      0.008537, 0.001662,
      0.014748, 0.004914, 0.000866,
      0.039265, 0.021924, 0.011676, 0.006228,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='ss', maxiter=88)
    res = flash.run(P, T, yi)
    pass

  def test_37(self):
    P = 16.18e6
    T = 68. + 273.15
    yi = np.array([0.7167, 0.0895, 0.0917, 0.0448, 0.0573])
    Pci = np.array([4.599e6, 4.872e6, 4.248e6, 3.796e6, 2.398e6])
    Tci = np.array([190.56, 305.32, 369.83, 425.12, 551.02])
    wi = np.array([0.012, 0.100, 0.152, 0.200, 0.414])
    mwi = np.array([0.016043, 0.03007, 0.044097, 0.058123, 0.120])
    vsi = np.array([-0.1595, -0.1134, -0.0863, -0.0675, 0.05661])
    dij = np.array([
      0.002689,
      0.008537, 0.001662,
      0.014748, 0.004914, 0.000866,
      0.039265, 0.021924, 0.011676, 0.006228,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='qnss', maxiter=15)
    res = flash.run(P, T, yi)
    pass

  def test_38(self):
    P = 16.18e6
    T = 68. + 273.15
    yi = np.array([0.7167, 0.0895, 0.0917, 0.0448, 0.0573])
    Pci = np.array([4.599e6, 4.872e6, 4.248e6, 3.796e6, 2.398e6])
    Tci = np.array([190.56, 305.32, 369.83, 425.12, 551.02])
    wi = np.array([0.012, 0.100, 0.152, 0.200, 0.414])
    mwi = np.array([0.016043, 0.03007, 0.044097, 0.058123, 0.120])
    vsi = np.array([-0.1595, -0.1134, -0.0863, -0.0675, 0.05661])
    dij = np.array([
      0.002689,
      0.008537, 0.001662,
      0.014748, 0.004914, 0.000866,
      0.039265, 0.021924, 0.011676, 0.006228,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='newton', maxiter=5)
    res = flash.run(P, T, yi)
    pass

  def test_39(self):
    P = 16.18e6
    T = 68. + 273.15
    yi = np.array([0.7167, 0.0895, 0.0917, 0.0448, 0.0573])
    Pci = np.array([4.599e6, 4.872e6, 4.248e6, 3.796e6, 2.398e6])
    Tci = np.array([190.56, 305.32, 369.83, 425.12, 551.02])
    wi = np.array([0.012, 0.100, 0.152, 0.200, 0.414])
    mwi = np.array([0.016043, 0.03007, 0.044097, 0.058123, 0.120])
    vsi = np.array([-0.1595, -0.1134, -0.0863, -0.0675, 0.05661])
    dij = np.array([
      0.002689,
      0.008537, 0.001662,
      0.014748, 0.004914, 0.000866,
      0.039265, 0.021924, 0.011676, 0.006228,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='ss-newton', maxiter=11)
    res = flash.run(P, T, yi)
    pass

  def test_40(self):
    P = 16.18e6
    T = 68. + 273.15
    yi = np.array([0.7167, 0.0895, 0.0917, 0.0448, 0.0573])
    Pci = np.array([4.599e6, 4.872e6, 4.248e6, 3.796e6, 2.398e6])
    Tci = np.array([190.56, 305.32, 369.83, 425.12, 551.02])
    wi = np.array([0.012, 0.100, 0.152, 0.200, 0.414])
    mwi = np.array([0.016043, 0.03007, 0.044097, 0.058123, 0.120])
    vsi = np.array([-0.1595, -0.1134, -0.0863, -0.0675, 0.05661])
    dij = np.array([
      0.002689,
      0.008537, 0.001662,
      0.014748, 0.004914, 0.000866,
      0.039265, 0.021924, 0.011676, 0.006228,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='qnss-newton', maxiter=7)
    res = flash.run(P, T, yi)
    pass

  def test_41(self):
    P = 45e5
    T = 238.15
    yi = np.array([1.09348396e-4, 1.26630351e-3, 7.72930571e-1, 9.07376834e-2,
                   5.18632702e-2, 1.03370543e-2, 2.01511781e-2, 7.19655884e-3,
                   6.34345569e-3, 1.08977391e-2, 2.14987133e-2, 4.74268201e-3,
                   1.51339170e-3, 4.08740755e-4, 3.309699e-6])
    Pci = np.array([72.8, 33.5, 45.4, 48.2, 41.9, 36.0, 37.5, 33.4, 33.3,
                    32.46, 29.1862, 23.274195, 19.855981, 17.096682,
                    16.23444]) * 101325.
    Tci = np.array([304.2, 126.2, 190.6, 305.4, 369.8, 408.1, 425.2, 460.4,
                    469.6, 507.5, 558.96444, 629.35895, 678.01295, 723.01566,
                    893.91147])
    wi = np.array([0.225, 0.040, 0.008, 0.098, 0.152, 0.176, 0.193, 0.227,
                   0.251, 0.27504, 0.31228, 0.43337435, 0.53091175,
                   0.63045267, 1.0341])
    mwi = np.array([44.010, 28.013, 16.043, 30.070, 44.097, 58.124, 58.124,
                    72.151, 72.151, 86.000, 110.46812, 149.37189, 183.83825,
                    221.96509, 310.37874]) / 1e3
    vsi = np.array([-0.09434672, -0.12838834, -0.2038605, -0.10210346,
                    -0.07330094, -0.05706875, -0.05705589, -0.03446267,
                    -0.03446267, -0.004992, 0.091683057, 0.12673869,
                    0.1509548, 0.17233488, 0.089525733])
    dij = np.array([
     -0.0200,
      0.1030, 0.0310,
      0.1300, 0.0420, 0.0027,
      0.1350, 0.0910, 0.0085, 0.0017,
      0.1300, 0.0950, 0.0127, 0.0055, 0.0011,
      0.1300, 0.0950, 0.0147, 0.0049, 0.0019, 0.0001,
      0.1250, 0.0950, 0.0179, 0.0067, 0.0028, 0.0002, 0.0003,
      0.1250, 0.0950, 0.0206, 0.0086, 0.0037, 0.0004, 0.0005, 0.0001,
      0.1500, 0.1200, 0.0253, 0.0117, 0.0046, 0.0012, 0.0015, 0.0002, 0.0002,
      0.1500, 0.1200, 0.0321, 0.0166, 0.0078, 0.0031, 0.0035, 0.0012, 0.0013,
      0.0004,
      0.1500, 0.1200, 0.0471, 0.0280, 0.0163, 0.0090, 0.0097, 0.0057, 0.0058,
      0.0036, 0.0016,
      0.1500, 0.1200, 0.0580, 0.0368, 0.0232, 0.0143, 0.0153, 0.0101, 0.0102,
      0.0073, 0.0042, 0.0006,
      0.1500, 0.1200, 0.0667, 0.0440, 0.0291, 0.0191, 0.0202, 0.0142, 0.0144,
      0.0108, 0.0070, 0.0020, 0.0004,
      0.1500, 0.1200, 0.0856, 0.0601, 0.0427, 0.0305, 0.0319, 0.0243, 0.0245,
      0.0199, 0.0146, 0.0067, 0.0032, 0.0014,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='ss', maxiter=18)
    res = flash.run(P, T, yi)
    pass

  def test_42(self):
    P = 45e5
    T = 238.15
    yi = np.array([1.09348396e-4, 1.26630351e-3, 7.72930571e-1, 9.07376834e-2,
                   5.18632702e-2, 1.03370543e-2, 2.01511781e-2, 7.19655884e-3,
                   6.34345569e-3, 1.08977391e-2, 2.14987133e-2, 4.74268201e-3,
                   1.51339170e-3, 4.08740755e-4, 3.309699e-6])
    Pci = np.array([72.8, 33.5, 45.4, 48.2, 41.9, 36.0, 37.5, 33.4, 33.3,
                    32.46, 29.1862, 23.274195, 19.855981, 17.096682,
                    16.23444]) * 101325.
    Tci = np.array([304.2, 126.2, 190.6, 305.4, 369.8, 408.1, 425.2, 460.4,
                    469.6, 507.5, 558.96444, 629.35895, 678.01295, 723.01566,
                    893.91147])
    wi = np.array([0.225, 0.040, 0.008, 0.098, 0.152, 0.176, 0.193, 0.227,
                   0.251, 0.27504, 0.31228, 0.43337435, 0.53091175,
                   0.63045267, 1.0341])
    mwi = np.array([44.010, 28.013, 16.043, 30.070, 44.097, 58.124, 58.124,
                    72.151, 72.151, 86.000, 110.46812, 149.37189, 183.83825,
                    221.96509, 310.37874]) / 1e3
    vsi = np.array([-0.09434672, -0.12838834, -0.2038605, -0.10210346,
                    -0.07330094, -0.05706875, -0.05705589, -0.03446267,
                    -0.03446267, -0.004992, 0.091683057, 0.12673869,
                    0.1509548, 0.17233488, 0.089525733])
    dij = np.array([
     -0.0200,
      0.1030, 0.0310,
      0.1300, 0.0420, 0.0027,
      0.1350, 0.0910, 0.0085, 0.0017,
      0.1300, 0.0950, 0.0127, 0.0055, 0.0011,
      0.1300, 0.0950, 0.0147, 0.0049, 0.0019, 0.0001,
      0.1250, 0.0950, 0.0179, 0.0067, 0.0028, 0.0002, 0.0003,
      0.1250, 0.0950, 0.0206, 0.0086, 0.0037, 0.0004, 0.0005, 0.0001,
      0.1500, 0.1200, 0.0253, 0.0117, 0.0046, 0.0012, 0.0015, 0.0002, 0.0002,
      0.1500, 0.1200, 0.0321, 0.0166, 0.0078, 0.0031, 0.0035, 0.0012, 0.0013,
      0.0004,
      0.1500, 0.1200, 0.0471, 0.0280, 0.0163, 0.0090, 0.0097, 0.0057, 0.0058,
      0.0036, 0.0016,
      0.1500, 0.1200, 0.0580, 0.0368, 0.0232, 0.0143, 0.0153, 0.0101, 0.0102,
      0.0073, 0.0042, 0.0006,
      0.1500, 0.1200, 0.0667, 0.0440, 0.0291, 0.0191, 0.0202, 0.0142, 0.0144,
      0.0108, 0.0070, 0.0020, 0.0004,
      0.1500, 0.1200, 0.0856, 0.0601, 0.0427, 0.0305, 0.0319, 0.0243, 0.0245,
      0.0199, 0.0146, 0.0067, 0.0032, 0.0014,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='qnss', maxiter=28)
    res = flash.run(P, T, yi)
    pass

  def test_43(self):
    P = 45e5
    T = 238.15
    yi = np.array([1.09348396e-4, 1.26630351e-3, 7.72930571e-1, 9.07376834e-2,
                   5.18632702e-2, 1.03370543e-2, 2.01511781e-2, 7.19655884e-3,
                   6.34345569e-3, 1.08977391e-2, 2.14987133e-2, 4.74268201e-3,
                   1.51339170e-3, 4.08740755e-4, 3.309699e-6])
    Pci = np.array([72.8, 33.5, 45.4, 48.2, 41.9, 36.0, 37.5, 33.4, 33.3,
                    32.46, 29.1862, 23.274195, 19.855981, 17.096682,
                    16.23444]) * 101325.
    Tci = np.array([304.2, 126.2, 190.6, 305.4, 369.8, 408.1, 425.2, 460.4,
                    469.6, 507.5, 558.96444, 629.35895, 678.01295, 723.01566,
                    893.91147])
    wi = np.array([0.225, 0.040, 0.008, 0.098, 0.152, 0.176, 0.193, 0.227,
                   0.251, 0.27504, 0.31228, 0.43337435, 0.53091175,
                   0.63045267, 1.0341])
    mwi = np.array([44.010, 28.013, 16.043, 30.070, 44.097, 58.124, 58.124,
                    72.151, 72.151, 86.000, 110.46812, 149.37189, 183.83825,
                    221.96509, 310.37874]) / 1e3
    vsi = np.array([-0.09434672, -0.12838834, -0.2038605, -0.10210346,
                    -0.07330094, -0.05706875, -0.05705589, -0.03446267,
                    -0.03446267, -0.004992, 0.091683057, 0.12673869,
                    0.1509548, 0.17233488, 0.089525733])
    dij = np.array([
     -0.0200,
      0.1030, 0.0310,
      0.1300, 0.0420, 0.0027,
      0.1350, 0.0910, 0.0085, 0.0017,
      0.1300, 0.0950, 0.0127, 0.0055, 0.0011,
      0.1300, 0.0950, 0.0147, 0.0049, 0.0019, 0.0001,
      0.1250, 0.0950, 0.0179, 0.0067, 0.0028, 0.0002, 0.0003,
      0.1250, 0.0950, 0.0206, 0.0086, 0.0037, 0.0004, 0.0005, 0.0001,
      0.1500, 0.1200, 0.0253, 0.0117, 0.0046, 0.0012, 0.0015, 0.0002, 0.0002,
      0.1500, 0.1200, 0.0321, 0.0166, 0.0078, 0.0031, 0.0035, 0.0012, 0.0013,
      0.0004,
      0.1500, 0.1200, 0.0471, 0.0280, 0.0163, 0.0090, 0.0097, 0.0057, 0.0058,
      0.0036, 0.0016,
      0.1500, 0.1200, 0.0580, 0.0368, 0.0232, 0.0143, 0.0153, 0.0101, 0.0102,
      0.0073, 0.0042, 0.0006,
      0.1500, 0.1200, 0.0667, 0.0440, 0.0291, 0.0191, 0.0202, 0.0142, 0.0144,
      0.0108, 0.0070, 0.0020, 0.0004,
      0.1500, 0.1200, 0.0856, 0.0601, 0.0427, 0.0305, 0.0319, 0.0243, 0.0245,
      0.0199, 0.0146, 0.0067, 0.0032, 0.0014,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='newton', maxiter=5)
    res = flash.run(P, T, yi)
    pass

  def test_44(self):
    P = 45e5
    T = 238.15
    yi = np.array([1.09348396e-4, 1.26630351e-3, 7.72930571e-1, 9.07376834e-2,
                   5.18632702e-2, 1.03370543e-2, 2.01511781e-2, 7.19655884e-3,
                   6.34345569e-3, 1.08977391e-2, 2.14987133e-2, 4.74268201e-3,
                   1.51339170e-3, 4.08740755e-4, 3.309699e-6])
    Pci = np.array([72.8, 33.5, 45.4, 48.2, 41.9, 36.0, 37.5, 33.4, 33.3,
                    32.46, 29.1862, 23.274195, 19.855981, 17.096682,
                    16.23444]) * 101325.
    Tci = np.array([304.2, 126.2, 190.6, 305.4, 369.8, 408.1, 425.2, 460.4,
                    469.6, 507.5, 558.96444, 629.35895, 678.01295, 723.01566,
                    893.91147])
    wi = np.array([0.225, 0.040, 0.008, 0.098, 0.152, 0.176, 0.193, 0.227,
                   0.251, 0.27504, 0.31228, 0.43337435, 0.53091175,
                   0.63045267, 1.0341])
    mwi = np.array([44.010, 28.013, 16.043, 30.070, 44.097, 58.124, 58.124,
                    72.151, 72.151, 86.000, 110.46812, 149.37189, 183.83825,
                    221.96509, 310.37874]) / 1e3
    vsi = np.array([-0.09434672, -0.12838834, -0.2038605, -0.10210346,
                    -0.07330094, -0.05706875, -0.05705589, -0.03446267,
                    -0.03446267, -0.004992, 0.091683057, 0.12673869,
                    0.1509548, 0.17233488, 0.089525733])
    dij = np.array([
     -0.0200,
      0.1030, 0.0310,
      0.1300, 0.0420, 0.0027,
      0.1350, 0.0910, 0.0085, 0.0017,
      0.1300, 0.0950, 0.0127, 0.0055, 0.0011,
      0.1300, 0.0950, 0.0147, 0.0049, 0.0019, 0.0001,
      0.1250, 0.0950, 0.0179, 0.0067, 0.0028, 0.0002, 0.0003,
      0.1250, 0.0950, 0.0206, 0.0086, 0.0037, 0.0004, 0.0005, 0.0001,
      0.1500, 0.1200, 0.0253, 0.0117, 0.0046, 0.0012, 0.0015, 0.0002, 0.0002,
      0.1500, 0.1200, 0.0321, 0.0166, 0.0078, 0.0031, 0.0035, 0.0012, 0.0013,
      0.0004,
      0.1500, 0.1200, 0.0471, 0.0280, 0.0163, 0.0090, 0.0097, 0.0057, 0.0058,
      0.0036, 0.0016,
      0.1500, 0.1200, 0.0580, 0.0368, 0.0232, 0.0143, 0.0153, 0.0101, 0.0102,
      0.0073, 0.0042, 0.0006,
      0.1500, 0.1200, 0.0667, 0.0440, 0.0291, 0.0191, 0.0202, 0.0142, 0.0144,
      0.0108, 0.0070, 0.0020, 0.0004,
      0.1500, 0.1200, 0.0856, 0.0601, 0.0427, 0.0305, 0.0319, 0.0243, 0.0245,
      0.0199, 0.0146, 0.0067, 0.0032, 0.0014,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='ss-newton', maxiter=18)
    res = flash.run(P, T, yi)
    pass

  def test_45(self):
    P = 45e5
    T = 238.15
    yi = np.array([1.09348396e-4, 1.26630351e-3, 7.72930571e-1, 9.07376834e-2,
                   5.18632702e-2, 1.03370543e-2, 2.01511781e-2, 7.19655884e-3,
                   6.34345569e-3, 1.08977391e-2, 2.14987133e-2, 4.74268201e-3,
                   1.51339170e-3, 4.08740755e-4, 3.309699e-6])
    Pci = np.array([72.8, 33.5, 45.4, 48.2, 41.9, 36.0, 37.5, 33.4, 33.3,
                    32.46, 29.1862, 23.274195, 19.855981, 17.096682,
                    16.23444]) * 101325.
    Tci = np.array([304.2, 126.2, 190.6, 305.4, 369.8, 408.1, 425.2, 460.4,
                    469.6, 507.5, 558.96444, 629.35895, 678.01295, 723.01566,
                    893.91147])
    wi = np.array([0.225, 0.040, 0.008, 0.098, 0.152, 0.176, 0.193, 0.227,
                   0.251, 0.27504, 0.31228, 0.43337435, 0.53091175,
                   0.63045267, 1.0341])
    mwi = np.array([44.010, 28.013, 16.043, 30.070, 44.097, 58.124, 58.124,
                    72.151, 72.151, 86.000, 110.46812, 149.37189, 183.83825,
                    221.96509, 310.37874]) / 1e3
    vsi = np.array([-0.09434672, -0.12838834, -0.2038605, -0.10210346,
                    -0.07330094, -0.05706875, -0.05705589, -0.03446267,
                    -0.03446267, -0.004992, 0.091683057, 0.12673869,
                    0.1509548, 0.17233488, 0.089525733])
    dij = np.array([
     -0.0200,
      0.1030, 0.0310,
      0.1300, 0.0420, 0.0027,
      0.1350, 0.0910, 0.0085, 0.0017,
      0.1300, 0.0950, 0.0127, 0.0055, 0.0011,
      0.1300, 0.0950, 0.0147, 0.0049, 0.0019, 0.0001,
      0.1250, 0.0950, 0.0179, 0.0067, 0.0028, 0.0002, 0.0003,
      0.1250, 0.0950, 0.0206, 0.0086, 0.0037, 0.0004, 0.0005, 0.0001,
      0.1500, 0.1200, 0.0253, 0.0117, 0.0046, 0.0012, 0.0015, 0.0002, 0.0002,
      0.1500, 0.1200, 0.0321, 0.0166, 0.0078, 0.0031, 0.0035, 0.0012, 0.0013,
      0.0004,
      0.1500, 0.1200, 0.0471, 0.0280, 0.0163, 0.0090, 0.0097, 0.0057, 0.0058,
      0.0036, 0.0016,
      0.1500, 0.1200, 0.0580, 0.0368, 0.0232, 0.0143, 0.0153, 0.0101, 0.0102,
      0.0073, 0.0042, 0.0006,
      0.1500, 0.1200, 0.0667, 0.0440, 0.0291, 0.0191, 0.0202, 0.0142, 0.0144,
      0.0108, 0.0070, 0.0020, 0.0004,
      0.1500, 0.1200, 0.0856, 0.0601, 0.0427, 0.0305, 0.0319, 0.0243, 0.0245,
      0.0199, 0.0146, 0.0067, 0.0032, 0.0014,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='qnss-newton', maxiter=28)
    res = flash.run(P, T, yi)
    pass

  def test_46(self):
    P = 2e6
    T = 258.15
    yi = np.array([8.49690204e-5, 2.20315563e-3, 9.31360141e-1, 4.77686855e-2,
                   1.33133987e-2, 1.58602664e-3, 2.42095466e-3, 4.68831934e-4,
                   3.34433521e-4, 2.82342929e-4, 1.73279904e-4, 3.62280482e-6,
                   1.52954183e-7, 4.80259710e-9, 7.42408981e-18])
    Pci = np.array([72.8, 33.5, 45.4, 48.2, 41.9, 36.0, 37.5, 33.4, 33.3,
                    32.46, 29.1862, 23.274195, 19.855981, 17.096682,
                    16.23444]) * 101325.
    Tci = np.array([304.2, 126.2, 190.6, 305.4, 369.8, 408.1, 425.2, 460.4,
                    469.6, 507.5, 558.96444, 629.35895, 678.01295, 723.01566,
                    893.91147])
    wi = np.array([0.225, 0.040, 0.008, 0.098, 0.152, 0.176, 0.193, 0.227,
                   0.251, 0.27504, 0.31228, 0.43337435, 0.53091175,
                   0.63045267, 1.0341])
    mwi = np.array([44.010, 28.013, 16.043, 30.070, 44.097, 58.124, 58.124,
                    72.151, 72.151, 86.000, 110.46812, 149.37189, 183.83825,
                    221.96509, 310.37874]) / 1e3
    vsi = np.array([-0.09434672, -0.12838834, -0.2038605, -0.10210346,
                    -0.07330094, -0.05706875, -0.05705589, -0.03446267,
                    -0.03446267, -0.004992, 0.091683057, 0.12673869,
                    0.1509548, 0.17233488, 0.089525733])
    dij = np.array([
     -0.0200,
      0.1030, 0.0310,
      0.1300, 0.0420, 0.0027,
      0.1350, 0.0910, 0.0085, 0.0017,
      0.1300, 0.0950, 0.0127, 0.0055, 0.0011,
      0.1300, 0.0950, 0.0147, 0.0049, 0.0019, 0.0001,
      0.1250, 0.0950, 0.0179, 0.0067, 0.0028, 0.0002, 0.0003,
      0.1250, 0.0950, 0.0206, 0.0086, 0.0037, 0.0004, 0.0005, 0.0001,
      0.1500, 0.1200, 0.0253, 0.0117, 0.0046, 0.0012, 0.0015, 0.0002, 0.0002,
      0.1500, 0.1200, 0.0321, 0.0166, 0.0078, 0.0031, 0.0035, 0.0012, 0.0013,
      0.0004,
      0.1500, 0.1200, 0.0471, 0.0280, 0.0163, 0.0090, 0.0097, 0.0057, 0.0058,
      0.0036, 0.0016,
      0.1500, 0.1200, 0.0580, 0.0368, 0.0232, 0.0143, 0.0153, 0.0101, 0.0102,
      0.0073, 0.0042, 0.0006,
      0.1500, 0.1200, 0.0667, 0.0440, 0.0291, 0.0191, 0.0202, 0.0142, 0.0144,
      0.0108, 0.0070, 0.0020, 0.0004,
      0.1500, 0.1200, 0.0856, 0.0601, 0.0427, 0.0305, 0.0319, 0.0243, 0.0245,
      0.0199, 0.0146, 0.0067, 0.0032, 0.0014,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='ss', maxiter=11)
    res = flash.run(P, T, yi)
    pass

  def test_47(self):
    P = 2e6
    T = 258.15
    yi = np.array([8.49690204e-5, 2.20315563e-3, 9.31360141e-1, 4.77686855e-2,
                   1.33133987e-2, 1.58602664e-3, 2.42095466e-3, 4.68831934e-4,
                   3.34433521e-4, 2.82342929e-4, 1.73279904e-4, 3.62280482e-6,
                   1.52954183e-7, 4.80259710e-9, 7.42408981e-18])
    Pci = np.array([72.8, 33.5, 45.4, 48.2, 41.9, 36.0, 37.5, 33.4, 33.3,
                    32.46, 29.1862, 23.274195, 19.855981, 17.096682,
                    16.23444]) * 101325.
    Tci = np.array([304.2, 126.2, 190.6, 305.4, 369.8, 408.1, 425.2, 460.4,
                    469.6, 507.5, 558.96444, 629.35895, 678.01295, 723.01566,
                    893.91147])
    wi = np.array([0.225, 0.040, 0.008, 0.098, 0.152, 0.176, 0.193, 0.227,
                   0.251, 0.27504, 0.31228, 0.43337435, 0.53091175,
                   0.63045267, 1.0341])
    mwi = np.array([44.010, 28.013, 16.043, 30.070, 44.097, 58.124, 58.124,
                    72.151, 72.151, 86.000, 110.46812, 149.37189, 183.83825,
                    221.96509, 310.37874]) / 1e3
    vsi = np.array([-0.09434672, -0.12838834, -0.2038605, -0.10210346,
                    -0.07330094, -0.05706875, -0.05705589, -0.03446267,
                    -0.03446267, -0.004992, 0.091683057, 0.12673869,
                    0.1509548, 0.17233488, 0.089525733])
    dij = np.array([
     -0.0200,
      0.1030, 0.0310,
      0.1300, 0.0420, 0.0027,
      0.1350, 0.0910, 0.0085, 0.0017,
      0.1300, 0.0950, 0.0127, 0.0055, 0.0011,
      0.1300, 0.0950, 0.0147, 0.0049, 0.0019, 0.0001,
      0.1250, 0.0950, 0.0179, 0.0067, 0.0028, 0.0002, 0.0003,
      0.1250, 0.0950, 0.0206, 0.0086, 0.0037, 0.0004, 0.0005, 0.0001,
      0.1500, 0.1200, 0.0253, 0.0117, 0.0046, 0.0012, 0.0015, 0.0002, 0.0002,
      0.1500, 0.1200, 0.0321, 0.0166, 0.0078, 0.0031, 0.0035, 0.0012, 0.0013,
      0.0004,
      0.1500, 0.1200, 0.0471, 0.0280, 0.0163, 0.0090, 0.0097, 0.0057, 0.0058,
      0.0036, 0.0016,
      0.1500, 0.1200, 0.0580, 0.0368, 0.0232, 0.0143, 0.0153, 0.0101, 0.0102,
      0.0073, 0.0042, 0.0006,
      0.1500, 0.1200, 0.0667, 0.0440, 0.0291, 0.0191, 0.0202, 0.0142, 0.0144,
      0.0108, 0.0070, 0.0020, 0.0004,
      0.1500, 0.1200, 0.0856, 0.0601, 0.0427, 0.0305, 0.0319, 0.0243, 0.0245,
      0.0199, 0.0146, 0.0067, 0.0032, 0.0014,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='qnss', maxiter=8)
    res = flash.run(P, T, yi)
    pass

  def test_48(self):
    P = 2e6
    T = 258.15
    yi = np.array([8.49690204e-5, 2.20315563e-3, 9.31360141e-1, 4.77686855e-2,
                   1.33133987e-2, 1.58602664e-3, 2.42095466e-3, 4.68831934e-4,
                   3.34433521e-4, 2.82342929e-4, 1.73279904e-4, 3.62280482e-6,
                   1.52954183e-7, 4.80259710e-9, 7.42408981e-18])
    Pci = np.array([72.8, 33.5, 45.4, 48.2, 41.9, 36.0, 37.5, 33.4, 33.3,
                    32.46, 29.1862, 23.274195, 19.855981, 17.096682,
                    16.23444]) * 101325.
    Tci = np.array([304.2, 126.2, 190.6, 305.4, 369.8, 408.1, 425.2, 460.4,
                    469.6, 507.5, 558.96444, 629.35895, 678.01295, 723.01566,
                    893.91147])
    wi = np.array([0.225, 0.040, 0.008, 0.098, 0.152, 0.176, 0.193, 0.227,
                   0.251, 0.27504, 0.31228, 0.43337435, 0.53091175,
                   0.63045267, 1.0341])
    mwi = np.array([44.010, 28.013, 16.043, 30.070, 44.097, 58.124, 58.124,
                    72.151, 72.151, 86.000, 110.46812, 149.37189, 183.83825,
                    221.96509, 310.37874]) / 1e3
    vsi = np.array([-0.09434672, -0.12838834, -0.2038605, -0.10210346,
                    -0.07330094, -0.05706875, -0.05705589, -0.03446267,
                    -0.03446267, -0.004992, 0.091683057, 0.12673869,
                    0.1509548, 0.17233488, 0.089525733])
    dij = np.array([
     -0.0200,
      0.1030, 0.0310,
      0.1300, 0.0420, 0.0027,
      0.1350, 0.0910, 0.0085, 0.0017,
      0.1300, 0.0950, 0.0127, 0.0055, 0.0011,
      0.1300, 0.0950, 0.0147, 0.0049, 0.0019, 0.0001,
      0.1250, 0.0950, 0.0179, 0.0067, 0.0028, 0.0002, 0.0003,
      0.1250, 0.0950, 0.0206, 0.0086, 0.0037, 0.0004, 0.0005, 0.0001,
      0.1500, 0.1200, 0.0253, 0.0117, 0.0046, 0.0012, 0.0015, 0.0002, 0.0002,
      0.1500, 0.1200, 0.0321, 0.0166, 0.0078, 0.0031, 0.0035, 0.0012, 0.0013,
      0.0004,
      0.1500, 0.1200, 0.0471, 0.0280, 0.0163, 0.0090, 0.0097, 0.0057, 0.0058,
      0.0036, 0.0016,
      0.1500, 0.1200, 0.0580, 0.0368, 0.0232, 0.0143, 0.0153, 0.0101, 0.0102,
      0.0073, 0.0042, 0.0006,
      0.1500, 0.1200, 0.0667, 0.0440, 0.0291, 0.0191, 0.0202, 0.0142, 0.0144,
      0.0108, 0.0070, 0.0020, 0.0004,
      0.1500, 0.1200, 0.0856, 0.0601, 0.0427, 0.0305, 0.0319, 0.0243, 0.0245,
      0.0199, 0.0146, 0.0067, 0.0032, 0.0014,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='newton', maxiter=4)
    res = flash.run(P, T, yi)
    pass

  def test_49(self):
    P = 2e6
    T = 258.15
    yi = np.array([8.49690204e-5, 2.20315563e-3, 9.31360141e-1, 4.77686855e-2,
                   1.33133987e-2, 1.58602664e-3, 2.42095466e-3, 4.68831934e-4,
                   3.34433521e-4, 2.82342929e-4, 1.73279904e-4, 3.62280482e-6,
                   1.52954183e-7, 4.80259710e-9, 7.42408981e-18])
    Pci = np.array([72.8, 33.5, 45.4, 48.2, 41.9, 36.0, 37.5, 33.4, 33.3,
                    32.46, 29.1862, 23.274195, 19.855981, 17.096682,
                    16.23444]) * 101325.
    Tci = np.array([304.2, 126.2, 190.6, 305.4, 369.8, 408.1, 425.2, 460.4,
                    469.6, 507.5, 558.96444, 629.35895, 678.01295, 723.01566,
                    893.91147])
    wi = np.array([0.225, 0.040, 0.008, 0.098, 0.152, 0.176, 0.193, 0.227,
                   0.251, 0.27504, 0.31228, 0.43337435, 0.53091175,
                   0.63045267, 1.0341])
    mwi = np.array([44.010, 28.013, 16.043, 30.070, 44.097, 58.124, 58.124,
                    72.151, 72.151, 86.000, 110.46812, 149.37189, 183.83825,
                    221.96509, 310.37874]) / 1e3
    vsi = np.array([-0.09434672, -0.12838834, -0.2038605, -0.10210346,
                    -0.07330094, -0.05706875, -0.05705589, -0.03446267,
                    -0.03446267, -0.004992, 0.091683057, 0.12673869,
                    0.1509548, 0.17233488, 0.089525733])
    dij = np.array([
     -0.0200,
      0.1030, 0.0310,
      0.1300, 0.0420, 0.0027,
      0.1350, 0.0910, 0.0085, 0.0017,
      0.1300, 0.0950, 0.0127, 0.0055, 0.0011,
      0.1300, 0.0950, 0.0147, 0.0049, 0.0019, 0.0001,
      0.1250, 0.0950, 0.0179, 0.0067, 0.0028, 0.0002, 0.0003,
      0.1250, 0.0950, 0.0206, 0.0086, 0.0037, 0.0004, 0.0005, 0.0001,
      0.1500, 0.1200, 0.0253, 0.0117, 0.0046, 0.0012, 0.0015, 0.0002, 0.0002,
      0.1500, 0.1200, 0.0321, 0.0166, 0.0078, 0.0031, 0.0035, 0.0012, 0.0013,
      0.0004,
      0.1500, 0.1200, 0.0471, 0.0280, 0.0163, 0.0090, 0.0097, 0.0057, 0.0058,
      0.0036, 0.0016,
      0.1500, 0.1200, 0.0580, 0.0368, 0.0232, 0.0143, 0.0153, 0.0101, 0.0102,
      0.0073, 0.0042, 0.0006,
      0.1500, 0.1200, 0.0667, 0.0440, 0.0291, 0.0191, 0.0202, 0.0142, 0.0144,
      0.0108, 0.0070, 0.0020, 0.0004,
      0.1500, 0.1200, 0.0856, 0.0601, 0.0427, 0.0305, 0.0319, 0.0243, 0.0245,
      0.0199, 0.0146, 0.0067, 0.0032, 0.0014,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='ss-newton', maxiter=11)
    res = flash.run(P, T, yi)
    pass

  def test_50(self):
    P = 2e6
    T = 258.15
    yi = np.array([8.49690204e-5, 2.20315563e-3, 9.31360141e-1, 4.77686855e-2,
                   1.33133987e-2, 1.58602664e-3, 2.42095466e-3, 4.68831934e-4,
                   3.34433521e-4, 2.82342929e-4, 1.73279904e-4, 3.62280482e-6,
                   1.52954183e-7, 4.80259710e-9, 7.42408981e-18])
    Pci = np.array([72.8, 33.5, 45.4, 48.2, 41.9, 36.0, 37.5, 33.4, 33.3,
                    32.46, 29.1862, 23.274195, 19.855981, 17.096682,
                    16.23444]) * 101325.
    Tci = np.array([304.2, 126.2, 190.6, 305.4, 369.8, 408.1, 425.2, 460.4,
                    469.6, 507.5, 558.96444, 629.35895, 678.01295, 723.01566,
                    893.91147])
    wi = np.array([0.225, 0.040, 0.008, 0.098, 0.152, 0.176, 0.193, 0.227,
                   0.251, 0.27504, 0.31228, 0.43337435, 0.53091175,
                   0.63045267, 1.0341])
    mwi = np.array([44.010, 28.013, 16.043, 30.070, 44.097, 58.124, 58.124,
                    72.151, 72.151, 86.000, 110.46812, 149.37189, 183.83825,
                    221.96509, 310.37874]) / 1e3
    vsi = np.array([-0.09434672, -0.12838834, -0.2038605, -0.10210346,
                    -0.07330094, -0.05706875, -0.05705589, -0.03446267,
                    -0.03446267, -0.004992, 0.091683057, 0.12673869,
                    0.1509548, 0.17233488, 0.089525733])
    dij = np.array([
     -0.0200,
      0.1030, 0.0310,
      0.1300, 0.0420, 0.0027,
      0.1350, 0.0910, 0.0085, 0.0017,
      0.1300, 0.0950, 0.0127, 0.0055, 0.0011,
      0.1300, 0.0950, 0.0147, 0.0049, 0.0019, 0.0001,
      0.1250, 0.0950, 0.0179, 0.0067, 0.0028, 0.0002, 0.0003,
      0.1250, 0.0950, 0.0206, 0.0086, 0.0037, 0.0004, 0.0005, 0.0001,
      0.1500, 0.1200, 0.0253, 0.0117, 0.0046, 0.0012, 0.0015, 0.0002, 0.0002,
      0.1500, 0.1200, 0.0321, 0.0166, 0.0078, 0.0031, 0.0035, 0.0012, 0.0013,
      0.0004,
      0.1500, 0.1200, 0.0471, 0.0280, 0.0163, 0.0090, 0.0097, 0.0057, 0.0058,
      0.0036, 0.0016,
      0.1500, 0.1200, 0.0580, 0.0368, 0.0232, 0.0143, 0.0153, 0.0101, 0.0102,
      0.0073, 0.0042, 0.0006,
      0.1500, 0.1200, 0.0667, 0.0440, 0.0291, 0.0191, 0.0202, 0.0142, 0.0144,
      0.0108, 0.0070, 0.0020, 0.0004,
      0.1500, 0.1200, 0.0856, 0.0601, 0.0427, 0.0305, 0.0319, 0.0243, 0.0245,
      0.0199, 0.0146, 0.0067, 0.0032, 0.0014,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='qnss-newton', maxiter=8)
    res = flash.run(P, T, yi)
    pass

  def test_51(self):
    P = 4.5e6
    T = 238.15
    yi = np.array([0.08037349969389081, 0.8731640355072774,
                   0.03129584275269201, 0.01050302225662305,
                   0.0034581124227530307, 0.0011035520489154843,
                   0.00010119955717969182, 7.3575307429679e-07,
                   1.0071857164316409e-11])
    Pci = np.array([32.789, 45.4, 48.2, 41.9, 37.022, 33.008, 20.794, 16.727,
                    11.698]) * 101325.
    Tci = np.array([122.141, 190.6, 305.4, 369.8, 419.746, 482.781, 547.033,
                    674.011, 833.580])
    wi = np.array([0.02946, 0.008, 0.098, 0.152, 0.18767, 0.25456, 0.31931,
                   0.32841, 0.43005])
    vsi = np.array([-0.15670, -0.18633, -0.15018, -0.11403, -0.07789,
                    -0.02655, 0.01541, 0.10440, 0.22653])
    mwi = np.array([27.385, 16.043, 30.070, 44.097, 58.124, 77.671, 103.418,
                    185.177, 298.021]) / 1e3
    dij = np.array([
      0.00030,
      0.00035, 0.00566,
      0.00043, 0.01884, 0.00296,
      0.00121, 0.02884, 0.00874, 0.00087,
      0.00150, 0.04275, 0.01812, 0.00824, 0.00211,
      0.00176, 0.06061, 0.03113, 0.02758, 0.01329, 0.00564,
      0.00418, 0.15956, 0.10787, 0.07426, 0.04277, 0.02351, -0.00126,
      0.00630, 0.19705, 0.13549, 0.08406, 0.05104, 0.02627, -0.01284,-0.01087,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='ss', maxiter=14)
    res = flash.run(P, T, yi)
    pass

  def test_52(self):
    P = 4.5e6
    T = 238.15
    yi = np.array([0.08037349969389081, 0.8731640355072774,
                   0.03129584275269201, 0.01050302225662305,
                   0.0034581124227530307, 0.0011035520489154843,
                   0.00010119955717969182, 7.3575307429679e-07,
                   1.0071857164316409e-11])
    Pci = np.array([32.789, 45.4, 48.2, 41.9, 37.022, 33.008, 20.794, 16.727,
                    11.698]) * 101325.
    Tci = np.array([122.141, 190.6, 305.4, 369.8, 419.746, 482.781, 547.033,
                    674.011, 833.580])
    wi = np.array([0.02946, 0.008, 0.098, 0.152, 0.18767, 0.25456, 0.31931,
                   0.32841, 0.43005])
    vsi = np.array([-0.15670, -0.18633, -0.15018, -0.11403, -0.07789,
                    -0.02655, 0.01541, 0.10440, 0.22653])
    mwi = np.array([27.385, 16.043, 30.070, 44.097, 58.124, 77.671, 103.418,
                    185.177, 298.021]) / 1e3
    dij = np.array([
      0.00030,
      0.00035, 0.00566,
      0.00043, 0.01884, 0.00296,
      0.00121, 0.02884, 0.00874, 0.00087,
      0.00150, 0.04275, 0.01812, 0.00824, 0.00211,
      0.00176, 0.06061, 0.03113, 0.02758, 0.01329, 0.00564,
      0.00418, 0.15956, 0.10787, 0.07426, 0.04277, 0.02351, -0.00126,
      0.00630, 0.19705, 0.13549, 0.08406, 0.05104, 0.02627, -0.01284,-0.01087,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='qnss', maxiter=12)
    res = flash.run(P, T, yi)
    pass

  def test_53(self):
    P = 4.5e6
    T = 238.15
    yi = np.array([0.08037349969389081, 0.8731640355072774,
                   0.03129584275269201, 0.01050302225662305,
                   0.0034581124227530307, 0.0011035520489154843,
                   0.00010119955717969182, 7.3575307429679e-07,
                   1.0071857164316409e-11])
    Pci = np.array([32.789, 45.4, 48.2, 41.9, 37.022, 33.008, 20.794, 16.727,
                    11.698]) * 101325.
    Tci = np.array([122.141, 190.6, 305.4, 369.8, 419.746, 482.781, 547.033,
                    674.011, 833.580])
    wi = np.array([0.02946, 0.008, 0.098, 0.152, 0.18767, 0.25456, 0.31931,
                   0.32841, 0.43005])
    vsi = np.array([-0.15670, -0.18633, -0.15018, -0.11403, -0.07789,
                    -0.02655, 0.01541, 0.10440, 0.22653])
    mwi = np.array([27.385, 16.043, 30.070, 44.097, 58.124, 77.671, 103.418,
                    185.177, 298.021]) / 1e3
    dij = np.array([
      0.00030,
      0.00035, 0.00566,
      0.00043, 0.01884, 0.00296,
      0.00121, 0.02884, 0.00874, 0.00087,
      0.00150, 0.04275, 0.01812, 0.00824, 0.00211,
      0.00176, 0.06061, 0.03113, 0.02758, 0.01329, 0.00564,
      0.00418, 0.15956, 0.10787, 0.07426, 0.04277, 0.02351, -0.00126,
      0.00630, 0.19705, 0.13549, 0.08406, 0.05104, 0.02627, -0.01284,-0.01087,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='newton', maxiter=4)
    res = flash.run(P, T, yi)
    pass

  def test_54(self):
    P = 4.5e6
    T = 238.15
    yi = np.array([0.08037349969389081, 0.8731640355072774,
                   0.03129584275269201, 0.01050302225662305,
                   0.0034581124227530307, 0.0011035520489154843,
                   0.00010119955717969182, 7.3575307429679e-07,
                   1.0071857164316409e-11])
    Pci = np.array([32.789, 45.4, 48.2, 41.9, 37.022, 33.008, 20.794, 16.727,
                    11.698]) * 101325.
    Tci = np.array([122.141, 190.6, 305.4, 369.8, 419.746, 482.781, 547.033,
                    674.011, 833.580])
    wi = np.array([0.02946, 0.008, 0.098, 0.152, 0.18767, 0.25456, 0.31931,
                   0.32841, 0.43005])
    vsi = np.array([-0.15670, -0.18633, -0.15018, -0.11403, -0.07789,
                    -0.02655, 0.01541, 0.10440, 0.22653])
    mwi = np.array([27.385, 16.043, 30.070, 44.097, 58.124, 77.671, 103.418,
                    185.177, 298.021]) / 1e3
    dij = np.array([
      0.00030,
      0.00035, 0.00566,
      0.00043, 0.01884, 0.00296,
      0.00121, 0.02884, 0.00874, 0.00087,
      0.00150, 0.04275, 0.01812, 0.00824, 0.00211,
      0.00176, 0.06061, 0.03113, 0.02758, 0.01329, 0.00564,
      0.00418, 0.15956, 0.10787, 0.07426, 0.04277, 0.02351, -0.00126,
      0.00630, 0.19705, 0.13549, 0.08406, 0.05104, 0.02627, -0.01284,-0.01087,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='ss-newton', maxiter=14)
    res = flash.run(P, T, yi)
    pass

  def test_55(self):
    P = 4.5e6
    T = 238.15
    yi = np.array([0.08037349969389081, 0.8731640355072774,
                   0.03129584275269201, 0.01050302225662305,
                   0.0034581124227530307, 0.0011035520489154843,
                   0.00010119955717969182, 7.3575307429679e-07,
                   1.0071857164316409e-11])
    Pci = np.array([32.789, 45.4, 48.2, 41.9, 37.022, 33.008, 20.794, 16.727,
                    11.698]) * 101325.
    Tci = np.array([122.141, 190.6, 305.4, 369.8, 419.746, 482.781, 547.033,
                    674.011, 833.580])
    wi = np.array([0.02946, 0.008, 0.098, 0.152, 0.18767, 0.25456, 0.31931,
                   0.32841, 0.43005])
    vsi = np.array([-0.15670, -0.18633, -0.15018, -0.11403, -0.07789,
                    -0.02655, 0.01541, 0.10440, 0.22653])
    mwi = np.array([27.385, 16.043, 30.070, 44.097, 58.124, 77.671, 103.418,
                    185.177, 298.021]) / 1e3
    dij = np.array([
      0.00030,
      0.00035, 0.00566,
      0.00043, 0.01884, 0.00296,
      0.00121, 0.02884, 0.00874, 0.00087,
      0.00150, 0.04275, 0.01812, 0.00824, 0.00211,
      0.00176, 0.06061, 0.03113, 0.02758, 0.01329, 0.00564,
      0.00418, 0.15956, 0.10787, 0.07426, 0.04277, 0.02351, -0.00126,
      0.00630, 0.19705, 0.13549, 0.08406, 0.05104, 0.02627, -0.01284,-0.01087,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij)
    flash = flash2pPT(pr, method='qnss-newton', maxiter=6)
    res = flash.run(P, T, yi)
    pass

  def test_56(self):
    P = 7e6
    T = 223.15
    yi = np.array([0.0392035, 0.4310085, 0.016666, 0.0066165, 0.003006,
                   0.002318, 0.0009595, 0.000216, 6e-6, 0.5])
    Pci = np.array([32.789, 45.4, 48.2, 41.9, 37.022, 33.008, 20.794, 16.727,
                    11.698, 217.6]) * 101325.
    Tci = np.array([122.141, 190.6, 305.4, 369.8, 419.746, 482.781, 547.033,
                    674.011, 833.580, 647.3])
    wi = np.array([0.02946, 0.008, 0.098, 0.152, 0.18767, 0.25456, 0.31931,
                   0.32841, 0.43005, 0.344])
    vsi = np.array([-0.15670, -0.18633, -0.15018, -0.11403, -0.07789,
                    -0.02655, 0.01541, 0.10440, 0.22653, 0.232])
    mwi = np.array([27.385, 16.043, 30.070, 44.097, 58.124, 77.671, 103.418,
                    185.177, 298.021, 18.015]) / 1e3
    dij = np.array([
      0.00030,
      0.00035, 0.00566,
      0.00043, 0.01884, 0.00296,
      0.00121, 0.02884, 0.00874, 0.00087,
      0.00150, 0.04275, 0.01812, 0.00824, 0.00211,
      0.00176, 0.06061, 0.03113, 0.02758, 0.01329, 0.00564,
      0.00418, 0.15956, 0.10787, 0.07426, 0.04277, 0.02351, -0.00126,
      0.00630, 0.19705, 0.13549, 0.08406, 0.05104, 0.02627, -0.01284,
      -0.01087,
      0.11000, 0.49070, 0.54690, 0.48000, 0.48000, 0.48000,  0.48000,
       0.48000, 0.48000,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij, kvlevel=3)
    flash = flash2pPT(pr, method='ss', maxiter=4)
    res = flash.run(P, T, yi)
    pass

  def test_57(self):
    P = 7e6
    T = 223.15
    yi = np.array([0.0392035, 0.4310085, 0.016666, 0.0066165, 0.003006,
                   0.002318, 0.0009595, 0.000216, 6e-6, 0.5])
    Pci = np.array([32.789, 45.4, 48.2, 41.9, 37.022, 33.008, 20.794, 16.727,
                    11.698, 217.6]) * 101325.
    Tci = np.array([122.141, 190.6, 305.4, 369.8, 419.746, 482.781, 547.033,
                    674.011, 833.580, 647.3])
    wi = np.array([0.02946, 0.008, 0.098, 0.152, 0.18767, 0.25456, 0.31931,
                   0.32841, 0.43005, 0.344])
    vsi = np.array([-0.15670, -0.18633, -0.15018, -0.11403, -0.07789,
                    -0.02655, 0.01541, 0.10440, 0.22653, 0.232])
    mwi = np.array([27.385, 16.043, 30.070, 44.097, 58.124, 77.671, 103.418,
                    185.177, 298.021, 18.015]) / 1e3
    dij = np.array([
      0.00030,
      0.00035, 0.00566,
      0.00043, 0.01884, 0.00296,
      0.00121, 0.02884, 0.00874, 0.00087,
      0.00150, 0.04275, 0.01812, 0.00824, 0.00211,
      0.00176, 0.06061, 0.03113, 0.02758, 0.01329, 0.00564,
      0.00418, 0.15956, 0.10787, 0.07426, 0.04277, 0.02351, -0.00126,
      0.00630, 0.19705, 0.13549, 0.08406, 0.05104, 0.02627, -0.01284,
      -0.01087,
      0.11000, 0.49070, 0.54690, 0.48000, 0.48000, 0.48000,  0.48000,
       0.48000, 0.48000,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij, kvlevel=3)
    flash = flash2pPT(pr, method='qnss', maxiter=53)
    res = flash.run(P, T, yi)
    pass

  def test_58(self):
    P = 7e6
    T = 223.15
    yi = np.array([0.0392035, 0.4310085, 0.016666, 0.0066165, 0.003006,
                   0.002318, 0.0009595, 0.000216, 6e-6, 0.5])
    Pci = np.array([32.789, 45.4, 48.2, 41.9, 37.022, 33.008, 20.794, 16.727,
                    11.698, 217.6]) * 101325.
    Tci = np.array([122.141, 190.6, 305.4, 369.8, 419.746, 482.781, 547.033,
                    674.011, 833.580, 647.3])
    wi = np.array([0.02946, 0.008, 0.098, 0.152, 0.18767, 0.25456, 0.31931,
                   0.32841, 0.43005, 0.344])
    vsi = np.array([-0.15670, -0.18633, -0.15018, -0.11403, -0.07789,
                    -0.02655, 0.01541, 0.10440, 0.22653, 0.232])
    mwi = np.array([27.385, 16.043, 30.070, 44.097, 58.124, 77.671, 103.418,
                    185.177, 298.021, 18.015]) / 1e3
    dij = np.array([
      0.00030,
      0.00035, 0.00566,
      0.00043, 0.01884, 0.00296,
      0.00121, 0.02884, 0.00874, 0.00087,
      0.00150, 0.04275, 0.01812, 0.00824, 0.00211,
      0.00176, 0.06061, 0.03113, 0.02758, 0.01329, 0.00564,
      0.00418, 0.15956, 0.10787, 0.07426, 0.04277, 0.02351, -0.00126,
      0.00630, 0.19705, 0.13549, 0.08406, 0.05104, 0.02627, -0.01284,
      -0.01087,
      0.11000, 0.49070, 0.54690, 0.48000, 0.48000, 0.48000,  0.48000,
       0.48000, 0.48000,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij, kvlevel=3)
    flash = flash2pPT(pr, method='ss-newton', maxiter=4)
    res = flash.run(P, T, yi)
    pass

  def test_59(self):
    P = 7e6
    T = 223.15
    yi = np.array([0.0392035, 0.4310085, 0.016666, 0.0066165, 0.003006,
                   0.002318, 0.0009595, 0.000216, 6e-6, 0.5])
    Pci = np.array([32.789, 45.4, 48.2, 41.9, 37.022, 33.008, 20.794, 16.727,
                    11.698, 217.6]) * 101325.
    Tci = np.array([122.141, 190.6, 305.4, 369.8, 419.746, 482.781, 547.033,
                    674.011, 833.580, 647.3])
    wi = np.array([0.02946, 0.008, 0.098, 0.152, 0.18767, 0.25456, 0.31931,
                   0.32841, 0.43005, 0.344])
    vsi = np.array([-0.15670, -0.18633, -0.15018, -0.11403, -0.07789,
                    -0.02655, 0.01541, 0.10440, 0.22653, 0.232])
    mwi = np.array([27.385, 16.043, 30.070, 44.097, 58.124, 77.671, 103.418,
                    185.177, 298.021, 18.015]) / 1e3
    dij = np.array([
      0.00030,
      0.00035, 0.00566,
      0.00043, 0.01884, 0.00296,
      0.00121, 0.02884, 0.00874, 0.00087,
      0.00150, 0.04275, 0.01812, 0.00824, 0.00211,
      0.00176, 0.06061, 0.03113, 0.02758, 0.01329, 0.00564,
      0.00418, 0.15956, 0.10787, 0.07426, 0.04277, 0.02351, -0.00126,
      0.00630, 0.19705, 0.13549, 0.08406, 0.05104, 0.02627, -0.01284,
      -0.01087,
      0.11000, 0.49070, 0.54690, 0.48000, 0.48000, 0.48000,  0.48000,
       0.48000, 0.48000,
    ])
    pr = pr78(Pci, Tci, wi, mwi, vsi, dij, kvlevel=3)
    flash = flash2pPT(pr, method='qnss-newton', maxiter=53)
    res = flash.run(P, T, yi)
    pass


if __name__ == '__main__':
  unittest.main(verbosity=0)
