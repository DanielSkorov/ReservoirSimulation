
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Определение стабильности фазового состояния системы &#8212; Основы моделирования пластовых систем</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=7710e7f8" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '1-PVT/3-SEC/SEC-1-Stability';</script>
    <script src="../../_static/custom.js?v=ebf3e302"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Уравнение Речфорда-Райса" href="SEC-2-RR.html" />
    <link rel="prev" title="Стабильность. Равновесие. Критическое состояние" href="SEC-0-Introduction.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../Introduction.html">
  
  
  
  
  
  
    <p class="title logo__title">Основы моделирования пластовых систем</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../Introduction.html">
                    Основы моделирования пластовых систем
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Основы вычислительной математики</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../0-Math/Math-Introduction.html">Введение</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../0-Math/0-LAB/LAB-0-Introduction.html">Основы линейной алгебры</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../0-Math/0-LAB/LAB-1-Vectors.html">Вектор. Координаты вектора</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../0-Math/0-LAB/LAB-2-VectorOperations.html">Операции с векторами</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../0-Math/0-LAB/LAB-3-RotationAngles.html">Направляющие косинусы</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../0-Math/0-LAB/LAB-4-Matrices.html">Матрицы</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../0-Math/0-LAB/LAB-5-Determinant-InverseMatrix.html">Определитель матрицы. Обратная матрица</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../0-Math/0-LAB/LAB-6-MatrixEquation.html">Матричные уравнения</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../0-Math/0-LAB/LAB-7-Eigenvalues-Eigenvectors.html">Собственные векторы и значения матриц</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../0-Math/0-LAB/LAB-8-LinearTransformations.html">Линейные преобразования</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../0-Math/1-OM/OM-0-Introduction.html">Методы оптимизации функций</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PVT-моделирование</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../PVT-Introduction.html">Введение</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../1-TD/TD-0-Introduction.html">Основы термодинамики</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-1-Basics.html">Введение в термодинамику</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-2-ThermalEquilibrium.html">Термическое равновесие. Температура. Нулевое начало термодинамики</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-3-Heat-Work.html">Количество теплоты и работа. Первое начало термодинамики</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-4-HeatCapacity.html">Теплоемкость</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-5-Enthalpy.html">Энтальпия</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-6-Entropy.html">Энтропия. Второе и третье начала термодинамики</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-7-ChemicalPotential.html">Химический потенциал</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-8-Helmholtz-Gibbs.html">Энергия Гельмгольца. Энергия Гиббса</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-9-Observables.html">Интенсивные и экстенсивные параметры</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-10-MixtureGibbsEnergy.html">Энергия Гиббса многокомпонентной системы</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-11-GibbsPhaseRule.html">Правило фаз Гиббса</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-12-GibbsDuhemEquation.html">Уравнение Гиббса-Дюгема</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-13-MaxwellRelations.html">Соотношения Максвелла</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-14-PhaseEquilibrium.html">Свободная энергия и фазовое равновесие</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-TD/TD-15-Fugacity.html">Летучесть</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../2-EOS/EOS-0-Introduction.html">Уравнения состояния</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../2-EOS/EOS-1-VanDerWaals.html">Уравнение состояния Ван-дер-Ваальса</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-EOS/EOS-2-SRK-PR.html">Уравнения состояния Суаве-Редлиха-Квонга и Пенга-Робинсона</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-EOS/EOS-3-CPA.html">Кубическое уравнение состояние с учетом ассоциации молекул</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-EOS/EOS-Appendix-A-PD.html">Частные производные летучести компонентов</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-EOS/EOS-Appendix-B-BIP.html">Универсальный расчет коэффициентов попарного взаимодействия</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="SEC-0-Introduction.html">Стабильность. Равновесие. Критическое состояние</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Определение стабильности фазового состояния системы</a></li>
<li class="toctree-l2"><a class="reference internal" href="SEC-2-RR.html">Уравнение Речфорда-Райса</a></li>
<li class="toctree-l2"><a class="reference internal" href="SEC-3-RR-2P.html">Уравнение Речфорда-Райса для двухфазных систем</a></li>
<li class="toctree-l2"><a class="reference internal" href="SEC-4-RR-NP.html">Уравнение Речфорда-Райса для многофазных систем</a></li>
<li class="toctree-l2"><a class="reference internal" href="SEC-5-Equilibrium.html">Определение равновесного состояния системы</a></li>
<li class="toctree-l2"><a class="reference internal" href="SEC-6-Saturation.html">Определение насыщенного состояния системы</a></li>
<li class="toctree-l2"><a class="reference internal" href="SEC-7-Criticality.html">Определение критического состояния системы</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/1-PVT/3-SEC/SEC-1-Stability.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Определение стабильности фазового состояния системы</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pt">PT-термодинамика</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vt">VT-термодинамика</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="pvt-sec-stability">
<span id="id1"></span><h1>Определение стабильности фазового состояния системы<a class="headerlink" href="#pvt-sec-stability" title="Link to this heading">#</a></h1>
<p>В данном разделе будут представлены критерии стабильности фазового состояния системы, позволяющие определить, является ли рассматриваемое фазовое состояние системы стабильным для различных формулировок (<a class="reference internal" href="#pvt-sec-stability-pt">PT-термодинамика</a> и <a class="reference internal" href="#pvt-sec-stability-vt"><span class="std std-ref">VT-термодинамика</span></a>), а также численные алгоритмы и их реализации. Выбор той или иной формулировки зачастую определяется теми переменными, через которые удобнее выражать уравнение состояния. Проверка стабильности фазового равновесия является первым из двух последовательных шагов к определению равновесного фазового состояния системы.</p>
<section id="pt">
<span id="pvt-sec-stability-pt"></span><h2>PT-термодинамика<a class="headerlink" href="#pt" title="Link to this heading">#</a></h2>
<p>Пусть некоторая многокомпонентная макроскопическая система находится в равновесном состоянии и характеризуется давлением <span class="math notranslate nohighlight">\(P\)</span>, температурой <span class="math notranslate nohighlight">\(T\)</span> и количеством вещества всех компонентов <span class="math notranslate nohighlight">\(n_i, \; i=1..N_c\)</span>, где <span class="math notranslate nohighlight">\(N_c\)</span> – число компонентов, составляющих рассматриваемую систему. Можем ли мы использовать некоторое уравнение состояния для описания взаимосвязей между термодинамическими параметрами? Ответ на этот вопрос зависит от того, является ли рассматриваемая система гомогенной, то есть состоящей из одной сплошной фазы. Иными словами, является ли однофазное состояние рассматриваемой системы <em>стабильным</em>. Именно исследованию данного вопроса будет посвящен настоящий раздел. Однако, прежде чем переходить к рассмотрению темы стабильности фазового состояния системы, необходимо ввести ряд определений. Некоторые из них будут перекликаться с рассмотренными ранее темами, но при этом являться более обобщенными. Теоретическое изложение рассматриваемой проблемы соответствует работе [<a class="reference external" href="https://doi.org/10.2118/9806-PA">Baker et al, 1982</a>].</p>
<div class="tip admonition">
<p class="admonition-title">Определение</p>
<p>Пусть имеется некоторая <span class="math notranslate nohighlight">\(j\)</span>-ая фаза, многофазной системы, состоящая из <span class="math notranslate nohighlight">\(N_c\)</span> компонентов, при этом количество вещества компонентов в фазе <span class="math notranslate nohighlight">\(j\)</span> определяется следующим <a class="reference internal" href="../../0-Math/0-LAB/LAB-1-Vectors.html"><span class="std std-doc">вектором</span></a>:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \mathbf{n}^j = \begin{bmatrix} n_1^j \\ n_2^j \\ \vdots \\ n_{N_c}^j \end{bmatrix}. \end{split}\]</div>
<p>Если количество вещества компонентов в системе в целом определяется вектором</p>
<div class="math notranslate nohighlight">
\[\begin{split} \mathbf{n} = \begin{bmatrix} n_1 \\ n_2 \\ \vdots \\ n_{N_c} \end{bmatrix}, \end{split}\]</div>
<p>то фаза <span class="math notranslate nohighlight">\(j\)</span> является <em><strong>допустимой</strong></em> <em>(admissible)</em>, если</p>
<div class="math notranslate nohighlight">
\[ 0 &lt; n_i^j &lt; n_i, \; i = 1 \ldots N_c.\]</div>
</div>
<p>Иными словами, фаза является <em>допустимой</em>, если количество вещества каждого компонента, в нее входящего, меньше количества вещества этого же компонента в системе в целом. Все дальнейшие выкладки будут касаться допустимых фаз, в которых представлены все компоненты, не взаимодействующие друг с другом с образованием новых компонентов, то есть не вступающие в реакции. Кроме того, необходимо отметить, что здесь и далее нижний индекс будет характеризовать некоторый компонент, а верхних – некоторую фазу. Для допустимых фаз справедливо следущее соотношение:</p>
<div class="math notranslate nohighlight">
\[ \sum_{j=1}^{N_p} n_i^j = n_i, \]</div>
<p>где <span class="math notranslate nohighlight">\(N_p\)</span> – количество фаз в системе. При известных и заданных давлении и температуре рассматриваемой системы, а также количествах вещества компонентов в ней <a class="reference internal" href="../1-TD/TD-10-MixtureGibbsEnergy.html"><span class="std std-doc">энергия Гиббса</span></a> некоторой фазы определяется количеством вещества каждого компонента в фазе, то есть:</p>
<div class="math notranslate nohighlight">
\[ G^j = G^j \left( \mathbf{n}^j \right). \]</div>
<p>Учитывая <a class="reference internal" href="../1-TD/TD-9-Observables.html#pvt-td-observables-extensive"><span class="std std-ref">экстенсивность</span></a> энергии Гиббса, для многофазной системы справедливо следующее соотношение:</p>
<div class="math notranslate nohighlight">
\[ G \left( \mathbf{n} \right) = G \left( \mathbf{n}^1, \, \mathbf{n}^2, \, \ldots \, , \mathbf{n}^j \right) = \sum_{j=1}^{N_p} G^j \left( \mathbf{n}^j \right). \]</div>
<div class="tip admonition">
<p class="admonition-title">Определение</p>
<p>Некоторое <span class="math notranslate nohighlight">\(\hat{K}\)</span> состояние системы, характеризующееся <span class="math notranslate nohighlight">\(N_p\)</span> количеством <em>допустимых</em> фаз, удовлетворяющих закону сохранения масс, является <em><strong>равновесным</strong></em>, если:</p>
<div class="math notranslate nohighlight">
\[ G \left( \hat{K} \right) = \min_l G^l \left( \hat{L} \right), \]</div>
<p>где минимум берется по всем состояниям <span class="math notranslate nohighlight">\(\hat{L}\)</span>, характеризующимся <span class="math notranslate nohighlight">\(K_p\)</span> количеством <em>допустимых</em> фаз, удовлетворяющих закону сохранения масс.</p>
</div>
<p>В данном определении необходимо отметить два момента. Первый: <em>равновесное состояние</em> характеризуется минимумом энергии Гиббса всей многофазной системы. Более подробно это рассматривалось <a class="reference internal" href="../1-TD/TD-14-PhaseEquilibrium.html"><span class="std std-doc">ранее</span></a>. Второй: для того чтобы доказать, что некоторое состояние <span class="math notranslate nohighlight">\(\hat{K}\)</span> многофазной системы из <span class="math notranslate nohighlight">\(N_p\)</span> является <em>равновесным</em>, мы можем рассмотреть множество других состояний <span class="math notranslate nohighlight">\(\hat{L}\)</span>, каждое из которых будет характеризоваться своим количеством фаз <span class="math notranslate nohighlight">\(K_p\)</span>, и если в состоянии <span class="math notranslate nohighlight">\(\hat{K}\)</span> с количеством фаз <span class="math notranslate nohighlight">\(N_p\)</span> энергия Гиббса меньше всего, то оно и будет равновесным.</p>
<p>Представленное в предыдущем определении условие идентификации равновесного состояния, по сути, аналогично условию нахождения <a class="reference external" href="https://en.wikipedia.org/wiki/Maximum_and_minimum">глобального минимума функции</a>. <a class="reference external" href="https://en.wikipedia.org/wiki/First_derivative_test">Известно</a>, что необходимым условием для соответствия некоторого точки (состояния) глобальному минимуму функции (энергии Гиббса) является равенство нулю производной в этой точке (этом состоянии). Такое состояние, в котором энергия Гиббса всей многофазной многокомпонентной системы характеризуется равенством нулю частной производной по количеству вещества <span class="math notranslate nohighlight">\(i\)</span>-го компонента в <span class="math notranslate nohighlight">\(j\)</span>-ой фазе при фиксированных давлении и температуре будет характеризоваться равенством химических потенциалов соответствующих компонентов в фазах.</p>
<div class="danger admonition">
<p class="admonition-title">Теорема</p>
<p>Пусть многофазная многокомпонентная система находится при фиксированных давлении <span class="math notranslate nohighlight">\(P\)</span>, температуре <span class="math notranslate nohighlight">\(T\)</span> и количествах вещества компонентов в ней <span class="math notranslate nohighlight">\(n_i, \; i=1 \, \ldots \, N_c\)</span> в некотором состоянии <span class="math notranslate nohighlight">\(\hat{K}\)</span> с количеством фаз <span class="math notranslate nohighlight">\(N_p\)</span> с соответствующими количествами вещества компонентов <span class="math notranslate nohighlight">\(n_i^j, \; i = 1 \, \ldots \, N_c, \; j = 1 \, \ldots \, N_p\)</span>. При этом, в этом состоянии частная производная энергии Гиббса всей системы по <span class="math notranslate nohighlight">\(n_i^j\)</span> равна нулю:</p>
<div class="math notranslate nohighlight">
\[ \left( \frac{\partial G}{\partial n_i^j} \right)_{P,T,n_k^l,k \neq i, l \neq j} = 0. \]</div>
<p>Тогда для такого состояния системы будет справедливо следующее равенство:</p>
<div class="math notranslate nohighlight">
\[ \mu_i^j = \mu_i^{N_p}, \; i = 1 \, \ldots \, N_c, \; j = 1 \, \ldots \, N_p. \]</div>
</div>
<p>Докажем  это следующим образом.</p>
<div class="proof admonition">
<p class="admonition-title">Доказательство</p>
<p>Учитывая экстенсивность энергии Гиббса, преобразуем частную производную энергии Гиббса всей системы по <span class="math notranslate nohighlight">\(n_i^j\)</span> следующим образом:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align}
\left( \frac{\partial G}{\partial n_i^j} \right)_{P,T,n_k^l, k \neq i, l \neq j}
&amp;= \frac{\partial}{\partial n_i^j} \left( \sum_{l=1}^{N_p} G^l \left( n_k^l \right) \right)_{P,T,n_k^l, k \neq i, l \neq j} \\
&amp;= \frac{\partial}{\partial n_i^j} \left( \sum_{l=1}^{N_p-1} G^l \left( n_k^l \right) \right)_{P,T,n_k^l, k \neq i, l \neq j} + \left( \frac{\partial G^{N_p} \left( n_k^{N_p} \right)}{\partial n_i^j} \right)_{P,T,n_k^{N_p},k \neq i} \\
&amp;= \sum_{l=1}^{N_p-1} \left( \frac{\partial G^l \left( n_k^l \right)}{\partial n_i^j} \right)_{P,T,n_k^l, k \neq i, l \neq j} + \left( \frac{\partial G^{N_p} \left( n_k^{N_p} \right)}{\partial n_i^j} \right)_{P,T,n_k^{N_p},k \neq i}.
\end{align} \end{split}\]</div>
<p>Принимая во внимание, что энергия Гиббса <span class="math notranslate nohighlight">\(j\)</span>-й фазы зависит от количеств вещества компонентов в этой <span class="math notranslate nohighlight">\(j\)</span>-й фазе, то есть:</p>
<div class="math notranslate nohighlight">
\[ \left( \frac{\partial G^l \left( n_k^l \right)}{\partial n_i^j} \right)_{P,T,n_k^l, k \neq i, l \neq j} = 0, \; l \neq j, \]</div>
<p>частная производная энергии Гиббса всей системы по <span class="math notranslate nohighlight">\(n_i^j\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \left( \frac{\partial G}{\partial n_i^j} \right)_{P,T,n_k^l, k \neq i, l \neq j} = \left( \frac{\partial G^j \left( n_k^j \right)}{\partial n_i^j} \right)_{P,T,n_k^j, k \neq i} + \left( \frac{\partial G^{N_p} \left( n_k^{N_p} \right)}{\partial n_i^j} \right)_{P,T,n_k^{N_p},k \neq i}. \]</div>
<p>Учитывая правило нахождение сложной функции, данное выражение преобразуется следующим образом:</p>
<div class="math notranslate nohighlight">
\[ \left( \frac{\partial G}{\partial n_i^j} \right)_{P,T,n_k^l, k \neq i, l \neq j} = \left( \frac{\partial G^j \left( n_k^j \right)}{\partial n_i^j} \right)_{P,T,n_k^j, k \neq i} + \left( \frac{\partial n_k^{N_p}}{\partial n_i^j} \right)_{P,T,n_k^{N_p},k \neq i} \left( \frac{\partial G^{N_p} \left( n_k^{N_p} \right)}{\partial n_k^{N_p}} \right)_{P,T,n_k^{N_p},k \neq i}. \]</div>
<p>Выразим из закона сохранения масс количество вещества <span class="math notranslate nohighlight">\(k\)</span>-го компонента в <span class="math notranslate nohighlight">\(N_p\)</span>-й фазе:</p>
<div class="math notranslate nohighlight">
\[ \sum_{l=1}^{N_p} n_k^l = n_k \Rightarrow n_k^{N_p} = n_k - \sum_{l=1}^{N_p-1} n_k^l. \]</div>
<p>Тогда частная прозводная количества вещества <span class="math notranslate nohighlight">\(k\)</span>-го компонента в <span class="math notranslate nohighlight">\(l\)</span>-й фазе по количеству вещества <span class="math notranslate nohighlight">\(i\)</span>-го компонента в <span class="math notranslate nohighlight">\(j\)</span>-ой фазе:</p>
<div class="math notranslate nohighlight">
\[ \left( \frac{\partial n_k^{N_p}}{\partial n_i^j} \right)_{P,T,n_k^{N_p},k \neq i} = \left( \frac{\partial n_k}{\partial n_i^j} \right)_{P,T,n_k^{N_p},k \neq i} - \sum_{l=1}^{N_p-1} \left( \frac{\partial n_k^l}{\partial n_i^j} \right)_{P,T,n_k^l,k \neq i,l \neq j} \]</div>
<p>Первое слагаемое в данном выражении равно нулю, поскольку количество вещества каждого компонента в системе в целом зафиксировано. Второе слагаемое можно представить следующим образом:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \left( \frac{\partial n_k^l}{\partial n_i^j} \right)_{P,T,n_k^l,k \neq i,l \neq j} = \begin{cases} 1 &amp; \mathrm{if} \; k=i \land l=j, \; k=1 \ldots N_c, \, l=1 \ldots N_p, \\ 0 &amp; \mathrm{if} \; k \neq i \lor l \neq j, \; k=1 \ldots N_c, \, l=1 \ldots N_p. \end{cases} \end{split}\]</div>
<p>Таким образом,</p>
<div class="math notranslate nohighlight">
\[\begin{split} \left( \frac{\partial n_k^{N_p}}{\partial n_i^j} \right)_{P,T,n_k^{N_p},k \neq i} = \begin{cases} -1 &amp; \mathrm{if} \; k=i \land j=N_p, \\ 0 &amp; \mathrm{if} \; k \neq i \lor j \neq N_p. \end{cases} \end{split}\]</div>
<p>С учетом этого частная производная энергии Гиббса всей системы по <span class="math notranslate nohighlight">\(n_i^j\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \left( \frac{\partial G}{\partial n_i^j} \right)_{P,T,n_k^l, k \neq i, l \neq j} = \left( \frac{\partial G^j \left( n_k^j \right)}{\partial n_i^j} \right)_{P,T,n_k^j, k \neq i} - \left( \frac{\partial G^{N_p} \left( n_k^{N_p} \right)}{\partial n_i^{N_p}} \right)_{P,T,n_k^{N_p},k \neq i} = 0. \]</div>
<p>Поскольку частная производная энергии Гиббса некоторой фазы по количеству вещества <span class="math notranslate nohighlight">\(i\)</span>-го компонента в этой фазе при фиксированных давлении и температуре <a class="reference internal" href="../1-TD/TD-10-MixtureGibbsEnergy.html"><span class="std std-doc">соответствует</span></a> химическому потенциалу <span class="math notranslate nohighlight">\(i\)</span>-го компонента в этой фазе, то:</p>
<div class="math notranslate nohighlight">
\[ \mu_i^j - \mu_i^{N_p} = 0, \; i = 1 \, \ldots \, N_c, \; j = 1 \, \ldots \, N_p. \]</div>
</div>
<p><a class="reference internal" href="../1-TD/TD-15-Fugacity.html#pvt-td-fugacity-equilibrium"><span class="std std-ref">Ранее</span></a> было показано, что для изотермического квази-стационарного процесса равенство химических потенциалов равносильно равенству летучестей.</p>
<p>Поскольу условие равенства нулю частной производной энергии Гиббса системы в целом по количеству вещества <span class="math notranslate nohighlight">\(i\)</span>-го компонента в <span class="math notranslate nohighlight">\(j\)</span>-ой фазе при фиксированных давлении и температуре является необходимым, но не достаточным, то рассматриваемая система может характеризоваться набором состояний, удовлетворяющих данному условию. Такие состояния будем называть <em>стационарными</em>.</p>
<div class="tip admonition">
<p class="admonition-title">Определение</p>
<p>Cостояние <span class="math notranslate nohighlight">\(\hat{L} = \left\{ \mathbf{n}^j, \; j = 1 \, \ldots K_p \right\}\)</span> является <em><strong>стационарным</strong></em>, если:</p>
<div class="math notranslate nohighlight">
\[ \left( \frac{\partial G}{\partial n_i^j} \right)_{P,T,n_k^l,k \neq i, l \neq j} = 0, \; i=1 \, \ldots \, N_c, \; j = 1 \, \ldots K_p. \]</div>
</div>
<p>Таким образом, для того чтобы доказать, что некоторое состояние является равновесным, нет необходимости перебирать бесконечное множество всех возможных состояний системы – достаточно рассмотреть конечное множество стационарных состояний системы.</p>
<p>Центральным для анализа стабильности фазового состояния системы является положение, определяющее, что стационарное состояние системы может быть определено путем идентификации общих точек касательной <a class="reference external" href="https://en.wikipedia.org/wiki/Hyperplane">гиперплоскости</a> к <a class="reference external" href="https://en.wikipedia.org/wiki/Hypersurface">гиперповерхности</a>, представленной функцией энергии Гиббса. Приставки “гипер” необходимы при рассмотрении <span class="math notranslate nohighlight">\(N_c\)</span>-мерного пространства. Например, для двух компонентов функция энергии Гиббса представляет собой кривую на плоскости, касательной к которой является прямая. Для трех компонентов функция энергии Гиббса представляет собой поверхность, а касательная к ней – плоскость. Для <span class="math notranslate nohighlight">\(N_c\)</span> компонентов функция энергии Гиббса – гиперповерхность, касательная к ней – гиперплоскость. Далее под поверхностью и плоскостью будут пониматься именно гиперповерхность и гиперплоскость соответственно.</p>
<div class="danger admonition">
<p class="admonition-title">Теорема</p>
<p>Пусть <span class="math notranslate nohighlight">\(\hat{K}\)</span> является некоторым состоянием системы, состоящей из <span class="math notranslate nohighlight">\(N_p\)</span> допустимых фаз, удовлетворяющих закону сохранения масс, с известным количеством вещества компонентов в фазах <span class="math notranslate nohighlight">\(\mathbf{n}^j, \; j = 1 \, \ldots \, N_p\)</span>. Тогда <span class="math notranslate nohighlight">\(G \left( \hat{K} \right)\)</span> является стационарной точкой тогда и только тогда, когда <span class="math notranslate nohighlight">\(G\)</span> дифференциируема для всех <span class="math notranslate nohighlight">\(\mathbf{n}^j\)</span> и поверхность <span class="math notranslate nohighlight">\(G\)</span> имеет одинаковую касательную плоскость для каждого <span class="math notranslate nohighlight">\(\mathbf{n}^j\)</span>.</p>
</div>
<p>Приведем доказательство данной теоремы.</p>
<div class="proof admonition">
<p class="admonition-title">Доказательство</p>
<p>Пусть <span class="math notranslate nohighlight">\(L^j \left( \mathbf{r} \right)\)</span> является касательной плоскостью к поверхности <span class="math notranslate nohighlight">\(G \left( \mathbf{r} \right)\)</span> в точке <span class="math notranslate nohighlight">\(\mathbf{n}^j\)</span>, являющейся стационарной. Тогда <a class="reference external" href="https://en.wikipedia.org/wiki/Tangent">уравнение касательной</a> плоскости <span class="math notranslate nohighlight">\(L^j \left( \mathbf{r} \right)\)</span> к поверхности <span class="math notranslate nohighlight">\(G \left( \mathbf{r} \right)\)</span> в точке <span class="math notranslate nohighlight">\(\mathbf{n}^j\)</span> описывается следующим выражением:</p>
<div class="math notranslate nohighlight">
\[ L^j \left( \mathbf{r} \right) = G \left( \mathbf{n}^j \right) + \sum_{i=1}^{N_c} \frac{\partial G}{\partial r_i} \bigg|_{n_i^j} \left( r_i - n_i^j \right). \]</div>
<p>Так как энергия Гиббса является экстенсивным параметром, то при фиксированных давлении и температуре для нее выполняется следующее <a class="reference internal" href="../1-TD/TD-10-MixtureGibbsEnergy.html"><span class="std std-doc">свойство</span></a>:</p>
<div class="math notranslate nohighlight">
\[ G \left( \mathbf{n}^j \right) = \sum_{i=1}^{N_c} \frac{\partial G}{\partial r_i} \bigg|_{n_i^j} n_i^j = \sum_{i=1}^{N_c} \mu_i^j n_i^j. \]</div>
<p>Подставляя данное выражение в уравнение касательной поверхности, получим:</p>
<div class="math notranslate nohighlight">
\[ L^j \left( \mathbf{r} \right) = \sum_{i=1}^{N_c} \frac{\partial G}{\partial r_i} \bigg|_{n_i^j} n_i^j + \sum_{i=1}^{N_c} \frac{\partial G}{\partial r_i} \bigg|_{n_i^j} r_i - \sum_{i=1}^{N_c} \frac{\partial G}{\partial r_i} \bigg|_{n_i^j} n_i^j = \sum_{i=1}^{N_c} \frac{\partial G}{\partial r_i} \bigg|_{n_i^j} r_i = \sum_{i=1}^{N_c} \mu_i^j r_i. \]</div>
<p>Поскольку для стационарного состояния выполняется условие постоянства химического потенциала компонентов, то есть химический потенциал каждого компонента не зависит от фазы, то есть <span class="math notranslate nohighlight">\(\mu_i^j = \mu_i^{N_p}, \; i = 1 \, \ldots \, N_c, \; j = 1 \, \ldots \, N_p-1\)</span> в соответствии с приведенной выше леммой, то <span class="math notranslate nohighlight">\(L^j \left( \mathbf{r} \right)\)</span> также не будет зависеть от фазы <span class="math notranslate nohighlight">\(j\)</span>, следовательно, для всех <span class="math notranslate nohighlight">\(j\)</span> в стационарном состоянии уравнение касательной плоскости к поверхности энергии Гиббса одинаково. Верно и обратное: если все <span class="math notranslate nohighlight">\(L^j\)</span> одинаковы, то химические потенциалы компонентов равны, и состояние является стационарным.</p>
</div>
<p>Представленная выше теорема говорит о том, что в стационарном состоянии <span class="math notranslate nohighlight">\(\hat{K}\)</span> касательная плоскость <span class="math notranslate nohighlight">\(L^j \left( \mathbf{r} \right)\)</span> к поверхности энергии Гиббса <span class="math notranslate nohighlight">\(G \left( \mathbf{r} \right)\)</span> одинакова для всех составов фаз <span class="math notranslate nohighlight">\(\mathbf{n}^j, \; j = 1 \, \ldots \, N_p\)</span>, выражающих рассматриваемое стационарное состояние <span class="math notranslate nohighlight">\(\hat{K} = \left\{ \mathbf{n}^j, \; j = 1 \, \ldots N_p \right\}\)</span>. Однако в конечном счете нам необходимо определить стабильность (равновесность) стационарного состояния. Для понимания того, является ли рассматриваемое стационарное состояние равновесным, необходимо ввести следующие обозначения.</p>
<p>Пусть <span class="math notranslate nohighlight">\(D \left( \mathbf{r} \right)\)</span> является функцией разности между энергией Гиббса <span class="math notranslate nohighlight">\(G \left( \mathbf{r} \right)\)</span> и функцией касательной плоскости к ней <span class="math notranslate nohighlight">\(L \left( \mathbf{r} \right)\)</span>:</p>
<div class="math notranslate nohighlight">
\[ D \left( \mathbf{r} \right) = G \left( \mathbf{r} \right) - L \left( \mathbf{r} \right). \]</div>
<p>Для равновесного состояния (которое также является стационарным) в соответствии с представленной выше леммой преобразуем уравнение касательной плоскости:</p>
<div class="math notranslate nohighlight">
\[ D \left( \mathbf{r} \right) = G \left( \mathbf{r} \right) - \sum_{i=1}^{N_c} \mu_i r_i.\]</div>
<p>Далее будет показано, что при любых значениях <span class="math notranslate nohighlight">\(\mathbf{r}\)</span> в равновесном состоянии функция <span class="math notranslate nohighlight">\(D \left( \mathbf{r} \right)\)</span> не принимает отрицательных значений. Однако прежде чем переходить к доказательству этого утверждения необходимо рассмотреть следующую лемму:</p>
<div class="danger admonition">
<p class="admonition-title">Лемма</p>
<p>Разница между энергией Гиббса системы в <em>любом состоянии</em>, состоящей из <span class="math notranslate nohighlight">\(K_p\)</span> приемлемых фаз, компонентный состав которых <span class="math notranslate nohighlight">\(\mathbf{r}^k, \; k = 1 \, \ldots \, K_p\)</span>, и удовлетворяющих закону сохранения масс, и энергией Гиббса в <em>стационарном состоянии</em> с <span class="math notranslate nohighlight">\(N_p\)</span> приемлемыми фазами, компонентный состав которых <span class="math notranslate nohighlight">\(\mathbf{n}^j, \; j = 1 \, \ldots \, N_p\)</span>, причем <span class="math notranslate nohighlight">\(K_p\)</span> может быть неравно <span class="math notranslate nohighlight">\(N_p\)</span>, есть сумма <span class="math notranslate nohighlight">\(D \left( \mathbf{r}^k \right)\)</span> по количеству фаз <span class="math notranslate nohighlight">\(K_p\)</span>, то есть:</p>
<div class="math notranslate nohighlight">
\[ \sum_{k=1}^{K_p} G \left( \mathbf{r}^k \right) - \sum_{j=1}^{N_p} G \left( \mathbf{n}^j \right) = \sum_{k=1}^{K_p} D \left( \mathbf{r}^k \right). \]</div>
</div>
<p>Доказательство:</p>
<div class="proof admonition">
<p class="admonition-title">Доказательство</p>
<p>Поскольку система одна и та же, то выполняется закон сохранения масс:</p>
<div class="math notranslate nohighlight">
\[ n_i = \sum_{j=1}^{N_p} n_i^j = \sum_{k=1}^{K_p} r_i^k, \; i = 1 \, \ldots \, N_c. \]</div>
<p>Для стационарного состояния характерно постоянство химического потенциала компонента <span class="math notranslate nohighlight">\(\mu_i^j\)</span> среди всех фаз <span class="math notranslate nohighlight">\(j = 1 \ldots N_p\)</span>. То есть справедливо следующее равенство:</p>
<div class="math notranslate nohighlight">
\[ \mu_i^j = \mu_i^{N_p}, \; i = 1 \, \ldots \, N_c, \; j = 1 \, \ldots \, N_p. \]</div>
<p>Следовательно:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align}
\sum_{j=1}^{N_p} G \left( \mathbf{n}^j \right)
&amp;= \sum_{j=1}^{N_p} \sum_{i=1}^{N_c} \mu_i^j n_i^j \\
&amp;= \sum_{j=1}^{N_p} \sum_{i=1}^{N_c} \mu_i^1 n_i^j \\
&amp;= \sum_{i=1}^{N_c} \mu_i^1 \sum_{j=1}^{N_p} n_i^j \\
&amp;= \sum_{i=1}^{N_c} \mu_i^1 \sum_{k=1}^{K_p} r_i^k \\
&amp;= \sum_{k=1}^{K_p} \sum_{i=1}^{N_c} \mu_i^1 r_i^k \\
&amp;= \sum_{k=1}^{K_p} L \left( \mathbf{r}^k \right).
\end{align} \end{split}\]</div>
<p>Тогда</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align}
\sum_{k=1}^{K_p} G \left( \mathbf{r}^k \right) - \sum_{j=1}^{N_p} G \left( \mathbf{n}^j \right)
&amp; = \sum_{k=1}^{K_p} G \left( \mathbf{r}^k \right) - \sum_{k=1}^{K_p} L \left( \mathbf{r}^k \right) \\
&amp; = \sum_{k=1}^{K_p} \left( G \left( \mathbf{r}^k \right) - L \left( \mathbf{r}^k \right) \right) \\
&amp; = \sum_{k=1}^{K_p} D \left( \mathbf{r}^k \right).
\end{align} \end{split}\]</div>
</div>
<p>Теперь можем перейти к доказательству основной теоремы:</p>
<div class="danger admonition">
<p class="admonition-title">Теорема</p>
<p>Пусть система находится в некотором <em>стационарном</em> состоянии с количеством вещества в фазах <span class="math notranslate nohighlight">\(\mathbf{n}^j, j = 1 \, \ldots \, N_p\)</span>, причем значение энергии Гиббса для всех значений <span class="math notranslate nohighlight">\(\mathbf{r}^k\)</span> (количеств вещества компонентов в фазах <span class="math notranslate nohighlight">\(k, \; k = 1 \, \ldots \, K_p\)</span>) больше или равно касательной плоскости <span class="math notranslate nohighlight">\(L \left( \mathbf{r}^k \right)\)</span>, иными словами <span class="math notranslate nohighlight">\(D \left( \mathbf{r}^k \right) \geq 0, \; k = 1 \, \ldots \, K_p\)</span>, тогда данное стационарное состояние является <em><strong>равновесным</strong></em>.</p>
</div>
<p>Докажем данную теорему.</p>
<div class="proof admonition">
<p class="admonition-title">Доказательство</p>
<p>Рассмотрим любое состояние системы с количеством вещества <span class="math notranslate nohighlight">\(\mathbf{r}^k, \; k = 1 \, \ldots \, K_p\)</span>. Тогда из условия <span class="math notranslate nohighlight">\(D \left( \mathbf{r}^k \right) \geq 0, \; k = 1 \, \ldots \, K_p\)</span> следует, что</p>
<div class="math notranslate nohighlight">
\[ \sum_{k=1}^{K_p} D \left( \mathbf{r}^k \right) \geq 0. \]</div>
<p>Согласно доказанной ранее лемме, данное неравество можно записать следующим образом:</p>
<div class="math notranslate nohighlight">
\[ \sum_{k=1}^{K_p} G \left( \mathbf{r}^k \right) - \sum_{j=1}^{N_p} G \left( \mathbf{n}^j \right) \geq 0. \]</div>
<p>Или:</p>
<div class="math notranslate nohighlight">
\[ \sum_{j=1}^{N_p} G \left( \mathbf{n}^j \right) \leq \sum_{k=1}^{K_p} G \left( \mathbf{r}^k \right). \]</div>
<p>То есть для любых <span class="math notranslate nohighlight">\(\mathbf{r}^k, \; k = 1 \, \ldots \, K_p\)</span> энергия Гиббса системы получается больше, чем при <span class="math notranslate nohighlight">\(\mathbf{n}^j\)</span>, то есть состояние с <span class="math notranslate nohighlight">\(\mathbf{n}^j\)</span> характеризуется наименьшей энергией Гиббса, следовательно, оно является равновесным по определению.</p>
</div>
<p>В результате доказательства этой теоремы данное ранее определение равновесного состояния, как состояния, характеризующегося наименьшей энергией Гиббса, можно переформулировать следующим образом:</p>
<div class="tip admonition">
<p class="admonition-title">Определение</p>
<p><em><strong>Равновесным состоянием</strong></em> называется такое <em>стационарное</em> состояние системы, при котором касательная гиперплоскость к гиперповерхности энергии Гиббса, проведенная в точке с компонентным составом этого состояния, не пересекает гиперповерхность энергии Гиббса в любых других точках.</p>
</div>
<p>Таким образом, анализ стабильности некотрого стационарного состояния многофазной многокомпонентной системы можно проводить посредством исследования функции <span class="math notranslate nohighlight">\(D \left( \mathbf{r}^k \right)\)</span>, определяемой расстоянием от гиперповерхности энергии Гиббса до касательной гиперплоскости, проведенной в точке с рассматриваемым стационарным состоянием. Эту функцию обычно называют <em>TPD – tangent plane distance</em>. Прежде чем переходить к рассмотрению примеров анализа стабильности необходимо необходимо отметить, что для квази-стационарного изотермического процесса <a class="reference internal" href="../1-TD/TD-15-Fugacity.html"><span class="std std-doc">справедливо</span></a> следующее преобразование:</p>
<div class="math notranslate nohighlight">
\[ \sum_{j=1}^{N_p} G \left( \mathbf{n}^j \right) = \sum_{j=1}^{N_p} \sum_{i=1}^{N_c} \mu_i^j n_i^j = R T \sum_{j=1}^{N_p} \sum_{i=1}^{N_c} n_i^j \ln f_i^j. \]</div>
<p>Тогда <em>приведенная энергия Гиббса</em>:</p>
<div class="math notranslate nohighlight">
\[ \sum_{j=1}^{N_p} \tilde{G} \left( \mathbf{n^j} \right) = \sum_{j=1}^{N_p} \sum_{i=1}^{N_c} n_i^j \ln f_i^j. \]</div>
<p>Рассмотрим применение анализа стабильности с использованием функции <em>TPD</em> на следующих примерах.</p>
<div class="exercise admonition">
<p class="admonition-title">Пример</p>
<p>Пусть имеется <span class="math notranslate nohighlight">\(1 \; моль\)</span> смеси из метана и диоксида углерода при температуре <span class="math notranslate nohighlight">\(40 \; ^{\circ} C\)</span> и давлении <span class="math notranslate nohighlight">\(2 \; МПа\)</span> с мольной долей метана <span class="math notranslate nohighlight">\(0.85\)</span>. Необходимо определить, является ли однофазное состояние данной системы стабильным.</p>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Решение</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Для решения данной задачи будем использовать <a class="reference internal" href="../2-EOS/EOS-2-SRK-PR.html"><span class="std std-doc">уравнение состояния Пенга-Робинсона</span></a>, реализованное <a class="reference external" href="https://github.com/DanielSkorov/ReservoirSimulation/blob/main/_src/eos.py">здесь</a>.</p>
<p class="sd-card-text">Зададим исходные термобарические условия и компонентный состав.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">2e6</span><span class="p">)</span> <span class="c1"># Pressure [Pa]</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">40.</span> <span class="o">+</span> <span class="mf">273.15</span><span class="p">)</span> <span class="c1"># Temperature [K]</span>
<span class="n">yi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">.15</span><span class="p">,</span> <span class="mf">.85</span><span class="p">])</span> <span class="c1"># Mole fractions [fr.]</span>
</pre></div>
</div>
<p class="sd-card-text">Зададим свойства компонентов, необходимые для уравнения состояния Пенга-Робинсона.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Pci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">7.37646</span><span class="p">,</span> <span class="mf">4.600155</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1e6</span> <span class="c1"># Critical pressures [Pa]</span>
<span class="n">Tci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">304.2</span><span class="p">,</span> <span class="mf">190.6</span><span class="p">])</span> <span class="c1"># Critical temperatures [K]</span>
<span class="n">wi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">.225</span><span class="p">,</span> <span class="mf">.008</span><span class="p">])</span> <span class="c1"># Acentric factors</span>
<span class="n">vsi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span> <span class="c1"># Volume shift parameters</span>
<span class="n">dij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">.025</span><span class="p">])</span> <span class="c1"># Binary interaction parameters</span>
</pre></div>
</div>
<p class="sd-card-text">Импортируем класс с уравнением состояния и проинициализируем его.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;../../_src/&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">eos</span> <span class="kn">import</span> <span class="n">pr78</span>
<span class="n">pr</span> <span class="o">=</span> <span class="n">pr78</span><span class="p">(</span><span class="n">Pci</span><span class="p">,</span> <span class="n">Tci</span><span class="p">,</span> <span class="n">wi</span><span class="p">,</span> <span class="n">vsi</span><span class="p">,</span> <span class="n">dij</span><span class="p">)</span>
</pre></div>
</div>
<p class="sd-card-text">Выполним расчет приведенной энергии Гиббса для всех возможных компонентных составов рассматриваемой смеси. Для расчета коэффициентов летучестей компонентов для различных составов воспользуемся методом <code class="docutils literal notranslate"><span class="pre">get_lnphiji_Zj</span></code>, принимающего в качестве аргументов давление, температуру и набор компонентных составов в виде двумерного массива, и возвращающего соответствующие коэффициенты летучести компонентов в виде двумерного массива и коэффициенты сверхсжимаемости в виде одномерного массива. Затем вычислим летучести компонентов и энергии Гиббса для соответствующих компонентных составов.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">yj1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1e-4</span><span class="p">,</span> <span class="mf">0.9999</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">yji</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">yj1</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">yj1</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="n">lnphiji</span><span class="p">,</span> <span class="n">Zj</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">get_lnphiji_Zj</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">yji</span><span class="p">)</span>
<span class="n">lnfji</span> <span class="o">=</span> <span class="n">lnphiji</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">P</span> <span class="o">*</span> <span class="n">yji</span><span class="p">)</span>
<span class="n">Gj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">yji</span> <span class="o">*</span> <span class="n">lnfji</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p class="sd-card-text">Теперь вычислим летучести компонентов для заданного компонентного состава. Для этого воспользуемся методом <code class="docutils literal notranslate"><span class="pre">get_lnfi</span></code>, принимающего на вход давление, температуру и компонентный состав в виде одномерного масива, и возвращающего логарифмы летучести компонентов в виде одномерного массива. Затем выслим значения касательной к функции энергии Гиббса в точке с рассматриваемым компонентным составом.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lnfi</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">get_lnfi</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span>
<span class="n">Lj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">yji</span> <span class="o">*</span> <span class="n">lnfi</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p class="sd-card-text">Построим зависимости энергии Гиббса и касательной к ней от количества вещества диоксида углерода в системе.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">fig1</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">6.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yj1</span><span class="p">,</span> <span class="n">Gj</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;teal&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Приведенная энергия Гиббса&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yj1</span><span class="p">,</span> <span class="n">Lj</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;orchid&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Касательная&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Количество вещества диоксида углерода в системе, моль&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Приведенная энергия Гиббса&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/a04c848d3f5961304556239246cbd0bf74ff366e98abe3205ea42f64e2bf7271.png" src="../../_images/a04c848d3f5961304556239246cbd0bf74ff366e98abe3205ea42f64e2bf7271.png" />
<br>
<br>
<p class="sd-card-text">Из представленного результата видно, что при рассматриваемых термобарических условиях касательная, проведенная в точке с заданным компонентным составом, не пересекает функцию энергии Гиббса, следовательно, можно сделать вывод о том, что однофазное состояние является стабильным. Более того, учитывая выпуклую вниз форму функции энергии Гиббса, можно заключить, что при любых компонентных составах данная система будет стабильна в однофазовом состоянии при рассматриваемых термобарических условиях.</p>
<p class="sd-card-text">Вычислим и построим зависимость функции TPD от количества вещества диоксида углерода в системе.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Dj</span> <span class="o">=</span> <span class="n">Gj</span> <span class="o">-</span> <span class="n">Lj</span>
<span class="n">fig2</span><span class="p">,</span> <span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">6.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yj1</span><span class="p">,</span> <span class="n">Dj</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;lime&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Количество вещества диоксида углерода в системе, моль&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Tangent plane distance (TPD)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/b20edc8e91fb693013beab33b12b5cc74c87c6363ad87681936a0a802ae60551.png" src="../../_images/b20edc8e91fb693013beab33b12b5cc74c87c6363ad87681936a0a802ae60551.png" />
<br>
<br>
<p class="sd-card-text">Функция TPD на всем интервале количества вещества диоксида углерода в системе не принимает отрицательных значений, что также свидетельствует об отсутствии пересечении касательной и функции энергии Гиббса, то есть о стабильности рассматриваемой системы.</p>
</div>
</details><div class="exercise admonition">
<p class="admonition-title">Пример</p>
<p>Пусть имеется <span class="math notranslate nohighlight">\(1 \; моль\)</span> смеси из метана и диоксида углерода при температуре <span class="math notranslate nohighlight">\(10 \; ^{\circ} C\)</span> и давлении <span class="math notranslate nohighlight">\(6 \; МПа\)</span> с мольной долей метана <span class="math notranslate nohighlight">\(0.1\)</span>. Необходимо определить, является ли однофазное состояние данной системы стабильным.</p>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Решение</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Зададим исходные термобарические условия и компонентный состав.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">6e6</span><span class="p">)</span> <span class="c1"># Pressure [Pa]</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">10.</span> <span class="o">+</span> <span class="mf">273.15</span><span class="p">)</span> <span class="c1"># Temperature [K]</span>
<span class="n">yi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">.9</span><span class="p">,</span> <span class="mf">.1</span><span class="p">])</span> <span class="c1"># Mole fractions [fr.]</span>
</pre></div>
</div>
<p class="sd-card-text">Выполним расчет приведенной энергии Гиббса для всех возможных компонентных составов рассматриваемой смеси. Затем определим летучести компонентов и энергии Гиббса для соответствующих компонентных составов.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lnphiji</span><span class="p">,</span> <span class="n">Zj</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">get_lnphiji_Zj</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">yji</span><span class="p">)</span>
<span class="n">lnfji</span> <span class="o">=</span> <span class="n">lnphiji</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">P</span> <span class="o">*</span> <span class="n">yji</span><span class="p">)</span>
<span class="n">Gj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">yji</span> <span class="o">*</span> <span class="n">lnfji</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p class="sd-card-text">Теперь вычислим летучести компонентов для заданного компонентного состава. Затем определим значения касательной к функции энергии Гиббса в точке с рассматриваемым компонентным составом.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lnfi</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">get_lnfi</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span>
<span class="n">Lj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">yji</span> <span class="o">*</span> <span class="n">lnfi</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p class="sd-card-text">Построим зависимости энергии Гиббса и касательной к ней от количества вещества диоксида углерода в системе.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">fig3</span><span class="p">,</span> <span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">6.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yj1</span><span class="p">,</span> <span class="n">Gj</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;teal&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Приведенная энергия Гиббса&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yj1</span><span class="p">,</span> <span class="n">Lj</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;orchid&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Касательная&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Количество вещества диоксида углерода в системе, моль&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Приведенная энергия Гиббса&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/660984b752c8e6227cd4a1b40c04d9822e61dee20ba28ab5d96e994c4b630d11.png" src="../../_images/660984b752c8e6227cd4a1b40c04d9822e61dee20ba28ab5d96e994c4b630d11.png" />
<br>
<br>
<p class="sd-card-text">Поскольку видно, что касательная, проведенная к функции энергии Гиббса в точке с рассматриваемым компонентным составом пересекает функцию энергии Гиббса, то однофазное состояние данной системы нестабильно. Построим зависимость функции TPD.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Dj</span> <span class="o">=</span> <span class="n">Gj</span> <span class="o">-</span> <span class="n">Lj</span>
<span class="n">fig4</span><span class="p">,</span> <span class="n">ax4</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">6.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yj1</span><span class="p">,</span> <span class="n">Dj</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;lime&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Количество вещества диоксида углерода в системе, моль&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Tangent plane distance (TPD)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/6cbf068296e1a1cfc81b07f06830f7474f26cf1f15b257309fcce0b1166977ec.png" src="../../_images/6cbf068296e1a1cfc81b07f06830f7474f26cf1f15b257309fcce0b1166977ec.png" />
<br>
<br>
<p class="sd-card-text">Функция TPD имеет отрицательные значения, что свидетельствует о пересечении касательной и функции энергии Гиббса, то есть о нестабильности рассматриваемой системы.</p>
</div>
</details><p>Представленные выше примеры наглядно демонстрируют применение графического метода, основанного на пересечении касательной гиперплоскости гиперповерхности функции энергии Гиббса. Однако применение графического метода не подходит для решения задач гидродинамического моделирования. Таким образом, была необходима разработка численных методов анализа стабильности фазового состояния системы. Эта задача была впервые успешно решена в работе [<a class="reference external" href="https://doi.org/10.1016/0378-3812(82)85001-2">Michelsen, 1982</a>]. Суть данного метода заключается в следующем. Для того чтобы понять, является ли фазовое состояние некоторой системы стабильным, в соответствии с изложенным выше, необходимо понять, имеется ли пересечение гиперповерхности функции энергии Гиббса и касательной гиперплоскости, проведенной к гиперповерхности функции энергии Гиббса в точке с рассматриваемым компонентным составом. Это же условие равносильно анализу значений функции <em>TPD – tangent plane distance</em>: если функция TPD имеет отрицательные значения, то рассматриваемое фазовое состояние системы не является стабильным. Таким образом, задачу анализа стабильности можно представить в качестве задачи минимизации функции TPD:</p>
<div class="note admonition">
<p class="admonition-title">NB</p>
<p>Необходимым критерием стабильности рассматриваемого фазового состояния системы с количествами вещества компонентов <span class="math notranslate nohighlight">\(\mathbf{n}\)</span> является:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align}
D \left( \mathbf{r} \right)
&amp;= G \left( \mathbf{r} \right) - \sum_{i=1}^{N_c} \mu_i \left( \mathbf{z} \right) r_i \\
&amp;= \sum_{i=1}^{N_c} \mu_i \left( \mathbf{y} \right) r_i - \sum_{i=1}^{N_c} \mu_i \left( \mathbf{z} \right) r_i \\
&amp;= \sum_{i=1}^{N_c} r_i \left( \mu_i \left( \mathbf{y} \right) - \mu_i \left( \mathbf{z} \right) \right) \geq 0, \; \forall \, \mathbf{r} \, : \, \sum_{i=1}^{N_c} r_i \leq \sum_{i=1}^{N_c} n_i, \; \mathbf{r} &gt; 0,
\end{align} \end{split}\]</div>
<p>где:
<span class="math notranslate nohighlight">\(\mathbf{r}\)</span> – произвольный состав рассматриваемой системы, моль;
<span class="math notranslate nohighlight">\(\mathbf{y} = \mathbf{r} / \sum_{i=1}^{N_c} r_i\)</span> – мольные доли компонентов для произвольного состава, д.ед.;
<span class="math notranslate nohighlight">\(\mathbf{\mu} \left( \mathbf{y} \right)\)</span> – химические потенциалы компонентов для произвольного состава системы, Дж/моль.;
<span class="math notranslate nohighlight">\(\mathbf{z} = \mathbf{n} / \sum_{i=1}^{N_c} n_i\)</span> – заданный компонентный состав системы, д.ед.;
<span class="math notranslate nohighlight">\(\mathbf{\mu} \left( \mathbf{z} \right)\)</span> – химические потенциалы компонентов для заданного компонентного состава системы, Дж/моль.</p>
</div>
<p>Естественно, нет необходимости проверять значение функции TPD для всех составов системы, достаточно проверить значение функции TPD в ее глобальном минимуме: если в этой точке функция TPD неотрицательна, то систему можно считать стабильной. Однако поиск глобального минимума является достаточно сложной задачей для не выпуклых вниз функций. Таким образом, в работе [<a class="reference external" href="https://doi.org/10.1016/0378-3812(82)85001-2">Michelsen, 1982</a>] было предложено заменить поиск глобального минимума функции TPD на проверку ее значений в локальных минимумах (стационарных точках). Для этого, задаваясь некоторым начальным приближением, находится локальный минимум, и проверяется значение функции TPD в нем. Если это значение меньше нуля, то рассматриваемое фазовое состояние считается нестабильным, и проверка заканчивается. Если же это значение неотрицательно, то рассматривается следующее начальное приближение. Алгоритм повторяется, пока не будут рассмотрены все начальные приближения. Если после рассмотрения всех начальных приближений не было получено отрицательное значение функции TPD, то система считается стабильной. Прежде чем переходить к рассмотрению реализаций данного алгоритма, необходимо получить условие стационарности (выражение, определяющее положение стационарных точек) функции TPD.</p>
<p>Для этого в представленном выше критерии стабильности фазового состояния системы разделим левую и правую часть на <span class="math notranslate nohighlight">\(\sum_{i=1}^{N_c} r_i &gt; 0\)</span>:</p>
<div class="math notranslate nohighlight">
\[ D \left( \mathbf{y} \right) = \sum_{i=1}^{N_c} y_i \left( \mu_i \left( \mathbf{y} \right) - \mu_i \left( \mathbf{z} \right) \right) .\]</div>
<p>Положение стационарных точек функции определяется равенством нулю частных производных по независимым переменным. В качестве независимых переменных будут выступать мольные доли компонентов <span class="math notranslate nohighlight">\(y_j, \; j = 1 \, \ldots \, N_c - 1\)</span>, поскольку:</p>
<div class="math notranslate nohighlight">
\[ y_{N_c} = 1 - \sum_{i=1}^{N_c-1} y_i. \]</div>
<p>Запишем и преобразуем выражение для частных производных функции TPD:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align}
\frac{\partial D}{\partial y_j}
&amp;= \sum_{i=1}^{N_c} \frac{\partial y_i}{\partial y_j} \left( \mu_i \left( \mathbf{y} \right) - \mu_i \left( \mathbf{z} \right) \right) + \sum_{i=1}^{N_c} y_i \frac{\partial \mu_i \left( \mathbf{y} \right)}{\partial y_j} \\
&amp;= \sum_{i=1}^{N_c} \frac{\partial y_i}{\partial y_j} \left( \mu_i \left( \mathbf{y} \right) - \mu_i \left( \mathbf{z} \right) \right) \\
&amp;= \left( \mu_j \left( \mathbf{y} \right) - \mu_j \left( \mathbf{z} \right) \right) - \left( \mu_{N_c} \left( \mathbf{y} \right) - \mu_{N_c} \left( \mathbf{z} \right) \right) \\
&amp;= 0, \; j = 1 \, \ldots \, N_c - 1.
\end{align} \end{split}\]</div>
<p>В процессе этого преобразования было использовано <a class="reference internal" href="../1-TD/TD-12-GibbsDuhemEquation.html"><span class="std std-doc">соотношение Гиббса-Дюгема</span></a> при постоянных давлении и температуре:</p>
<div class="math notranslate nohighlight">
\[ \sum_{i=1}^{N_c} y_i \frac{\partial \mu_i \left( \mathbf{y} \right)}{\partial y_j} = 0. \]</div>
<p>Кроме того, частная производная <span class="math notranslate nohighlight">\(\frac{\partial y_i}{\partial y_j}\)</span> принимает следующие значения:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \frac{\partial y_i}{\partial y_j} = \begin{cases} 1, &amp; i=j, \, i = 1 \, \ldots \, N_c -1; \\ -1, &amp; i=j, \, i = N_c; \\ 0, &amp; i \neq j. \end{cases} \end{split}\]</div>
<p>Следовательно,</p>
<div class="math notranslate nohighlight">
\[ \mu_i \left( \mathbf{y} \right) - \mu_i \left( \mathbf{z} \right) = \mu_{N_c} \left( \mathbf{y} \right) - \mu_{N_c} \left( \mathbf{z} \right) = K, \; i = 1 \, \ldots \, N_c - 1. \]</div>
<p>В данном выражении разность химических потенциалов последнего компонента обозначена константой <span class="math notranslate nohighlight">\(K\)</span>, поскольку она не зависит от индекса <span class="math notranslate nohighlight">\(i\)</span>, то есть является одинаковой (постоянной) для всех компонентов. Иными словами, разность химических потенциалов одинакова для соответствующих компонентов в стационарных точках функции TPD. Из этого следует, что касательные, проведенные к функции энергии Гиббса в точках, соответствующих стационарным точкам функции TPD, будут параллельны друг другу и касательной, проведенной в точке с рассматриваемым компонентным составом. Действительно, из приведенного выше соотношения выразим значения химического потенциала в точке, соответствующей стационарной точке функции TPD:</p>
<div class="math notranslate nohighlight">
\[ \mu_i \left( \mathbf{y} \right) = \mu_i \left( \mathbf{z}^0 \right) + K. \]</div>
<p>Тогда, согласно представленной выше теореме, уравнение касательной к функции энергии Гиббса в этой точке с компонентным составом <span class="math notranslate nohighlight">\(\mathbf{y}\)</span>:</p>
<div class="math notranslate nohighlight">
\[ L_y \left( \mathbf{x} \right) = \sum_{i=1}^{N_c} \mu_i \left( \mathbf{y} \right) x_i = \sum_{i=1}^{N_c} \mu_i \left( \mathbf{z} \right) x_i + K \sum_{i=1}^{N_c} x_i = L_z \left( \mathbf{x} \right) + K .\]</div>
<p>При этом, значение функции TPD в стационарной точке:</p>
<div class="math notranslate nohighlight">
\[ D \left( \mathbf{y} \right) = \sum_{i=1}^{N_c} y_i \left( \mu_i \left( \mathbf{y} \right) - \mu_i \left( \mathbf{z} \right) \right) = K. \]</div>
<p>Тогда условие стабильности рассматриваемой системы <span class="math notranslate nohighlight">\(D \left( \mathbf{y} \right) \geq 0\)</span> можно представить в виде <span class="math notranslate nohighlight">\(K \geq 0\)</span>.</p>
<p>Подробнее рассмотрим условие стационарности функции TPD, которое представляет собой систему нелинейных уравнений:</p>
<div class="math notranslate nohighlight">
\[ \mu_i \left( \mathbf{y} \right) - \mu_i \left( \mathbf{z} \right) = K, \; i = 1 \, \ldots \, N_c. \]</div>
<p>Эта система имеет тривиальное решение <span class="math notranslate nohighlight">\(\mathbf{y} = \mathbf{z}\)</span>, в этом случае <span class="math notranslate nohighlight">\(K = 0\)</span>. При постоянных давлении и температуре химические потенциалы можно заменить на летучести:</p>
<div class="math notranslate nohighlight">
\[ \ln y_i + \ln \phi_i \left( \mathbf{y} \right) - h_i = K, \; i = 1 \, \ldots \, N_c. \]</div>
<p>Здесь под переменной <span class="math notranslate nohighlight">\(h_i\)</span> обозначено следующее:</p>
<div class="math notranslate nohighlight">
\[ h_i = \ln \phi_i \left( \mathbf{z} \right) + \ln z_i, \; i = 1 \, \ldots \, N_c. \]</div>
<p>Пусть <span class="math notranslate nohighlight">\(Y_i = y_i \mathrm{e}^{-K}\)</span>, тогда:</p>
<div class="math notranslate nohighlight">
\[ \ln Y_i + \ln \phi_i \left( \mathbf{y} \right) - h_i = 0, \; i = 1 \, \ldots \, N_c. \]</div>
<p>Значения <span class="math notranslate nohighlight">\(Y_i\)</span> можно условно интерпретировать как количество вещества <span class="math notranslate nohighlight">\(i\)</span>-го компонента, действительно:</p>
<div class="math notranslate nohighlight">
\[ \frac{Y_i}{\sum_{i=1}^{N_c} Y_i} = \frac{y_i \mathrm{e}^{-K}}{\sum_{i=1}^{N_c} y_i \mathrm{e}^{-K}} = \frac{y_i \mathrm{e}^{-K}}{\mathrm{e}^{-K} \sum_{i=1}^{N_c} y_i} = y_i. \]</div>
<p>Условие стабильности <span class="math notranslate nohighlight">\(K \geq 0\)</span> можно представить в виде <span class="math notranslate nohighlight">\(\sum_{i=1}^{N_c} Y_i \leq 1\)</span>.</p>
<p>Таким образом, мы можем использовать метод <a class="reference internal" href="../../0-Math/1-OM/OM-0-Introduction.html"><span class="std std-doc">градиентного спуска</span></a> для поиска локального минимума функции TPD и, задаваясь различными начальными приближениями, определить стабильность рассматриваемой системы. Очевидным недостатком данного подхода является конечность набора начальных приближений (и с точки зрения времени счета – их количество, ведь чем больше начальных приближений мы рассмотрим, тем с большей вероятностью найдем глобальный минимум функции TPD, однако это приведет к увеличению времени работы алгоритма), следовательно, корректный выбор начальных приближений является одним из залогов успешного решения задачи определения стабильности фазового состояния системы.</p>
<p>Обозначим отношение <span class="math notranslate nohighlight">\(Y_i\)</span> к <span class="math notranslate nohighlight">\(z_i\)</span> переменной <span class="math notranslate nohighlight">\(k_i\)</span>. В работе [<a class="reference external" href="https://doi.org/10.1016/0378-3812(82)85001-2">Michelsen, 1982</a>] было предложено использовать корреляцию Уилсона:</p>
<div class="math notranslate nohighlight">
\[ k_i^{go} = \frac{{P_c}_i}{P} \mathrm{e}^{5.3727 \left(1 + \omega_i \right) \left(1 - \frac{{T_c}_i}{T} \right)}. \]</div>
<p>То есть в качестве начальных приближений <span class="math notranslate nohighlight">\(k_i\)</span> в работе [<a class="reference external" href="https://doi.org/10.1016/0378-3812(82)85001-2">Michelsen, 1982</a>] выступал набор из следующих векторов:</p>
<div class="math notranslate nohighlight">
\[ k_i = \left\{ k_i^{go}, \; \frac{1}{k_i^{go}} \right\}. \]</div>
<p>Использование этих двух начальных приближений зачастую бывает достаточно для проверки стабильности фазового равновесия, если заранее известно, что в системе могут быть только жидкая и газовая углероводородные фазы. Впоследствии, в работе [<a class="reference external" href="https://doi.org/10.2118/129844-PA">Li and Firoozabadi, 2012</a>] было предложено дополнить данный набор следующими начальными приближениями:</p>
<div class="math notranslate nohighlight">
\[ k_i = \left\{ k_i^{go}, \; \frac{1}{k_i^{go}}, \; \sqrt[3]{k_i^{go}}, \; \frac{1}{\sqrt[3]{k_i^{go}}}, \; k_i^{pure} \right\}, \]</div>
<p>где:</p>
<div class="math notranslate nohighlight">
\[\begin{split} k_i^{pure} = \begin{cases} \left(1 - \epsilon \right) / z_i, &amp; i = \mathrm{specific \, component}, \\ \left( \epsilon / \left( N_c - 1 \right) \right) / z_i, &amp; i = \mathrm{others}. \end{cases} \end{split}\]</div>
<p>Данный набор начальных приближений хорошо подходит для проверки стабильности систем, где мольная доля одного компонента много больше мольных долей других. Например, к таким системам относятся системы с водой в качестве компонента, в этом случае <span class="math notranslate nohighlight">\(\epsilon = 1\mathrm{e}-3\)</span>, согласно [<a class="reference external" href="https://doi.org/10.1021/acs.iecr.9b00695">Connolly et al, 2019</a>] (для водных растворов иногда имеет смысл задать <span class="math notranslate nohighlight">\(\epsilon = 1\mathrm{e}-15\)</span>, согласно [<a class="reference external" href="https://doi.org/10.1016/j.fuel.2019.02.026">Li and Li</a>]). Для систем с высоким содержанием диоксида углерода рекомендуется <span class="math notranslate nohighlight">\(\epsilon = 0.05\)</span>, согласно [<a class="reference external" href="https://doi.org/10.1016/j.fluid.2019.06.002">Imai at al, 2019</a>].</p>
<p>Существует также множество работ, посвященных разработке численных алгоритмов решения задачи стабильности. В работе [<a class="reference external" href="https://doi.org/10.1016/0378-3812(82)85001-2">Michelsen, 1982</a>] было предложено использовать метод последовательных подстановок, а также метод BFGS с учетом замены переменной <span class="math notranslate nohighlight">\(\alpha_i = 2 \sqrt{Y_i}\)</span> для решения задачи стабильности. Впоследсвтии применение метода BFGS для решение задачи стабильности получило свое развитие в работах [<a class="reference external" href="https://doi.org/10.1002/aic.10908">Hoteit and Firoozabadi, 2006</a>; <a class="reference external" href="https://doi.org/10.1016/j.fluid.2015.07.035">Nichita and Petitfrere, 2015</a>]. Кроме того, было исследовано применение методов глобальной оптимизации для решения данной задачи, например, авторами работы [<a class="reference external" href="http://doi.org/10.1016/S0378-3812(01)00779-8">Nichita et al, 2002</a>]. Далее будет кратко представлен метод <em>QNSS (quasi-Newton successive substitution)</em>, который будет использоваться для решения задачи стабильности системы при известных давлении и температуре. Более подробно данный метод изложен в работах [<a class="reference external" href="https://doi.org/10.2118/12242-MS">Nghiem, 1983</a>; <a class="reference external" href="https://doi.org/10.1016/0378-3812(84)80013-8">Nghiem and Li, 1984</a>].</p>
<div class="algorithm admonition">
<p class="admonition-title">Алгоритм. Анализ стабильности с использованием QNSS</p>
<p><strong>Дано:</strong> Вектор компонентного состава исследуемой системы <span class="math notranslate nohighlight">\(\mathbf{z}\)</span>; термобарические условия <span class="math notranslate nohighlight">\(P\)</span> и <span class="math notranslate nohighlight">\(T\)</span>; необходимые свойства компонентов для нахождения коэффициентов летучести компонентов с использованием уравнения состояния; максимальное число итераций <span class="math notranslate nohighlight">\(N_{iter}\)</span>; точность решения системы нелинейных уравнений <span class="math notranslate nohighlight">\(\epsilon_1\)</span>; численная погрешность расчета <span class="math notranslate nohighlight">\(0 &lt; \epsilon_2 \leq 10^{-4}\)</span>.</p>
<p><strong>Определить:</strong> Является ли однофазное состояние системы с компонентным составом <span class="math notranslate nohighlight">\(\mathbf{y}\)</span> при давлении <span class="math notranslate nohighlight">\(P\)</span> и температуре <span class="math notranslate nohighlight">\(T\)</span> стабильным.</p>
<p><strong>Псевдокод:</strong><br />
<span class="math notranslate nohighlight">\(\mathbf{K} := \left\{ \mathbf{k}_0, \, \mathbf{k}_1, \, \ldots, \, \mathbf{k}_N \right\}\)</span> <span class="comment"># Инициализация набора начальных приближений</span><br />
<span class="math notranslate nohighlight">\(\mathbf{h} := \ln \phi \left(P, \, T, \, \mathbf{z} \right) + \ln \mathbf{z}\)</span>  <span class="comment"># Расчет коэффициентов летучести для начального состава</span><br />
<strong>for</strong> <span class="math notranslate nohighlight">\(i := 0\)</span> <strong>to</strong> <span class="math notranslate nohighlight">\(N\)</span> <strong>do</strong> <span class="comment"># Цикл перебора начальных приближений</span><br />
 <span class="math notranslate nohighlight">\(\mathbf{k} := \mathbf{K}\left[ i \right]\)</span> <span class="comment"># Вектор основных переменных</span><br />
 <span class="math notranslate nohighlight">\(\mathbf{n} := \mathbf{k} \cdot \mathbf{z}\)</span><br />
 <span class="math notranslate nohighlight">\(\mathbf{y} := \mathbf{n} \, / \, \sum_{i=1}^{N_c} n_i\)</span><br />
 <span class="math notranslate nohighlight">\(\mathbf{g} := \ln \mathbf{n} + \ln \phi \left( P, \, T, \, \mathbf{y} \right) - \mathbf{h}\)</span> <span class="comment"># Вектор невязок</span><br />
 <span class="math notranslate nohighlight">\(c := 0\)</span> <span class="comment"># Счетчик итераций решения системы нелинейных уравнений</span><br />
 <span class="math notranslate nohighlight">\(\lambda := 1\)</span> <span class="comment"># Коэффициент релаксации (длина шага)</span><br />
 <strong>while</strong> <span class="math notranslate nohighlight">\(\lVert \mathbf{g} \rVert_2 &gt; \epsilon_1\)</span> <strong>and</strong> <span class="math notranslate nohighlight">\(c &lt; N_{iter}\)</span> <strong>do</strong> <span class="comment"># Цикл решения системы нелинейных уравнений</span><br />
  <span class="math notranslate nohighlight">\(\mathbf{\Delta \ln k} := -\lambda \cdot \mathbf{g}\)</span> <span class="comment"># Вектор направления поиска решения</span><br />
  <strong>if</strong> <span class="math notranslate nohighlight">\(\max \left( \left| \mathbf{\Delta \ln k} \right| \right) &gt; 6\)</span> <strong>then</strong> <span class="comment"># Проверка на модуль вариации переменной для каждого компонента</span><br />
   <span class="math notranslate nohighlight">\(\lambda := \lambda \cdot 6 \, / \max \left( \left| \mathbf{\Delta \ln k} \right| \right)\)</span> <span class="comment"># Корректировка длины шага</span><br />
   <span class="math notranslate nohighlight">\(\mathbf{\Delta \ln k} := \mathbf{\Delta \ln k} \cdot 6 \, / \max \left( \left| \mathbf{\Delta \ln k} \right| \right)\)</span> <span class="comment"># Корректировка вектора направления поиска решения</span><br />
  <strong>end if</strong><br />
  <span class="math notranslate nohighlight">\(\mathbf{g}_{\left( -1 \right)} := \mathbf{g}\)</span> <span class="comment"># Сохранение предыдущих значений вектора невязок</span><br />
  <span class="math notranslate nohighlight">\(\mathbf{k} := \mathbf{k} \cdot \exp \left( \mathbf{\Delta \ln k} \right)\)</span> <span class="comment"># Расчет новых значений вектора основных переменных</span><br />
  <span class="math notranslate nohighlight">\(\mathbf{n} := \mathbf{k} \cdot \mathbf{z}\)</span><br />
  <span class="math notranslate nohighlight">\(\mathbf{y} := \mathbf{n} \, / \, \sum_{i=1}^{N_c} n_i\)</span><br />
  <span class="math notranslate nohighlight">\(\mathbf{g} := \ln \mathbf{n} + \ln \phi \left( P, \, T, \, \mathbf{y} \right) - \mathbf{h}\)</span> <span class="comment"># Новые значения вектора невязок</span><br />
  <span class="math notranslate nohighlight">\(\lambda := \lambda \left| \frac{\left(\mathbf{\Delta \ln k} \right)^\top \mathbf{g}_{\left( -1 \right)}}{\left(\mathbf{\Delta \ln k} \right)^\top \left(\mathbf{g} \, - \, \mathbf{g}_{\left( -1 \right)} \right)} \right|\)</span> <span class="comment"># Новое значение коэффициента релаксации</span><br />
  <span class="math notranslate nohighlight">\(c := c + 1\)</span> <span class="comment"># Обновление счетчика итераций</span><br />
 <strong>end while</strong><br />
 <span class="math notranslate nohighlight">\(TPD := - \ln \sum_{i=1}^{N_c} n_i\)</span> <span class="comment"># Расчет значения функции TPD</span><br />
 <strong>if</strong> <span class="math notranslate nohighlight">\(TPD &lt; -\epsilon_2\)</span> <strong>and</strong> <span class="math notranslate nohighlight">\(c &lt; N_{iter}\)</span> <strong>then</strong> <span class="comment"># Проверка условия стабильности</span><br />
  <span class="math notranslate nohighlight">\(is\_stable := \mathrm{False}\)</span><br />
  <strong>exit for</strong> <span class="comment"># Выход из цикла перебора начальных приближений</span><br />
 <strong>else</strong><br />
  <strong>continue</strong><br />
 <strong>end if</strong><br />
<strong>else</strong><br />
 <span class="math notranslate nohighlight">\(is\_stable := \mathrm{True}\)</span><br />
<strong>end for</strong></p>
</div>
<p>Рассмотрим реализацию данного алгоритма для приведенных выше примеров.</p>
<div class="exercise admonition">
<p class="admonition-title">Пример</p>
<p>Пусть имеется <span class="math notranslate nohighlight">\(1 \; моль\)</span> смеси из метана и диоксида углерода при температуре <span class="math notranslate nohighlight">\(40 \; ^{\circ} C\)</span> и давлении <span class="math notranslate nohighlight">\(2 \; МПа\)</span> с мольной долей метана <span class="math notranslate nohighlight">\(0.85\)</span>. Необходимо определить, является ли однофазное состояние данной системы стабильным, с использованием численного алгоритма.</p>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Решение</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Зададим исходные термобарические условия и компонентный состав.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">2e6</span><span class="p">)</span> <span class="c1"># Pressure [Pa]</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">40.</span> <span class="o">+</span> <span class="mf">273.15</span><span class="p">)</span> <span class="c1"># Temperature [K]</span>
<span class="n">yi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">.15</span><span class="p">,</span> <span class="mf">.85</span><span class="p">])</span> <span class="c1"># Mole fractions [fr.]</span>
</pre></div>
</div>
<p class="sd-card-text">Также зададим максимальное число итераций <span class="math notranslate nohighlight">\(N_{iter}\)</span>, точность решения системы нелинейных уравнений <span class="math notranslate nohighlight">\(\epsilon_1\)</span>, численную погрешность расчета <span class="math notranslate nohighlight">\(\epsilon_2\)</span>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Niter</span> <span class="o">=</span> <span class="mi">50</span> <span class="c1"># Number of iterations</span>
<span class="n">eps1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">1e-6</span><span class="p">)</span> <span class="c1"># Tolerance</span>
<span class="n">eps2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">1e-4</span><span class="p">)</span>
</pre></div>
</div>
<p class="sd-card-text">Рассчитаем матрицу начальных приближений <span class="math notranslate nohighlight">\(\mathbf{K}\)</span>. Для данного примера нам будет достаточно два приближения, рассчитанных по уравнению Уилсона:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ki</span> <span class="o">=</span> <span class="n">Pci</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">5.3727</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">wi</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">Tci</span> <span class="o">/</span> <span class="n">T</span><span class="p">))</span> <span class="o">/</span> <span class="n">P</span> <span class="c1"># Wilson&#39;s correlation</span>
<span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">ki</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">ki</span><span class="p">])</span> <span class="c1"># Matrix of initial estimates</span>
</pre></div>
</div>
<p class="sd-card-text">Создадим функцию, которая будет принимать на вход кортеж из результатов предыдущей итерации, точность и максимальное число итераций, и возвращать необходимость расчета следующей итерации цикла решения системы нелинейных уравнений:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy.typing</span> <span class="k">as</span> <span class="nn">npt</span>

<span class="k">def</span> <span class="nf">condit</span><span class="p">(</span>
    <span class="n">carry</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
    <span class="n">tol</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span>
    <span class="n">Niter</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="n">c</span><span class="p">,</span> <span class="n">ki</span><span class="p">,</span> <span class="n">gi</span><span class="p">,</span> <span class="n">lmbd</span> <span class="o">=</span> <span class="n">carry</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">c</span> <span class="o">&lt;</span> <span class="n">Niter</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">gi</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">)</span>
</pre></div>
</div>
<p class="sd-card-text">Также создадим функцию, которая будет принимать на вход результаты предыдущей итерации в виде кортежа, и рассчитывать результаты для новой итерации:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Callable</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">(</span>
    <span class="n">carry</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
    <span class="n">hi</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
    <span class="n">yi</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
    <span class="n">plnphi</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]],</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
    <span class="n">c</span><span class="p">,</span> <span class="n">ki</span><span class="p">,</span> <span class="n">gi_</span><span class="p">,</span> <span class="n">lmbd</span> <span class="o">=</span> <span class="n">carry</span>
    <span class="n">dlnki</span> <span class="o">=</span> <span class="o">-</span><span class="n">lmbd</span> <span class="o">*</span> <span class="n">gi_</span>
    <span class="n">max_dlnki</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">dlnki</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">max_dlnki</span> <span class="o">&gt;</span> <span class="mf">6.</span><span class="p">:</span>
        <span class="n">relax</span> <span class="o">=</span> <span class="mf">6.</span> <span class="o">/</span> <span class="n">max_dlnki</span>
        <span class="n">lmbd</span> <span class="o">*=</span> <span class="n">relax</span>
        <span class="n">dlnki</span> <span class="o">*=</span> <span class="n">relax</span>
    <span class="n">ki</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">dlnki</span><span class="p">)</span>
    <span class="n">ni</span> <span class="o">=</span> <span class="n">ki</span> <span class="o">*</span> <span class="n">yi</span>
    <span class="n">gi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">ni</span><span class="p">)</span> <span class="o">+</span> <span class="n">plnphi</span><span class="p">(</span><span class="n">yi</span><span class="o">=</span><span class="n">ni</span><span class="o">/</span><span class="n">ni</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="o">-</span> <span class="n">hi</span>
    <span class="n">lmbd</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">dlnki</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">gi_</span><span class="p">)</span> <span class="o">/</span> <span class="n">dlnki</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">gi</span> <span class="o">-</span> <span class="n">gi_</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">lmbd</span> <span class="o">&gt;</span> <span class="mf">30.</span><span class="p">:</span>
        <span class="n">lmbd</span> <span class="o">=</span> <span class="mf">30.</span>
    <span class="k">return</span> <span class="n">c</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ki</span><span class="p">,</span> <span class="n">gi</span><span class="p">,</span> <span class="n">lmbd</span>
</pre></div>
</div>
<p class="sd-card-text">Выполним расчет коэффициентов летучести для начального компонентного состава:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hi</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">get_lnphii</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">yi</span><span class="p">)</span>
</pre></div>
</div>
<p class="sd-card-text">Проинициализируем функции <code class="docutils literal notranslate"><span class="pre">condit</span></code> и <code class="docutils literal notranslate"><span class="pre">update</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>

<span class="n">pcondit</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">condit</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">eps1</span><span class="p">,</span> <span class="n">Niter</span><span class="o">=</span><span class="n">Niter</span><span class="p">)</span>
<span class="n">pupdate</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">update</span><span class="p">,</span> <span class="n">hi</span><span class="o">=</span><span class="n">hi</span><span class="p">,</span> <span class="n">yi</span><span class="o">=</span><span class="n">yi</span><span class="p">,</span> <span class="n">plnphi</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">pr</span><span class="o">.</span><span class="n">get_lnphii</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">))</span>
</pre></div>
</div>
<p class="sd-card-text">Выполним расчет функции TPD для различных начальных приближений:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ki</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
    <span class="n">ni</span> <span class="o">=</span> <span class="n">ki</span> <span class="o">*</span> <span class="n">yi</span>
    <span class="n">gi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">ni</span><span class="p">)</span> <span class="o">+</span> <span class="n">pr</span><span class="o">.</span><span class="n">get_lnphii</span><span class="p">(</span><span class="n">P</span><span class="o">=</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span> <span class="n">yi</span><span class="o">=</span><span class="n">ni</span><span class="o">/</span><span class="n">ni</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="o">-</span> <span class="n">hi</span>
    <span class="n">carry</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ki</span><span class="p">,</span> <span class="n">gi</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">pcondit</span><span class="p">(</span><span class="n">carry</span><span class="p">):</span>
        <span class="n">carry</span> <span class="o">=</span> <span class="n">pupdate</span><span class="p">(</span><span class="n">carry</span><span class="p">)</span>
    <span class="n">c</span><span class="p">,</span> <span class="n">ki</span><span class="p">,</span> <span class="n">gi</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">carry</span>
    <span class="n">ni</span> <span class="o">=</span> <span class="n">ki</span> <span class="o">*</span> <span class="n">yi</span>
    <span class="n">TPD</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">ni</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;For the initial guess #</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">tolerance of equations: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">gi</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">number of iterations: </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">solution: </span><span class="si">{</span><span class="n">ni</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">TPD: </span><span class="si">{</span><span class="n">TPD</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">TPD</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">eps2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">&lt;</span> <span class="n">Niter</span><span class="p">):</span>
        <span class="n">is_stable</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">break</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">is_stable</span> <span class="o">=</span> <span class="kc">True</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The system is stable: </span><span class="si">{</span><span class="n">is_stable</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="output text_html">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre id="codecell20" tabindex="0"><span></span>For the initial guess #0:<br>	tolerance of equations: 2.2979639293154093e-09<br>	number of iterations: 4<br>	solution: [0.15 0.85]<br>	TPD: -2.1990009810648733e-10<br>For the initial guess #1:<br>	tolerance of equations: 1.1109749259100112e-08<br>	number of iterations: 4<br>	solution: [0.15 0.85]<br>	TPD: -8.832841121282723e-10<br>The system is stable: True
</pre><button class="copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#codecell20">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#000000" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <title>Copy to clipboard</title>
  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
  <rect x="8" y="8" width="12" height="12" rx="2"></rect>
  <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path>
</svg>
    </button></div>
</div>
</div><p class="sd-card-text">По результатам расчетов видно, что для обоих начальных приближений алгоритм сошелся на тривиальном решении, в котором значение TPD равно нулю. Таким образом, можно сделать вывод, что система стабильна.</p>
</div>
</details><p>Рассмотрим применение данного алгоритма для следующего примера.</p>
<div class="exercise admonition">
<p class="admonition-title">Пример</p>
<p>Пусть имеется <span class="math notranslate nohighlight">\(1 \; моль\)</span> смеси из метана и диоксида углерода при температуре <span class="math notranslate nohighlight">\(10 \; ^{\circ} C\)</span> и давлении <span class="math notranslate nohighlight">\(6 \; МПа\)</span> с мольной долей метана <span class="math notranslate nohighlight">\(0.1\)</span>. Необходимо определить, является ли однофазное состояние данной системы стабильным, с использованием численного алгоритма.</p>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Решение</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Зададим исходные термобарические условия и компонентный состав.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">6e6</span><span class="p">)</span> <span class="c1"># Pressure [Pa]</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">10.</span> <span class="o">+</span> <span class="mf">273.15</span><span class="p">)</span> <span class="c1"># Temperature [K]</span>
<span class="n">yi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">.9</span><span class="p">,</span> <span class="mf">.1</span><span class="p">])</span> <span class="c1"># Mole fractions [fr.]</span>
</pre></div>
</div>
<p class="sd-card-text">Рассчитаем матрицу начальных приближений <span class="math notranslate nohighlight">\(\mathbf{K}\)</span>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ki</span> <span class="o">=</span> <span class="n">Pci</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">5.3727</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">wi</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">Tci</span> <span class="o">/</span> <span class="n">T</span><span class="p">))</span> <span class="o">/</span> <span class="n">P</span> <span class="c1"># Wilson&#39;s correlation</span>
<span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">ki</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">ki</span><span class="p">])</span> <span class="c1"># Matrix of initial estimates</span>
</pre></div>
</div>
<p class="sd-card-text">Выполним расчет коэффициентов летучести для начального компонентного состава:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hi</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">get_lnphii</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">yi</span><span class="p">)</span>
</pre></div>
</div>
<p class="sd-card-text">Проинициализируем функции <code class="docutils literal notranslate"><span class="pre">condit</span></code> и <code class="docutils literal notranslate"><span class="pre">update</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pcondit</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">condit</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">eps1</span><span class="p">,</span> <span class="n">Niter</span><span class="o">=</span><span class="n">Niter</span><span class="p">)</span>
<span class="n">pupdate</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">update</span><span class="p">,</span> <span class="n">hi</span><span class="o">=</span><span class="n">hi</span><span class="p">,</span> <span class="n">yi</span><span class="o">=</span><span class="n">yi</span><span class="p">,</span> <span class="n">plnphi</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">pr</span><span class="o">.</span><span class="n">get_lnphii</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">))</span>
</pre></div>
</div>
<p class="sd-card-text">Выполним расчет функции TPD для различных начальных приближений:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ki</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
    <span class="n">ni</span> <span class="o">=</span> <span class="n">ki</span> <span class="o">*</span> <span class="n">yi</span>
    <span class="n">gi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">ni</span><span class="p">)</span> <span class="o">+</span> <span class="n">pr</span><span class="o">.</span><span class="n">get_lnphii</span><span class="p">(</span><span class="n">P</span><span class="o">=</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span> <span class="n">yi</span><span class="o">=</span><span class="n">ni</span><span class="o">/</span><span class="n">ni</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="o">-</span> <span class="n">hi</span>
    <span class="n">carry</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ki</span><span class="p">,</span> <span class="n">gi</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">pcondit</span><span class="p">(</span><span class="n">carry</span><span class="p">):</span>
        <span class="n">carry</span> <span class="o">=</span> <span class="n">pupdate</span><span class="p">(</span><span class="n">carry</span><span class="p">)</span>
    <span class="n">c</span><span class="p">,</span> <span class="n">ki</span><span class="p">,</span> <span class="n">gi</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">carry</span>
    <span class="n">ni</span> <span class="o">=</span> <span class="n">ki</span> <span class="o">*</span> <span class="n">yi</span>
    <span class="n">TPD</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">ni</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;For the initial guess #</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">tolerance of equations: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">gi</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">number of iterations: </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">solution: </span><span class="si">{</span><span class="n">ni</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">TPD: </span><span class="si">{</span><span class="n">TPD</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">TPD</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">eps2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">&lt;</span> <span class="n">Niter</span><span class="p">):</span>
        <span class="n">is_stable</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">break</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">is_stable</span> <span class="o">=</span> <span class="kc">True</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The system is stable: </span><span class="si">{</span><span class="n">is_stable</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="output text_html">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre id="codecell20" tabindex="0"><span></span>For the initial guess #0:<br>	tolerance of equations: 8.158548004171597e-08<br>	number of iterations: 6<br>	solution: [0.80316797 0.21351219]<br>	TPD: -0.016542578586788807<br>The system is stable: False
</pre><button class="copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#codecell20">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#000000" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <title>Copy to clipboard</title>
  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
  <rect x="8" y="8" width="12" height="12" rx="2"></rect>
  <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path>
</svg>
    </button></div>
</div>
</div><p class="sd-card-text">Реализованный алгоритм проверки стабильности уже для первого начального приближения нашел решение системы нелинейных уравнений, характеризующееся отрицательным значением функции TPD, следовательно, однофазное состояние не является стабильным.</p>
</div>
</details><p>Представленный выше алгоритм можно использовать для проверки стабильности однофазного состояния системы. Для проверки стабильности многофазной системы также можно использовать представленный выше алгоритм: для этого достаточно проверить стабильность любой из фаз.</p>
<p>Таким образом, в этом подразделе были выведен критерий стабильности для PT-термодинамики, а также представлен один из численных алгоритмов проверки стабильности фазового состояния. Пример реализации данного алгоритма представлен <a class="reference external" href="https://github.com/DanielSkorov/ReservoirSimulation/blob/main/_src/flash.py">здесь</a>. <a class="reference internal" href="SEC-2-RR.html"><span class="std std-doc">Следующие разделы</span></a> будут посвящены изучению уравнения Речфорда-Райса (уравнения фазовых концентраций).</p>
</section>
<section id="vt">
<span id="pvt-sec-stability-vt"></span><h2>VT-термодинамика<a class="headerlink" href="#vt" title="Link to this heading">#</a></h2>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./1-PVT\3-SEC"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="SEC-0-Introduction.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Стабильность. Равновесие. Критическое состояние</p>
      </div>
    </a>
    <a class="right-next"
       href="SEC-2-RR.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Уравнение Речфорда-Райса</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pt">PT-термодинамика</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vt">VT-термодинамика</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Daniel Skorov
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>